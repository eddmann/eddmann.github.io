<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Handling Time-Dependent State Recording using React - Edd Mann</title>
<meta name=description content="Learn how to handle time-dependent state recording in React, including event logging, playback, and state management for seamless user interaction tracking."><meta name=author content="Edd Mann"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQ7WHNXH4"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZPQ7WHNXH4")}</script><meta itemprop=name content="Handling Time-Dependent State Recording using React"><meta itemprop=description content="Sometimes, you look at a feature request and think that it may be a very tricky implementation to develop. I felt this way regarding recording input fields in a recent application I have been working on. The idea was to be able to record a user’s interaction with an HTML component (in this case, a textarea) and be able to replay these events (in real-time) at a later date. Thinking about how I would go about creating such an implementation in trivial JavaScript, with all the browser nuances and user input differences, was not very appealing."><meta itemprop=datePublished content="2016-02-24T00:00:00+00:00"><meta itemprop=dateModified content="2016-02-24T00:00:00+00:00"><meta itemprop=wordCount content="577"><meta itemprop=keywords content="React,Javascript"><meta property="og:url" content="https://eddmann.com/posts/handling-time-dependent-state-recording-using-react/"><meta property="og:site_name" content="Edd Mann"><meta property="og:title" content="Handling Time-Dependent State Recording using React"><meta property="og:description" content="Sometimes, you look at a feature request and think that it may be a very tricky implementation to develop. I felt this way regarding recording input fields in a recent application I have been working on. The idea was to be able to record a user’s interaction with an HTML component (in this case, a textarea) and be able to replay these events (in real-time) at a later date. Thinking about how I would go about creating such an implementation in trivial JavaScript, with all the browser nuances and user input differences, was not very appealing."><meta property="og:locale" content="en_GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-02-24T00:00:00+00:00"><meta property="article:modified_time" content="2016-02-24T00:00:00+00:00"><meta property="article:tag" content="React"><meta property="article:tag" content="Javascript"><meta name=twitter:card content="summary"><meta name=twitter:title content="Handling Time-Dependent State Recording using React"><meta name=twitter:description content="Sometimes, you look at a feature request and think that it may be a very tricky implementation to develop. I felt this way regarding recording input fields in a recent application I have been working on. The idea was to be able to record a user’s interaction with an HTML component (in this case, a textarea) and be able to replay these events (in real-time) at a later date. Thinking about how I would go about creating such an implementation in trivial JavaScript, with all the browser nuances and user input differences, was not very appealing."><meta name=twitter:site content="@edd_mann"><link rel=stylesheet href=/css/style.min.020af028a86e4141eddb604604567804a169da6a588b326f18d39cd2db3b5eb4.css integrity="sha256-AgrwKKhuQUHt22BGBFZ4BKFp2mpYizJvGNOc0ts7XrQ="><link rel=preload as=image href=/assets/x.svg><link rel=preload as=image href=/assets/github.svg><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://eddmann.com/posts/handling-time-dependent-state-recording-using-react/><script>(function(){document.documentElement.setAttribute("data-theme",localStorage.getItem("theme")||window.matchMedia("(prefers-color-scheme: dark)").matches&&"dark"||"light")})()</script><script src=/script.min.1052707861642a4eb63c758a2c16cbf5deb3b3ea2582f09f743a7d4c55fb9828.js integrity="sha256-EFJweGFkKk62PHWKLBbL9d6zs+olgvCfdDp9TFX7mCg=" defer></script></head><body><header class="site-header wrapper"><a href=https://eddmann.com/><h3 class=site-header__title>Edd Mann
<span style=--url:url(/assets/code.svg)>Developer</span></h3></a><button class=site-header__mobile-navigation-button type=button title="Toggle mobile site navigation" aria-label="Toggle mobile site navigation" aria-expanded=false aria-controls=site-navigation></button><div class=site-header__navigation id=site-navigation><nav aria-label="Primary navigation"><ul class=site-header__primary-navigation><li><a href=/archive>Archive</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li></ul></nav><nav aria-label="Social links"><ul class=site-header__social-navigation><li><a class=social-icon style=--url:url(/assets/x.svg) href=https://x.com/edd_mann rel="external noopener" target=_blank>Twitter (X)</a></li><li><a class=social-icon style=--url:url(/assets/github.svg) href=https://github.com/eddmann rel="external noopener" target=_blank>GitHub</a></li></ul></nav></div></header><main class=wrapper><article><header class=page-title><h1 class=transition-between-pages style=--id:handling-time-dependent-state-recording-using-react>Handling Time-Dependent State Recording using React</h1><time datetime=2016-02-24T00:00:00Z class=post__time>Feb 24, 2016</time></header><main class=prose><p>Sometimes, you look at a feature request and think that it may be a very tricky implementation to develop.
I felt this way regarding recording input fields in a recent application I have been working on.
The idea was to be able to record a user&rsquo;s interaction with an HTML component (in this case, a textarea) and be able to replay these events (in real-time) at a later date.
Thinking about how I would go about creating such an implementation in trivial JavaScript, with all the browser nuances and user input differences, was not very appealing.</p><h2 id=enter-react>Enter React</h2><p>Fortunately, we have recently added React into our stack, which, when applied to a problem domain such as this, made codifying a solution a breeze.
Instead of thinking of each intricate DOM event, I was able to reason about the problem on a higher level, alternatively thinking in terms of state changes.
All the boilerplate required to handle <code>onChange</code> events was already provided within the library.
Instead, I was able to take advantage of how React handles components&rsquo; internal state for my own extra requirements.
The recording component documented below is really just logging each of the intermittent states that the component is in during its lifetime, in respect to its present value.
These state changes (&rsquo;events&rsquo;) are stored along with their respective timestamp to provide the possibility for later time-dependent processing.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RecordableTextArea</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>Component</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>state</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>, <span style=color:#a6e22e>events</span><span style=color:#f92672>:</span> [] };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>clear</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setState</span>({ <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>, <span style=color:#a6e22e>events</span><span style=color:#f92672>:</span> [] });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>getEvents</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>events</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>_addEvent</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>preventDefault</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setState</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>value</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>events</span><span style=color:#f92672>:</span> [...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>events</span>, [<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>value</span>, Date.<span style=color:#a6e22e>now</span>()]],
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>render</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>textarea</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span>{<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>value</span>}
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>onChange</span><span style=color:#f92672>=</span>{<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>_addEvent</span>}
</span></span><span style=display:flex><span>        {...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>props</span>}
</span></span><span style=display:flex><span>      <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=handling-playback>Handling Playback</h2><p>Now that we had a log of the states the textarea was in throughout its lifetime, the next step was to be able to replay these events.
To achieve this, a small amount of processing needed to occur in transforming the event timestamps into relative durations, which could be used within the implementation.
With this in place, playback of each sequential event could be achieved by a simple <code>setTimeout</code> call, which applied the associated state change to the playback value output.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>EventPlayback</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>Component</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>timer</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>state</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span> };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>componentDidMount</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>_play</span>(<span style=color:#a6e22e>EventPlayback</span>.<span style=color:#a6e22e>_process</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>events</span>));
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>componentWillUnmount</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>_stop</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>componentWillReceiveProps</span>(<span style=color:#a6e22e>nextProps</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>_stop</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>_play</span>(<span style=color:#a6e22e>EventPlayback</span>.<span style=color:#a6e22e>_process</span>(<span style=color:#a6e22e>nextProps</span>.<span style=color:#a6e22e>events</span>));
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>static</span> <span style=color:#a6e22e>_process</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>events</span> =&gt;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>events</span>.<span style=color:#a6e22e>map</span>(([<span style=color:#a6e22e>value</span>, <span style=color:#a6e22e>timestamp</span>], <span style=color:#a6e22e>index</span>, <span style=color:#a6e22e>events</span>) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> [, <span style=color:#a6e22e>nextTimestamp</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>events</span>[<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>||</span> [, <span style=color:#a6e22e>timestamp</span>];
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> [<span style=color:#a6e22e>value</span>, <span style=color:#a6e22e>nextTimestamp</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>timestamp</span>];
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>_play</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>events</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>events</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> [[<span style=color:#a6e22e>value</span>, <span style=color:#a6e22e>duration</span>], ...<span style=color:#a6e22e>rest</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>events</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setState</span>({ <span style=color:#a6e22e>value</span> });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>timer</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>setTimeout</span>(() =&gt; <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>_play</span>(<span style=color:#a6e22e>rest</span>), <span style=color:#a6e22e>duration</span>);
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>_stop</span> <span style=color:#f92672>=</span> () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>timer</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>clearTimeout</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>timer</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>render</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> {...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>props</span>}<span style=color:#f92672>&gt;</span>{<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>value</span>}<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=putting-it-all-together>Putting It All Together</h2><p>To highlight how simple the implementation truly is, you can wire up the two components using the following component (demoable in <a href=http://output.jsbin.com/mupucu rel="external noopener" target=_blank>this JSBin</a>) and experiment with how it works.
This implementation is really a proof-of-concept in many regards, and further work could be done to make a more generic component that could handle all kinds of time-dependent state logging and eventual playback.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Demo</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>Component</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>state</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>events</span><span style=color:#f92672>:</span> [] };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>_onPlayback</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span> =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>preventDefault</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>record</span> } <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>refs</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setState</span>({ <span style=color:#a6e22e>events</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>record</span>.<span style=color:#a6e22e>getEvents</span>() });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>record</span>.<span style=color:#a6e22e>clear</span>();
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>render</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>RecordableTextArea</span> <span style=color:#a6e22e>ref</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;record&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>button</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>_onPlayback</span>}<span style=color:#f92672>&gt;</span><span style=color:#a6e22e>Playback</span><span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/button&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>EventPlayback</span> <span style=color:#a6e22e>events</span><span style=color:#f92672>=</span>{<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>events</span>} <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><img src=state-recording.gif alt="State recording demonstration"></p></main><footer class=post__tags><a href=/archive/tag/react>react</a><a href=/archive/tag/javascript>javascript</a></footer></article><div class="related-posts prose"><h3>Related Posts</h3><ul><li><a href=/posts/asynchronous-calls-within-flux/>Asynchronous Calls within Flux</a></li><li><a href=/posts/promisifying-error-first-asynchronous-callbacks-in-javascript/>Promisifying Error-First Asynchronous Callbacks in JavaScript</a></li><li><a href=/posts/using-generators-for-promise-coroutines-in-javascript/>Using Generators for Promise Coroutines in JavaScript</a></li><li><a href=/posts/fetching-link-titles-using-promises-and-async-await-in-javascript/>Fetching Link Titles using Promises and Async/Await in JavaScript</a></li><li><a href=/posts/arrow-functions-lexical-this-scoping-in-javascript/>Arrow Functions Lexical 'this' Scoping in JavaScript</a></li></ul></div><div class=scroll-watcher></div></main><footer class="site-footer wrapper"><div>&copy; 2025, Edd Mann</div><button class=theme-toggle type=button title="Toggle theme" aria-label="Toggle theme"><svg fill="currentcolor" viewBox="0 0 32 32" role="img"><title>Theme toggle icon</title><desc>A circle representing the moon for toggling theme</desc><path d="M16 .5C7.4.5.5 7.4.5 16S7.4 31.5 16 31.5 31.5 24.6 31.5 16 24.6.5 16 .5zm0 28.1V3.4C23 3.4 28.6 9 28.6 16S23 28.6 16 28.6z"/></svg></button></footer></body></html>