<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Using LangChain Agents and Tools to answer questions on the NBA with OpenAI - Edd Mann</title>
<meta name=description content="Explore how to use LangChain Agents and Tools with OpenAI to answer questions about recent NBA events and statistics."><meta name=author content="Edd Mann"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQ7WHNXH4"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZPQ7WHNXH4")}</script><meta itemprop=name content="Using LangChain Agents and Tools to answer questions on the NBA with OpenAI"><meta itemprop=description content="Large language models (OpenAI/ChatGPT in particular) are all the rage at the moment. Like many developers, I am interested in exploring what is possible with this new technology. This post documents the use of LangChain Agents/Tools to aid in answering questions based on recent NBA events."><meta itemprop=datePublished content="2023-06-23T00:00:00+00:00"><meta itemprop=dateModified content="2023-06-23T00:00:00+00:00"><meta itemprop=wordCount content="1659"><meta itemprop=keywords content="Openai,Llm,Langchain"><meta property="og:url" content="https://eddmann.com/posts/using-langchain-agents-and-tools-to-answer-questions-on-the-nba-with-openai/"><meta property="og:site_name" content="Edd Mann"><meta property="og:title" content="Using LangChain Agents and Tools to answer questions on the NBA with OpenAI"><meta property="og:description" content="Large language models (OpenAI/ChatGPT in particular) are all the rage at the moment. Like many developers, I am interested in exploring what is possible with this new technology. This post documents the use of LangChain Agents/Tools to aid in answering questions based on recent NBA events."><meta property="og:locale" content="en_GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-23T00:00:00+00:00"><meta property="article:modified_time" content="2023-06-23T00:00:00+00:00"><meta property="article:tag" content="Openai"><meta property="article:tag" content="Llm"><meta property="article:tag" content="Langchain"><meta name=twitter:card content="summary"><meta name=twitter:title content="Using LangChain Agents and Tools to answer questions on the NBA with OpenAI"><meta name=twitter:description content="Large language models (OpenAI/ChatGPT in particular) are all the rage at the moment. Like many developers, I am interested in exploring what is possible with this new technology. This post documents the use of LangChain Agents/Tools to aid in answering questions based on recent NBA events."><meta name=twitter:site content="@edd_mann"><link rel="preload stylesheet" as=style href=/css/style.min.0121a173d3063b9541f1f561a87125fd59dc1fac6110b21c15bba8bc141b70b1.css integrity="sha256-ASGhc9MGO5VB8fVhqHEl/VncH6xhELIcFbuovBQbcLE="><link rel=preload as=image href=/assets/x.svg><link rel=preload as=image href=/assets/github.svg><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://eddmann.com/posts/using-langchain-agents-and-tools-to-answer-questions-on-the-nba-with-openai/></head><body><header class="site-header wrapper"><a href=https://eddmann.com/><h3 class=site-header__title>Edd Mann
<span style=--url:url(/assets/code.svg)>Developer</span></h3></a><div class=site-header__mobile-navigation-button aria-label="Toggle mobile site navigation" aria-expanded=false aria-controls=site-navigation></div><div class=site-header__navigation id=site-navigation><nav aria-label="Primary navigation"><ul class=site-header__primary-navigation><li><a href=/archive>Archive</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li></ul></nav><nav aria-label="Social links"><ul class=site-header__social-navigation><li><a class=social-icon style=--url:url(/assets/x.svg) href=https://x.com/edd_mann rel="external noopener" target=_blank>Twitter (X)</a></li><li><a class=social-icon style=--url:url(/assets/github.svg) href=https://github.com/eddmann rel="external noopener" target=_blank>GitHub</a></li></ul></nav></div></header><main class=wrapper><article><header class=page-title><h1>Using LangChain Agents and Tools to answer questions on the NBA with OpenAI</h1><time class=post__time>Jun 23, 2023</time></header><main class=prose><p>Large language models (OpenAI/ChatGPT in particular) are all the rage at the moment.
Like many developers, I am interested in exploring what is possible with this new technology.
This post documents the use of <a href=https://www.langchain.com/ rel="external noopener" target=_blank>LangChain</a> <a href=https://python.langchain.com/docs/modules/agents/ rel="external noopener" target=_blank>Agents</a>/<a href=https://python.langchain.com/docs/modules/tools/ rel="external noopener" target=_blank>Tools</a> to aid in answering questions based on recent NBA events.</p><p><picture><source type=image/webp srcset=/posts/using-langchain-agents-and-tools-to-answer-questions-on-the-nba-with-openai/stats_hu_3e1e836312b1f1e1.webp><source type=image/jpeg srcset=/posts/using-langchain-agents-and-tools-to-answer-questions-on-the-nba-with-openai/stats_hu_33b48288a3cb87b2.jpg><img src=/posts/using-langchain-agents-and-tools-to-answer-questions-on-the-nba-with-openai/stats_hu_33b48288a3cb87b2.jpg alt="Futuristic holographic basketball analytics display with player figures, charts, and statistics related to AI technologies like LangChain and OpenAI." loading=lazy></picture></p><p>This post was originally written as a Jupyter Notebook, which can be <a href=/posts/using-langchain-agents-and-tools-to-answer-questions-on-the-nba-with-openai/nba-stats.ipynb>downloaded here</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>!</span>pip install langchain openai bs4 requests
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> langchain.llms <span style=color:#f92672>import</span> OpenAI
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>llm <span style=color:#f92672>=</span> OpenAI(
</span></span><span style=display:flex><span>    temperature<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    verbose<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>,
</span></span><span style=display:flex><span>    model_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text-davinci-003&#34;</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><h2 id=without-a-source>Without a Source</h2><p>The LLM is trained up to a given point in time; it is not aware of recent events.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>llm(<span style=color:#e6db74>&#34;Was the 2023 NBA season MVP part of the team that won the NBA championship that year?&#34;</span>)
</span></span></code></pre></div><blockquote><p>It is too early to tell.</p></blockquote><p>It can also be completely wrong&mldr;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>llm(<span style=color:#e6db74>&#34;Was the 1998 NBA season MVP part of the team that won the NBA championship that year?&#34;</span>)
</span></span></code></pre></div><blockquote><p>No, the 1998 NBA season MVP was Michael Jordan of the Chicago Bulls, but the NBA championship that year was won by the San Antonio Spurs.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>llm(<span style=color:#e6db74>&#34;Who won the 1998 NBA season MVP, what team were they on?, what team won the NBA championship that year?&#34;</span>)
</span></span></code></pre></div><blockquote><p>The 1998 NBA season MVP was Michael Jordan of the Chicago Bulls. The Chicago Bulls also won the NBA championship that year.</p></blockquote><h2 id=adding-a-source>Adding a Source</h2><blockquote><p>&ldquo;You don&rsquo;t have to know everything. You just have to know where to find it.&rdquo;
&ndash; Albert Einstein</p></blockquote><p>We can improve the model&rsquo;s answer by providing tools for it to use to look up recent events within a given domain.
This aids in <em>grounding</em> the model and helps to ensure it does not hallucinate.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> langchain.agents <span style=color:#f92672>import</span> AgentType, load_tools, initialize_agent, Tool
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> bs4 <span style=color:#f92672>import</span> BeautifulSoup
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>search_statmuse</span>(query: str) <span style=color:#f92672>-&gt;</span> str:
</span></span><span style=display:flex><span>    response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;https://www.statmuse.com/nba/ask/</span><span style=color:#e6db74>{</span>query<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    soup <span style=color:#f92672>=</span> BeautifulSoup(response<span style=color:#f92672>.</span>content, <span style=color:#e6db74>&#34;html.parser&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> soup<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#34;h1&#34;</span>, class_<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;nlg-answer&#34;</span>)<span style=color:#f92672>.</span>text
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>statmuse_tool <span style=color:#f92672>=</span> Tool(
</span></span><span style=display:flex><span>    name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Statmuse&#34;</span>,
</span></span><span style=display:flex><span>    func <span style=color:#f92672>=</span> search_statmuse,
</span></span><span style=display:flex><span>    description <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        NBA basketball search engine. Use this if the question is related to NBA basketball stats and trivia.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        For example: &#39;Who is the highest-scoring player in the 2023 season?&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        You must:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        - Always specify a year or timeframe with your search.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        - Only search for a single player, MVP, or team in a single search.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>tools <span style=color:#f92672>=</span> load_tools([<span style=color:#e6db74>&#34;llm-math&#34;</span>], llm<span style=color:#f92672>=</span>llm) <span style=color:#f92672>+</span> [statmuse_tool]
</span></span><span style=display:flex><span>agent <span style=color:#f92672>=</span> initialize_agent(tools, llm, agent<span style=color:#f92672>=</span>AgentType<span style=color:#f92672>.</span>ZERO_SHOT_REACT_DESCRIPTION, verbose<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>agent<span style=color:#f92672>.</span>run(<span style=color:#e6db74>&#34;Was the 2023 NBA season MVP part of the team that won the NBA championship that year?&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>&gt; Entering new AgentExecutor chain...

Thought: I need to find out who the MVP was and which team they were on
Action: Statmuse
Action Input: Who was the 2023 NBA season MVP?
Observation:
Joel Embiid won the MVP award in 2022-23.

Thought: I need to find out which team Joel Embiid was on
Action: Statmuse
Action Input: What team was Joel Embiid on in the 2023 season?
Observation:
Joel Embiid played for the 76ers in 2022-23.

Thought: I need to find out which team won the NBA championship in 2023
Action: Statmuse
Action Input: Who won the NBA championship in 2023?
Observation:
The Denver Nuggets won in the 2023 NBA Finals against the Miami Heat, 4 games to 1.

Thought: I now know the final answer
Final Answer: No, Joel Embiid was not part of the team that won the NBA championship in 2023.

&gt; Finished chain.
</code></pre><blockquote><p>No, Joel Embiid was not part of the team that won the NBA championship in 2023.</p></blockquote><p>That is more like it! how about the other question&mldr;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>agent<span style=color:#f92672>.</span>run(<span style=color:#e6db74>&#34;Was the 1998 NBA season MVP part of the team that won the NBA championship that year?&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>&gt; Entering new AgentExecutor chain...

Thought: I need to find out who the MVP was and which team won the championship
Action: Statmuse
Action Input: Who was the 1998 NBA season MVP?
Observation:
Michael Jordan won the MVP award in 1997-98.

Thought: I need to find out which team won the championship that year
Action: Statmuse
Action Input: Who won the 1998 NBA championship?
Observation:
The Chicago Bulls won in the 1998 NBA Finals against the Utah Jazz, 4 games to 2.

Thought: I now know the final answer
Final Answer: Yes, Michael Jordan was part of the team that won the 1998 NBA championship.

&gt; Finished chain.
</code></pre><blockquote><p>Yes, Michael Jordan was part of the team that won the 1998 NBA championship.</p></blockquote><p>Much better!</p><h3 id=combining-tools>Combining Tools</h3><p>We can now combine the abilities to reason about a question, find the relevant information, and then compute a given answer.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>agent<span style=color:#f92672>.</span>run(<span style=color:#e6db74>&#34;How many combined points did the 2023 NBA season MVP, and the 2023 NBA finals MVP score for the entire 2023 season?&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>&gt; Entering new AgentExecutor chain...

Thought: I need to find out who the MVPs were and then add up their points
Action: Statmuse
Action Input: Who was the 2023 NBA season MVP?
Observation:
Joel Embiid won the MVP award in 2022-23.

Thought: Now I need to find out who the Finals MVP was
Action: Statmuse
Action Input: Who was the 2023 NBA Finals MVP?
Observation:
Nikola Jokic won the Finals MVP award once in the 2023 NBA Finals.

Thought: Now I need to find out how many points each of them scored in the 2023 season
Action: Statmuse
Action Input: How many points did Joel Embiid score in the 2023 season?
Observation:
Joel Embiid scored 2,183 points in 2022-23.

Thought: Now I need to find out how many points Nikola Jokic scored in the 2023 season
Action: Statmuse
Action Input: How many points did Nikola Jokic score in the 2023 season?
Observation:
Nikola Jokic dropped 1,690 points in 2022-23.

Thought: I now know the final answer
Final Answer: The combined points of the 2023 NBA season MVP and the 2023 NBA Finals MVP for the entire 2023 season was 3,873 points.

&gt; Finished chain.
</code></pre><blockquote><p>The combined points of the 2023 NBA season MVP and the 2023 NBA Finals MVP for the entire 2023 season was 3,873 points.</p></blockquote><p>Let&rsquo;s now add a tool to fetch information from Wikipedia.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>tools <span style=color:#f92672>=</span> load_tools([<span style=color:#e6db74>&#34;wikipedia&#34;</span>], llm<span style=color:#f92672>=</span>llm) <span style=color:#f92672>+</span> [statmuse_tool]
</span></span><span style=display:flex><span>agent <span style=color:#f92672>=</span> initialize_agent(tools, llm, agent<span style=color:#f92672>=</span>AgentType<span style=color:#f92672>.</span>ZERO_SHOT_REACT_DESCRIPTION, verbose<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>agent<span style=color:#f92672>.</span>run(<span style=color:#e6db74>&#34;Where was the NBA finals MVP for the 2023 season born, and how many total points did he score for the entire season?&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>&gt; Entering new AgentExecutor chain...

Thought: I need to find out who the MVP was and then look up their birthplace and total points scored.
Action: Statmuse
Action Input: Who was the 2023 NBA Finals MVP?
Observation:
Nikola Jokic won the Finals MVP award once in the 2023 NBA Finals.

Thought: I need to find out where Nikola Jokic was born and how many points he scored in the 2023 season.
Action: Wikipedia
Action Input: Nikola Jokic
Observation: Page: Nikola Jokić
Summary: Nikola Jokić (Serbian Cyrillic: Никола Јокић, pronounced [nǐkola jôkitɕ] (listen); born February 19, 1995) is a Serbian professional basketball player, who is a center for the Denver Nuggets of the National Basketball Association (NBA). Nicknamed &#34;The Joker,&#34; and hailed as one of the biggest draft steals in NBA history, he is regarded as one of the greatest players and centers of all time. A five-time NBA All-Star, he has been named to the All-NBA Team on five occasions (including three first-team selections), and won the NBA Most Valuable Player Award for the 2020–21 and 2021–22 seasons. He represents the Serbian national team with which he won a silver medal at the 2016 Summer Olympics.
Jokić was selected by the Nuggets in the second round of the 2014 NBA draft. He was voted to the NBA All-Rookie First Team in 2016. In the 2018–19 NBA season, while leading the Nuggets to the Western Conference Semifinals, he received his first All-Star and All-NBA First Team selections. The following season, he once again received All-Star and All-NBA honors, while leading his team to the Western Conference Finals. In the 2022–23 NBA season, he was awarded NBA Finals MVP after leading the Nuggets to their first-ever NBA championship. Jokić ranks among the top 10 on the all-time list of the NBA players with the most triple-doubles (regular season and playoffs), where he is the leading European player and center, and he holds the record for fastest triple-double (achieved in 14 minutes and 33 seconds).

Page: 2023 NBA playoffs
Summary: The 2023 NBA playoffs was the postseason tournament of the National Basketball Association&#39;s 2022–23 season. The playoffs began on April 15 and concluded on June 12 with the Denver Nuggets winning the 2023 NBA Finals.

Page: 2023 NBA Finals
Summary: The 2023 NBA Finals was the championship series of the National Basketball Association (NBA)&#39;s 2022–23 season and conclusion to the season&#39;s playoffs. The best-of-seven playoffs was played between the Eastern Conference champion Miami Heat and the Western Conference champion Denver Nuggets. The series started on June 1, and concluded in a Denver victory on June 12.The Nuggets defeated the Heat in four of five games, winning their first championship in franchise history after 47 seasons in the NBA. Denver&#39;s Nikola Jokić was unanimously voted the NBA Finals Most Valuable Player (MVP), after averaging 30.2 points, 14.0 rebounds, 7.2 assists, and 1.4 blocks while shooting 58.3% from the field and 42.1% from the 3-point line. Jokić is the lowest-selected player to ever win Finals MVP, being the 41st pick of the 2014 NBA draft. This marked the first NBA Finals appearance for Denver. This was also the second Finals to feature a No. 8 seed, along with the 1999 NBA Finals.
Thought: I now know the final answer
Final Answer: Nikola Jokić was born in Sombor, Serbia on February 19, 1995 and he scored a total of 1,845 points in the 2023 season.

&gt; Finished chain.
</code></pre><blockquote><p>Nikola Jokić was born in Sombor, Serbia on February 19, 1995 and he scored a total of 1,845 points in the 2023 season.</p></blockquote><p>Although this is a very contrived example, it shows the power of how you can get the LLM to reason about a problem by breaking it up into smaller tasks, using provided tools.
It does not necessarily need to know the answer - just how to find the answer.</p></main><footer class=post__tags><a href=/archive/tag/openai>openai</a><a href=/archive/tag/llm>llm</a><a href=/archive/tag/langchain>langchain</a></footer></article></main><footer class="site-footer wrapper"><div>&copy; 2025, Edd Mann</div></footer><script>(function(){document.querySelector(".site-header__mobile-navigation-button").addEventListener("click",e=>{document.documentElement.classList.toggle("mobile-navigation-open"),e.target.setAttribute("aria-expanded",e.target.getAttribute("aria-expanded")==="false"?"true":"false")});const n=document.querySelector(".site-header");let t=window.pageYOffset,e=!1;window.addEventListener("scroll",()=>{if(e)return;const s=window.pageYOffset;window.requestAnimationFrame(()=>{n.classList.toggle("is-sticky",t>s),t=s,e=!1}),e=!0})})()</script></body></html>