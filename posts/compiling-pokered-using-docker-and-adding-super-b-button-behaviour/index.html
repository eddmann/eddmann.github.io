<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Compiling Pokémon Red (pokered) using Docker and adding 'Super B' button behaviour - Edd Mann</title>
<meta name=description content="Learn how to compile Pokémon Red with Docker, add custom 'Super B' button behaviour, and enhance your retro gaming experience. A step-by-step guide for enthusiasts."><meta name=author content="Edd Mann"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQ7WHNXH4"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZPQ7WHNXH4")}</script><meta itemprop=name content="Compiling Pokémon Red (pokered) using Docker and adding 'Super B' button behaviour"><meta itemprop=description content="Over the Christmas break I found myself on a bit of a nostalgic gaming journey. Along with building a RetroPie, I dusted off my old Game Boy and decided to ‘catch them all’ one more time on Pokémon Red. Whilst playing, the developer in me started to contrive how a game like this was created, and better still could be changed. Enter pokered, a disassembly of Pokémon Red/Blue which has been organised so that an assembly code novice like myself can understand it. In this post, I will go through compiling the ASM, tweaking the game to add ‘Super B’ button behaviour, and then running the compiled ROM on an actual handheld!"><meta itemprop=datePublished content="2019-01-29T00:00:00+00:00"><meta itemprop=dateModified content="2019-01-29T00:00:00+00:00"><meta itemprop=wordCount content="871"><meta itemprop=keywords content="Docker,Retro-Gaming,Assembly-Code,Pokemon"><meta property="og:url" content="https://eddmann.com/posts/compiling-pokered-using-docker-and-adding-super-b-button-behaviour/"><meta property="og:site_name" content="Edd Mann"><meta property="og:title" content="Compiling Pokémon Red (pokered) using Docker and adding 'Super B' button behaviour"><meta property="og:description" content="Over the Christmas break I found myself on a bit of a nostalgic gaming journey. Along with building a RetroPie, I dusted off my old Game Boy and decided to ‘catch them all’ one more time on Pokémon Red. Whilst playing, the developer in me started to contrive how a game like this was created, and better still could be changed. Enter pokered, a disassembly of Pokémon Red/Blue which has been organised so that an assembly code novice like myself can understand it. In this post, I will go through compiling the ASM, tweaking the game to add ‘Super B’ button behaviour, and then running the compiled ROM on an actual handheld!"><meta property="og:locale" content="en_GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-01-29T00:00:00+00:00"><meta property="article:modified_time" content="2019-01-29T00:00:00+00:00"><meta property="article:tag" content="Docker"><meta property="article:tag" content="Retro-Gaming"><meta property="article:tag" content="Assembly-Code"><meta property="article:tag" content="Pokemon"><meta name=twitter:card content="summary"><meta name=twitter:title content="Compiling Pokémon Red (pokered) using Docker and adding 'Super B' button behaviour"><meta name=twitter:description content="Over the Christmas break I found myself on a bit of a nostalgic gaming journey. Along with building a RetroPie, I dusted off my old Game Boy and decided to ‘catch them all’ one more time on Pokémon Red. Whilst playing, the developer in me started to contrive how a game like this was created, and better still could be changed. Enter pokered, a disassembly of Pokémon Red/Blue which has been organised so that an assembly code novice like myself can understand it. In this post, I will go through compiling the ASM, tweaking the game to add ‘Super B’ button behaviour, and then running the compiled ROM on an actual handheld!"><meta name=twitter:site content="@edd_mann"><link rel=stylesheet href=/css/style.min.094c8c11875f4921a4fa157fbb0e4a483b9d415d48f335d2effb5818cee90471.css integrity="sha256-CUyMEYdfSSGk+hV/uw5KSDudQV1I8zXS7/tYGM7pBHE="><link rel=preload as=image href=/assets/x.svg><link rel=preload as=image href=/assets/github.svg><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://eddmann.com/posts/compiling-pokered-using-docker-and-adding-super-b-button-behaviour/><script>document.documentElement.setAttribute("data-theme",localStorage.getItem("theme")||window.matchMedia("(prefers-color-scheme: dark)").matches&&"dark"||"light")</script><script src=/script.min.164d56ac6f4c8613b0b7109fd1b4d9dfdce1d004edab8e1afb7240013f9221d7.js integrity="sha256-Fk1WrG9MhhOwtxCf0bTZ39zh0ATtq44a+3JAAT+SIdc=" defer></script></head><body><header class="site-header l-wrapper"><a href=https://eddmann.com/><h3 class=site-header__title>Edd Mann
<span style=--url:url(/assets/code.svg)>Developer</span></h3></a><button class=site-header__mobile-navigation-button type=button title="Toggle mobile site navigation" aria-label="Toggle mobile site navigation" aria-expanded=false aria-controls=site-navigation></button><div class=site-header__navigation id=site-navigation><nav aria-label="Primary navigation"><ul class=site-header__primary-navigation><li><a href=/archive>Archive</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li></ul></nav><nav aria-label="Social links"><ul class=site-header__social-navigation><li><a class=social-icon style=--url:url(/assets/x.svg) href=https://x.com/edd_mann rel="external noopener" target=_blank>Twitter (X)</a></li><li><a class=social-icon style=--url:url(/assets/github.svg) href=https://github.com/eddmann rel="external noopener" target=_blank>GitHub</a></li></ul></nav></div></header><main class=l-wrapper><article><header class=l-page-title><h1 class=u-transition-between-pages style=--id:compiling-pokered-using-docker-and-adding-super-b-button-behaviour>Compiling Pokémon Red (pokered) using Docker and adding 'Super B' button behaviour</h1><time datetime=2019-01-29T00:00:00Z class=published-at>Jan 29, 2019</time></header><main class=u-prose><p>Over the Christmas break I found myself on a bit of a nostalgic gaming journey.
Along with building a <a href=https://retropie.org.uk/ rel="external noopener" target=_blank>RetroPie</a>, I dusted off my old Game Boy and decided to &lsquo;catch them all&rsquo; one more time on Pokémon Red.
Whilst playing, the developer in me started to contrive how a game like this was created, and better still could be changed.
Enter <a href=https://github.com/pret/pokered rel="external noopener" target=_blank>pokered</a>, a disassembly of Pokémon Red/Blue which has been organised so that an assembly code novice like myself can understand it.
In this post, I will go through compiling the ASM, tweaking the game to add <a href=https://github.com/eddmann/pokered/commit/e2d6662bc13348234d58a262e9d6faef0a2507de rel="external noopener" target=_blank>&lsquo;Super B&rsquo; button behaviour</a>, and then running the compiled ROM on an actual handheld!</p><p><strong>Note:</strong> I don&rsquo;t condone piracy and I personally own both Pokémon Red and Blue game cartridges that this project is based on.</p><h2 id=compiling-pokered-using-docker>Compiling pokered using Docker</h2><p>The <a href=https://github.com/pret/pokered rel="external noopener" target=_blank>pokered</a> Git repository is well documented, including the steps required to compile the given assembly code for the desired platform.
However, being an advocate of Docker, I wished to take it a step further and Dockerise this process.
To do this I created the <code>Dockerfile</code> below, which uses a small <a href=https://github.com/bitnami/minideb rel="external noopener" target=_blank>Debian base image</a> to install all the required dependencies.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-docker data-lang=docker><span style=display:flex><span><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> bitnami/minideb:stretch</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> install_packages make git gcc byacc flex pkg-config libpng-dev ca-certificates<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> git clone https://github.com/rednex/rgbds /opt/rgbds <span style=color:#f92672>&amp;&amp;</span> make -C /opt/rgbds install <span style=color:#f92672>&amp;&amp;</span> rm -fr /opt/rgbds<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> mkdir /opt/src<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>WORKDIR</span><span style=color:#e6db74> /opt/src</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>CMD</span> [<span style=color:#e6db74>&#34;make&#34;</span>, <span style=color:#e6db74>&#34;all&#34;</span>]<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>From here I then compiled and pushed <a href=https://hub.docker.com/r/eddmann/pokered rel="external noopener" target=_blank>this image</a> to Docker Hub and created a small executable <code>docker-make</code> script within the root of the repository.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>docker run -v <span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span>:/opt/src eddmann/pokered make $@
</span></span></code></pre></div><p>This allowed me to seamlessly run all provided <code>make</code> targets within the Docker container like so <code>./docker-make all</code>.
Once complete, two new build artefacts were now present in the root of the repository – <code>pokered.gbc</code> and <code>pokeblue.gbc</code>.
Both these ROMs were now playable using a desktop/web Game Boy emulator like <a href=https://wasmboy.app/ rel="external noopener" target=_blank>wasmboy</a>. 🎉</p><h2 id=adding-the-super-b-button-behaviour>Adding the &lsquo;Super B&rsquo; button behaviour</h2><p>Now that I could compile the game into a working ROM, my mind began thinking of all the small tweaks to the game I would like to experiment with.
One aspect of the original that always felt time-consuming was trying to get to a destination in a hurry, only to be caught out by many wild Pokémon (without <a href=https://bulbapedia.bulbagarden.net/wiki/Repel rel="external noopener" target=_blank>Repel</a> active) and trainer-battle encounters.
I started to review the code-base to see if there was a way of taking advantage of the moment when the B button was pressed, possibly temporarily preventing these two activities.</p><h3 id=prevent-wild-pokémon-encounters>Prevent Wild Pokémon Encounters</h3><p>It turns out that the game had an unused <a href=https://tcrf.net/Pok%C3%A9mon_Red_and_Blue/Debug_Functions#Debug_Mode rel="external noopener" target=_blank>debug mode</a> that was left in, which provided one part of this behaviour.
As such, I was able to tweak <a href=https://github.com/eddmann/pokered/commit/e2d6662bc13348234d58a262e9d6faef0a2507de#diff-126f3527215b40b1dc53ffe1ff45b479 rel="external noopener" target=_blank><code>engine/battle/core.asm</code></a> to prevent wild Pokémon encounters if the B button was pressed.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>DetermineWildOpponent:
</span></span><span style=display:flex><span><span style=color:#f92672>- ld a, [wd732]
</span></span></span><span style=display:flex><span><span style=color:#f92672>- bit 1, a
</span></span></span><span style=display:flex><span><span style=color:#f92672>- jr z, .asm_3ef2f
</span></span></span><span style=display:flex><span><span style=color:#f92672></span>  ld a, [hJoyHeld]
</span></span><span style=display:flex><span><span style=color:#f92672>- bit 1, a ; B button pressed?
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+ and B_BUTTON
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>  ret nz
</span></span></code></pre></div><p>This tweak simply removes the check for whether the debug mode is enabled and short-circuits the action if the B button is pressed.</p><h3 id=prevent-trainer-battle-encounters>Prevent Trainer Battle Encounters</h3><p>Following this, I hoped to follow a similar pattern in temporarily preventing trainer battle encounters.
I was able to achieve this by making some minor modifications to <a href=https://github.com/eddmann/pokered/commit/e2d6662bc13348234d58a262e9d6faef0a2507de#diff-33f8ea117b558305b57c03b757e4ef64 rel="external noopener" target=_blank><code>home.asm</code></a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>CheckFightingMapTrainers::
</span></span><span style=display:flex><span><span style=color:#a6e22e>+ ld a, [hJoyHeld]
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ and B_BUTTON
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ jr nz, .noFight
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>
</span></span><span style=display:flex><span>  call CheckForEngagingTrainers
</span></span><span style=display:flex><span>  ld a, [wSpriteIndex]
</span></span><span style=display:flex><span>  cp $ff
</span></span><span style=display:flex><span>  jr nz, .trainerEngaging
</span></span><span style=display:flex><span><span style=color:#a6e22e>+ .noFight
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>  xor a
</span></span><span style=display:flex><span>  ld [wSpriteIndex], a
</span></span><span style=display:flex><span>  ld [wTrainerHeaderFlagBit], a
</span></span><span style=display:flex><span>  ret
</span></span></code></pre></div><p>In a similar manner to how we prevented wild Pokémon encounters, if the B button is pressed we jump to <code>.noFight</code>, skipping the <code>CheckForEngagingTrainers</code> call.
Once compiled, I was able to experiment with these two changes and found them to be very interesting additions to gameplay.</p><h3 id=walking-through-walls>Walking Through Walls</h3><p>I then thought, wouldn&rsquo;t it be cool to accommodate a similar &lsquo;walk through walls&rsquo; glitch behaviour that you see in certain <a href="https://www.youtube.com/watch?v=5naL4X1vUbE" rel="external noopener" target=_blank>speed runs</a>?
As such, I delved back into the code-base and made a small modification to <a href=https://github.com/eddmann/pokered/commit/e2d6662bc13348234d58a262e9d6faef0a2507de#diff-3dcdb47cbd60e627ff3c82d83193112c rel="external noopener" target=_blank><code>home/overworld.asm</code></a> which provided me with this capability.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>.noDirectionChange
</span></span><span style=display:flex><span>  ld a, [wPlayerDirection] ; current direction
</span></span><span style=display:flex><span>  ld [wPlayerMovingDirection], a ; save direction
</span></span><span style=display:flex><span>  call UpdateSprites
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>+ ld a, [hJoyHeld]
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ and B_BUTTON
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+ jr nz, .noCollision
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>
</span></span><span style=display:flex><span>  ld a, [wWalkBikeSurfState]
</span></span><span style=display:flex><span>  cp $02 ; surfing
</span></span><span style=display:flex><span>  jr z, .surfing
</span></span></code></pre></div><p>After another compile, I was now able not only to prevent wild Pokémon and trainer battle encounters, but also to &lsquo;walk through walls&rsquo; when desired.
You can see a small clip below of how gameplay is altered when the &lsquo;Super B&rsquo; button is pressed.</p><p><img src=superb.gif alt="Super B Button"></p><p>Due to the effort put into making the pokered project so readable, I found it very easy to work my way through the code-base and locate the areas of interest to experiment with.
The people behind this disassembly have also worked on doing the same for <a href=https://github.com/pret rel="external noopener" target=_blank>many other</a> Pokémon releases.</p><h2 id=playing-on-a-handheld>Playing on a Handheld</h2><p>With these modifications in place, I ideally wished to now use this new behaviour on a handheld console, as opposed to just through a desktop emulator.
To achieve this, I purchased an <a href=http://www.ezflash.cn/product/omega/ rel="external noopener" target=_blank>EZ-Flash Omega</a> cartridge for the GBA which allowed me to transfer these ROMs onto a micro-SD card.
Now I could play these games on a backlit screen using my Nintendo DS Lite. 😎</p><p><picture><source type=image/webp srcset="/posts/compiling-pokered-using-docker-and-adding-super-b-button-behaviour/ezflash_hu_c3c7a4ae3fc41d6e.webp 350w, /posts/compiling-pokered-using-docker-and-adding-super-b-button-behaviour/ezflash_hu_2f70a03fe43df4a0.webp 700w, /posts/compiling-pokered-using-docker-and-adding-super-b-button-behaviour/ezflash_hu_8af1e003c0d3a117.webp 1400w"><source type=image/jpeg srcset="/posts/compiling-pokered-using-docker-and-adding-super-b-button-behaviour/ezflash_hu_ca12144b923ad410.jpg 350w, /posts/compiling-pokered-using-docker-and-adding-super-b-button-behaviour/ezflash_hu_94fa7aaa6df7d2b4.jpg 700w, /posts/compiling-pokered-using-docker-and-adding-super-b-button-behaviour/ezflash_hu_3d1f5559d92ec296.jpg 1400w"><img src=/posts/compiling-pokered-using-docker-and-adding-super-b-button-behaviour/ezflash_hu_94fa7aaa6df7d2b4.jpg alt="EZ-Flash Omega" loading=lazy></picture></p></main><footer class=post-footer><ul class="tags tags--large"><li><a href=/archive/tag/docker>docker</a></li><li><a href=/archive/tag/retro-gaming>retro-gaming</a></li><li><a href=/archive/tag/assembly-code>assembly-code</a></li><li><a href=/archive/tag/pokemon>pokemon</a></li></ul><div class=related><h3 class=related__title>Related Posts</h3><ul class=related__posts><li><a href=/posts/unlocking-tsunekazu-ishiharas-team-in-pokered/>Unlocking Tsunekazu Ishihara's team in Pokémon Red (pokered)</a></li><li><a href=/posts/creating-a-command-line-application-to-fetch-url-titles-in-go/>Creating a Command Line Application to Fetch URL Titles in Go</a></li><li><a href=/posts/mince-pie-challenge-setting-up-the-serverless-framework-with-docker-webpack-and-babel/>Mince Pie Challenge: Setting up the Serverless Framework with Docker, Webpack and Babel</a></li></ul></div></footer></article><div class=scroll-watcher></div></main><footer class="site-footer l-wrapper"><div>&copy; 2025, Edd Mann</div><button class=site-footer__theme-toggle type=button title="Toggle theme" aria-label="Toggle theme"><svg fill="currentcolor" viewBox="0 0 32 32" role="img"><title>Theme toggle icon</title><desc>A circle representing the moon for toggling theme</desc><path d="M16 .5C7.4.5.5 7.4.5 16S7.4 31.5 16 31.5 31.5 24.6 31.5 16 24.6.5 16 .5zm0 28.1V3.4C23 3.4 28.6 9 28.6 16S23 28.6 16 28.6z"/></svg></button></footer></body></html>