<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Using Graphviz with SVG Output in PHP - Edd Mann</title>
<meta name=description content="Learn how to integrate Graphviz with SVG output in PHP to create interactive, scalable graphs within your markdown posts."><meta name=author content="Edd Mann"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQ7WHNXH4"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZPQ7WHNXH4")}</script><meta itemprop=name content="Using Graphviz with SVG Output in PHP"><meta itemprop=description content="Since adding the functionality to process syntax highlighting through Pygments I had been on the lookout for similar external tools that I could integrate. One area that I felt was lacking in my posts was accompanying visual aids, which would be useful when explaining a new concept or algorithm. Like most developers, I feel at home in an editor, so delving into another software package did not appeal to me."><meta itemprop=datePublished content="2014-01-13T00:00:00+00:00"><meta itemprop=dateModified content="2014-01-13T00:00:00+00:00"><meta itemprop=wordCount content="795"><meta itemprop=keywords content="Php,Graphviz,Svg"><meta property="og:url" content="https://eddmann.com/posts/using-graphviz-with-svg-output-in-php/"><meta property="og:site_name" content="Edd Mann"><meta property="og:title" content="Using Graphviz with SVG Output in PHP"><meta property="og:description" content="Since adding the functionality to process syntax highlighting through Pygments I had been on the lookout for similar external tools that I could integrate. One area that I felt was lacking in my posts was accompanying visual aids, which would be useful when explaining a new concept or algorithm. Like most developers, I feel at home in an editor, so delving into another software package did not appeal to me."><meta property="og:locale" content="en_GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-01-13T00:00:00+00:00"><meta property="article:modified_time" content="2014-01-13T00:00:00+00:00"><meta property="article:tag" content="Php"><meta property="article:tag" content="Graphviz"><meta property="article:tag" content="Svg"><meta name=twitter:card content="summary"><meta name=twitter:title content="Using Graphviz with SVG Output in PHP"><meta name=twitter:description content="Since adding the functionality to process syntax highlighting through Pygments I had been on the lookout for similar external tools that I could integrate. One area that I felt was lacking in my posts was accompanying visual aids, which would be useful when explaining a new concept or algorithm. Like most developers, I feel at home in an editor, so delving into another software package did not appeal to me."><meta name=twitter:site content="@edd_mann"><link rel="preload stylesheet" as=style href=/css/style.min.a5107d712048e2bf498ca68b768b337bccdd6ce7b257419de1c0762b86ab1143.css integrity="sha256-pRB9cSBI4r9JjKaLdosze8zdbOeyV0Gd4cB2K4arEUM="><link rel=preload as=image href=/assets/x.svg><link rel=preload as=image href=/assets/github.svg><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://eddmann.com/posts/using-graphviz-with-svg-output-in-php/></head><body><header class="site-header wrapper"><a href=https://eddmann.com/><h3 class=site-header__title>Edd Mann
<span style=--url:url(/assets/code.svg)>Developer</span></h3></a><div class=site-header__mobile-navigation-button aria-label="Toggle mobile site navigation" aria-expanded=false aria-controls=site-navigation></div><div class=site-header__navigation id=site-navigation><nav aria-label="Primary navigation"><ul class=site-header__primary-navigation><li><a href=/archive>Archive</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li></ul></nav><nav aria-label="Social links"><ul class=site-header__social-navigation><li><a class=social-icon style=--url:url(/assets/x.svg) href=https://x.com/edd_mann rel="external noopener" target=_blank>Twitter (X)</a></li><li><a class=social-icon style=--url:url(/assets/github.svg) href=https://github.com/eddmann rel="external noopener" target=_blank>GitHub</a></li></ul></nav></div></header><main class=wrapper><article><header class=page-title><h1>Using Graphviz with SVG Output in PHP</h1><time class=post__time>Jan 13, 2014</time></header><main class=prose><p>Since adding the functionality to process syntax highlighting through <a href=http://pygments.org/ rel="external noopener" target=_blank>Pygments</a> I had been on the lookout for similar external tools that I could integrate.
One area that I felt was lacking in my posts was accompanying visual aids, which would be useful when explaining a new concept or algorithm.
Like most developers, I feel at home in an editor, so delving into another software package did not appeal to me.</p><p>It was highly desirable to maintain my current workflow and store all content related to a post (unless necessary) within a single markdown file.
<a href=http://www.graphviz.org/ rel="external noopener" target=_blank>Graphviz</a> was the tool for the job, enabling graphs to be described using a small DSL and output in a variety of formats.
Along with the ability to describe graphs in plain text, the option to output results in <a href=http://en.wikipedia.org/wiki/Scalable_Vector_Graphics rel="external noopener" target=_blank>SVG</a> allowed me to keep post dependencies to a minimum.
SVG (Scalable Vector Graphics) is an XML-based vector image format, providing lossless scaling and small file sizes.
This allowed me to embed outputted graphs within the rendered post, similar to the process of syntax highlighting with Pygments.</p><h2 id=implementation>Implementation</h2><p>Below is a simple example implementation to output SVG variants of each defined graph within a supplied string (post).
I made the assumption that the &lsquo;dot&rsquo; command (provided by Graphviz) is present in the user&rsquo;s path (this can be easily altered).
For consistency, I decided to declare graph definitions using Markdown Extra&rsquo;s <a href=http://michelf.ca/projects/php-markdown/extra/#fenced-code-blocks rel="external noopener" target=_blank>fenced blocks</a> notation, discussed further in the <a href=/posts/using-pythons-pygments-syntax-highlighter-in-php/>Pygments post</a>.
Providing the code block with a unique &lsquo;.dot-show&rsquo; language type-hint allowed me to be sure of no conflicting pre-processes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>graphviz</span>($post)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>preg_replace_callback</span>(<span style=color:#e6db74>&#39;/~~~[\s]*\.dot-show\n(.*?)\n~~~/is&#39;</span>, <span style=color:#66d9ef>function</span>($match)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>list</span>($orig, $dot) <span style=color:#f92672>=</span> $match;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $proc <span style=color:#f92672>=</span> <span style=color:#a6e22e>proc_open</span>(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;dot -Tsvg&#39;</span>,
</span></span><span style=display:flex><span>            [ [ <span style=color:#e6db74>&#39;pipe&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span> ], [ <span style=color:#e6db74>&#39;pipe&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span> ] <span style=color:#75715e>/* ignore stderr */</span> ],
</span></span><span style=display:flex><span>            $pipes
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fwrite</span>($pipes[<span style=color:#ae81ff>0</span>], $dot);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fclose</span>($pipes[<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $output <span style=color:#f92672>=</span> <span style=color:#a6e22e>stream_get_contents</span>($pipes[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fclose</span>($pipes[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> ( <span style=color:#f92672>!</span> <span style=color:#a6e22e>proc_close</span>($proc)) {
</span></span><span style=display:flex><span>            $output <span style=color:#f92672>=</span> <span style=color:#a6e22e>preg_replace</span>(
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;/.*&lt;svg width=&#34;[0-9]+pt&#34; height=&#34;([0-9]+pt)&#34;/s&#39;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#39;&lt;svg style=&#34;max-height:$1;&#34; &#39;</span>,
</span></span><span style=display:flex><span>                $output
</span></span><span style=display:flex><span>            );
</span></span><span style=display:flex><span>            $output <span style=color:#f92672>=</span> <span style=color:#a6e22e>preg_replace</span>(<span style=color:#e6db74>&#39;/&lt;!--(.*)--&gt;/Uis&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>, $output);
</span></span><span style=display:flex><span>            $output <span style=color:#f92672>=</span> <span style=color:#a6e22e>preg_replace</span>(<span style=color:#e6db74>&#39;/id=&#34;(.*?)&#34;/s&#39;</span>, <span style=color:#e6db74>&#39;id=&#34;$1_&#39;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>rand</span>() <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;&#34;&#39;</span>, $output);
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            $output <span style=color:#f92672>=</span> $orig;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $output;
</span></span><span style=display:flex><span>    }, $post);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Looking at the example above, you will notice the use of the same regular expression replacement and process command calls found in the Pygments implementation.
All that has been altered is the processing that occurred on the outputted result and, of course, the command itself.
Comments and unnecessary headers are removed from the resulting output, along with the inclusion of random &lsquo;id&rsquo; element names (as multiple graphs may use the same names).
The &lsquo;max-height&rsquo; style replaces the defined width and height of the SVG element to fix an issue I found in maintaining the height ratio when resizing the graph.</p><h2 id=examples>Examples</h2><p>Now that we have an example implementation to work with, let&rsquo;s see some of the impressive results we can achieve when using Graphviz and SVG output.</p><h3 id=uml-class-diagram>UML Class Diagram</h3><p>Inspired by the excellent article found <a href=http://www.ffnn.nl/pages/articles/media/uml-diagrams-using-graphviz-dot.php rel="external noopener" target=_blank>here</a>, I was able to describe a simple UML Class Diagram in .dot notation and output the results in SVG.</p><pre tabindex=0><code>digraph G
{
    node [
        shape = &#34;record&#34;
    ]
    Animal [
        label = &#34;{Animal|+ name : string\l+ age : int\l|+ walk() : void\l}&#34;
    ]
    Dog [
        label = &#34;{Dog||+ bark() : void\l}&#34;
    ]
    Cat [
        label = &#34;{Cat||+ meow() : void\l}&#34;
    ]
    edge [
        arrowhead = &#34;empty&#34;
    ]
    Dog -&gt; Animal
    Cat -&gt; Animal
    edge [
        arrowhead = &#34;none&#34;
        headlabel = &#34;0..*&#34;
        taillabel = &#34;0..*&#34;
    ]
}
</code></pre><h3 id=binary-tree>Binary Tree</h3><pre tabindex=0><code>digraph G
{
    graph[ordering=&#34;out&#34;];
    null[shape=point];
    5 -&gt; 3;
    5 -&gt; 8;
    3 -&gt; 1;
    3 -&gt; 4;
    8 -&gt; 6;
    8 -&gt; null;
}
</code></pre><h3 id=circularly-doubly-linked-list>Circularly Doubly Linked-List</h3><pre tabindex=0><code>digraph G
{
    n1 [label=&#34;Linked List|{size: 3}&#34;,
    shape=record];
    n1 -&gt; n2 [label=&#34;sentinel&#34;];
    n2 [label=&#34;Entry|{null}&#34;,shape=record];
    n2 -&gt; n3 [label=&#34;next&#34;];
    n3 [label=&#34;Entry|{A}&#34;,shape=record];
    n3 -&gt; n4 [label=&#34;next&#34;];
    n4 [label=&#34;Entry|{B}&#34;,shape=record];
    n4 -&gt; n5 [label=&#34;next&#34;];
    n5 [label=&#34;Entry|{C}&#34;,shape=record];
    n5 -&gt; n2 [label=&#34;next&#34;];
    n5 -&gt; n4 [label=&#34;previous&#34;];
    n4 -&gt; n3 [label=&#34;previous&#34;];
    n3 -&gt; n2 [label=&#34;previous&#34;];
    n2 -&gt; n5 [label=&#34;previous&#34;];
}
</code></pre><h3 id=huffman-coding-tree>Huffman Coding Tree</h3><p>Using <a href=http://huffman.ooz.ie/ rel="external noopener" target=_blank>this</a> generator I was able to visually represent the Huffman Tree for a given string.</p><pre tabindex=0><code>digraph G
{
    edge [label=0];
    graph [ranksep=0];
    O [shape=record, label=&#34;{{O|2}|000}&#34;];
    W [shape=record, label=&#34;{{W|2}|001}&#34;];
    D [shape=record, label=&#34;{{D|1}|0100}&#34;];
    H [shape=record, label=&#34;{{H|1}|0101}&#34;];
    SPACE [shape=record, label=&#34;{{SPACE|2}|011}&#34;];
    DHSPACE [label=4];
    T [shape=record, label=&#34;{{T|1}|1000}&#34;];
    COMA [shape=record, label=&#34;{{COMA|1}|1001}&#34;];
    TCOMA [label=2];
    S [shape=record, label=&#34;{{S|1}|1010}&#34;];
    R [shape=record, label=&#34;{{R|1}|1011}&#34;];
    SR [label=2];
    TCOMASR [label=4];
    E [shape=record, label=&#34;{{E|3}|110}&#34;];
    L [shape=record, label=&#34;{{L|3}|111}&#34;];
    18 -&gt; 8 -&gt; 4 -&gt; O;
    DHSPACE -&gt; 2 -&gt; D;
    10 -&gt; TCOMASR -&gt; TCOMA -&gt; T;
    SR -&gt; S;
    6 -&gt; E;4 -&gt; W [label=1];
    2 -&gt; H [label=1];
    8 -&gt; DHSPACE -&gt; SPACE [label=1];
    TCOMA -&gt; COMA [label=1];
    TCOMASR -&gt; SR -&gt; R [label=1];
    18 -&gt; 10 -&gt; 6 -&gt; L [label=1];
}
</code></pre><h2 id=resources>Resources</h2><ul><li><a href=http://www.graphviz.org/ rel="external noopener" target=_blank>Graphviz</a></li><li><a href=http://pygments.org/ rel="external noopener" target=_blank>Pygments</a></li><li><a href=/posts/using-pythons-pygments-syntax-highlighter-in-php/>Using Python&rsquo;s Pygments Syntax Highlighter in PHP</a></li><li><a href=http://www.ffnn.nl/pages/articles/media/uml-diagrams-using-graphviz-dot.php rel="external noopener" target=_blank>UML Diagrams Using Graphviz Dot</a></li><li><a href=http://huffman.ooz.ie/ rel="external noopener" target=_blank>Huffman Tree Generator</a></li><li><a href=https://www.cs.auckland.ac.nz/~j-hamer/ACE04-paper.pdf rel="external noopener" target=_blank>Visualising Java Data Structures as Graphs</a></li></ul></main><footer class=post__tags><a href=/archive/tag/php>php</a><a href=/archive/tag/graphviz>graphviz</a><a href=/archive/tag/svg>svg</a></footer></article><div class=scroll-watcher></div></main><footer class="site-footer wrapper"><div>&copy; 2025, Edd Mann</div></footer><script>(function(){document.querySelector(".site-header__mobile-navigation-button").addEventListener("click",e=>{document.documentElement.classList.toggle("mobile-navigation-open"),e.target.setAttribute("aria-expanded",e.target.getAttribute("aria-expanded")==="false"?"true":"false")});const n=document.querySelector(".site-header");let t=window.pageYOffset,e=!1;window.addEventListener("scroll",()=>{if(e)return;setTimeout(()=>{const s=window.pageYOffset;n.classList.toggle("is-sticky",s>0&&t>s),t=s,e=!1},500),e=!0})})()</script></body></html>