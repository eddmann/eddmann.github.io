<p>Over the past couple of months I have found myself several times having to look up how to expand a Linux-based AWS EBS volume.
This article showcases a simple step-by-step guide to performing this action.</p>

<!--more-->

<p><strong>Prerequisites:</strong> You have increased the subject volume using the <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/console-modify.html">AWS console</a> or <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/cli-modify.html">AWS CLI</a>, and have installed the <code class="language-plaintext highlighter-rouge">cloud-guest-utils</code> (Debian/Ubuntu) or <code class="language-plaintext highlighter-rouge">cloud-utils-growpart</code> (CentOS) package on the EC2 instance.</p>

<p>With the volume expanded within AWS, we can see the 100G of unallocated space ðŸ˜¢.
Letâ€™s go about increasing the <code class="language-plaintext highlighter-rouge">xvda1</code> partition to fill the full drive.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ lsblk
NAME    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
xvda    202:0    0  120G  0 disk
â””â”€xvda1 202:1    0   20G  0 part /
</code></pre></div></div>

<p>Using the <code class="language-plaintext highlighter-rouge">growpart</code> command, we are able to specify the device and partition number we wish to expand.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ growpart /dev/xvda 1
CHANGED: partition=1 start=2048 old: size=41940959 end=41943007 new: size=251656159,end=251658207
</code></pre></div></div>

<p>We can now see that the partition has been expanded to fill the drive.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ lsblk
NAME    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
xvda    202:0    0  120G  0 disk
â””â”€xvda1 202:1    0  120G  0 part /
</code></pre></div></div>

<p>However, the filesystem is still not aware of this newly available space.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ df -h
Filesystem      Size  Used Avail Use% Mounted on
/dev/xvda1       20G  2.6G   17G  14% /
</code></pre></div></div>

<p>We can now use the <code class="language-plaintext highlighter-rouge">resize2fs</code> command to update the filesystem, making it aware of this space.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ resize2fs /dev/xvda1
resize2fs 1.43.4 (31-Jan-2017)
Filesystem at /dev/xvda1 is mounted on /; on-line resizing required
old_desc_blocks = 3, new_desc_blocks = 15
The filesystem on /dev/xvda1 is now 31457019 (4k) blocks long.
</code></pre></div></div>

<p>Finally, when we now check the disk usage, we can see the extra 100G available ðŸŽ‰!</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ df -h
Filesystem      Size  Used Avail Use% Mounted on
/dev/xvda1      119G  2.6G  111G   3% /
</code></pre></div></div>
