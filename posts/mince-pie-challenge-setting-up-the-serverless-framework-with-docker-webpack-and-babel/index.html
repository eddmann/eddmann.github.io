<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Mince Pie Challenge: Setting up the Serverless Framework with Docker, Webpack and Babel - Edd Mann</title>
<meta name=description content="Learn how to set up the Serverless Framework with Docker, Webpack and Babel for building robust AWS Lambda functions as part of the Mince Pie Challenge."><meta name=author content="Edd Mann"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQ7WHNXH4"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZPQ7WHNXH4")}</script><meta itemprop=name content="Mince Pie Challenge: Setting up the Serverless Framework with Docker, Webpack and Babel"><meta itemprop=description content="Now that we have spent some time working out how the API is going to look, we can move on to building it! We will start off by configuring the initial API project, setting up a Dockerised Serverless Framework with Webpack and Babel support."><meta itemprop=datePublished content="2018-06-15T00:00:00+00:00"><meta itemprop=dateModified content="2018-06-15T00:00:00+00:00"><meta itemprop=wordCount content="1245"><meta itemprop=keywords content="Serverless,Docker,Webpack,Babel,Lambda,Mince-Pie-Challenge-Series"><meta property="og:url" content="https://eddmann.com/posts/mince-pie-challenge-setting-up-the-serverless-framework-with-docker-webpack-and-babel/"><meta property="og:site_name" content="Edd Mann"><meta property="og:title" content="Mince Pie Challenge: Setting up the Serverless Framework with Docker, Webpack and Babel"><meta property="og:description" content="Now that we have spent some time working out how the API is going to look, we can move on to building it! We will start off by configuring the initial API project, setting up a Dockerised Serverless Framework with Webpack and Babel support."><meta property="og:locale" content="en_GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-06-15T00:00:00+00:00"><meta property="article:modified_time" content="2018-06-15T00:00:00+00:00"><meta property="article:tag" content="Serverless"><meta property="article:tag" content="Docker"><meta property="article:tag" content="Webpack"><meta property="article:tag" content="Babel"><meta property="article:tag" content="Lambda"><meta property="article:tag" content="Mince-Pie-Challenge-Series"><meta name=twitter:card content="summary"><meta name=twitter:title content="Mince Pie Challenge: Setting up the Serverless Framework with Docker, Webpack and Babel"><meta name=twitter:description content="Now that we have spent some time working out how the API is going to look, we can move on to building it! We will start off by configuring the initial API project, setting up a Dockerised Serverless Framework with Webpack and Babel support."><meta name=twitter:site content="@edd_mann"><link rel="preload stylesheet" as=style href=/css/style.min.6b5d0ef6e3fcc342a7b1bb186a93637ef078dec14a4a0fe2665258ada27fdc79.css integrity="sha256-a10O9uP8w0KnsbsYapNjfvB43sFKSg/iZlJYraJ/3Hk="><link rel=preload as=image href=/assets/x.svg><link rel=preload as=image href=/assets/github.svg><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://eddmann.com/posts/mince-pie-challenge-setting-up-the-serverless-framework-with-docker-webpack-and-babel/></head><body><header class="site-header wrapper"><a href=https://eddmann.com/><h3 class=site-header__title>Edd Mann
<span style=--url:url(/assets/code.svg)>Developer</span></h3></a><div class=site-header__mobile-navigation-button aria-label="Toggle mobile site navigation" aria-expanded=false aria-controls=site-navigation></div><div class=site-header__navigation id=site-navigation><nav aria-label="Primary navigation"><ul class=site-header__primary-navigation><li><a href=/archive>Archive</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li></ul></nav><nav aria-label="Social links"><ul class=site-header__social-navigation><li><a class=social-icon style=--url:url(/assets/x.svg) href=https://x.com/edd_mann rel="external noopener" target=_blank>Twitter (X)</a></li><li><a class=social-icon style=--url:url(/assets/github.svg) href=https://github.com/eddmann rel="external noopener" target=_blank>GitHub</a></li></ul></nav></div></header><main class=wrapper><article><header class=page-title><h1 class=transition-between-pages style=--id:mince-pie-challenge-setting-up-the-serverless-framework-with-docker-webpack-and-babel>Mince Pie Challenge: Setting up the Serverless Framework with Docker, Webpack and Babel</h1><time class=post__time>Jun 15, 2018</time></header><main class=prose><p>Now that we have spent some time working out how the API is going to look, we can move on to building it!
We will start off by configuring the initial API project, setting up a Dockerised <a href=https://serverless.com/ rel="external noopener" target=_blank>Serverless Framework</a> with <a href=https://webpack.js.org/ rel="external noopener" target=_blank>Webpack</a> and <a href=https://babeljs.io/ rel="external noopener" target=_blank>Babel</a> support.</p><p>If you are keen to see how the finished configuration looks, you can access it within the <a href=https://github.com/eddmann/mince-pie-challenge-api-serverless/tree/01-base rel="external noopener" target=_blank>API repository</a>.</p><h2 id=serverless-framework-via-docker>Serverless Framework via Docker</h2><p>So as to make the project easy to set-up on many different development environments, we will employ Docker to manage the Serverless Framework and Node dependencies.
We will take advantage of a pre-built Node 8 image and add the ability to run the Serverless Framework within it.
To allow us to support future Node dependencies that require <code>glibc</code> and container exploration via a Bash shell, we will also include these in our image definition.</p><pre tabindex=0><code>FROM node:8-alpine
RUN apk --no-cache add bash ca-certificates wget
RUN wget -q -O /etc/apk/keys/sgerrand.rsa.pub https://raw.githubusercontent.com/sgerrand/alpine-pkg-glibc/master/sgerrand.rsa.pub &amp;&amp; \
    wget https://github.com/sgerrand/alpine-pkg-glibc/releases/download/2.27-r0/glibc-2.27-r0.apk &amp;&amp; \
    apk add glibc-2.27-r0.apk &amp;&amp; \
    rm -f glibc-2.27-r0.apk
RUN yarn global add serverless@1.28.0
WORKDIR /opt/app
</code></pre><p>When the container is initiated, we wish to supply the AWS credentials (<code>AWS_ACCESS_KEY_ID</code>, <code>AWS_SECRET_ACCESS_KEY</code>) required by Serverless using a given <code>.env</code> file.
This allows us to easily control what <a href=https://serverless.com/framework/docs/providers/aws/guide/credentials/ rel="external noopener" target=_blank>credentials</a> are being used to deploy and maintain the application.
We will also allow the container to access the code-base and provide a separate volume for Node dependencies to be persisted.
Doing this allows us to isolate working dependencies targeted at the container architecture and dependencies installed for the host machine.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;3&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>serverless</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>build</span>: <span style=color:#ae81ff>.</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>env_file</span>: <span style=color:#ae81ff>.env</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>.:/opt/app</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>app-modules:/opt/app/node_modules</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>volumes</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>app-modules</span>:
</span></span></code></pre></div><p>Finally, to make the process of executing the common-place actions on our host machine seamless, we shall define a simple <code>Makefile</code> which outlines these capabilities in a single place.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-make data-lang=make><span style=display:flex><span><span style=color:#a6e22e>install</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  docker-compose run --rm serverless npm install
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>build</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  docker-compose run --rm serverless sls webpack -v --stage<span style=color:#f92672>=</span>dev
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>deploy</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  docker-compose run --rm serverless sls deploy -v --stage<span style=color:#f92672>=</span>dev
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>shell</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  docker-compose run --rm serverless bash
</span></span></code></pre></div><h2 id=serverless-with-babel-and-webpack>Serverless with Babel and Webpack</h2><p>It should be noted that it is not strictly necessary to require Babel and Webpack when working with Lambda and the Serverless Framework.
However, the ability to use all the latest JavaScript features, along with Webpack&rsquo;s module bundling (inc. <a href=https://webpack.js.org/guides/tree-shaking/ rel="external noopener" target=_blank>tree-shaking</a>), is an invaluable addition.
We will start off by defining and installing the explicit development dependencies that we will need.
Within Lambda, the <code>aws-sdk</code> dependency comes pre-baked into the runtime, so we only care about including this during development.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;mince-pie-challenge-api&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;1.0.0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;private&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;devDependencies&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;aws-sdk&#34;</span>: <span style=color:#e6db74>&#34;^2.268.1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;babel-core&#34;</span>: <span style=color:#e6db74>&#34;^6.26.3&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;babel-loader&#34;</span>: <span style=color:#e6db74>&#34;^7.1.5&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;babel-plugin-transform-object-rest-spread&#34;</span>: <span style=color:#e6db74>&#34;^6.26.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;babel-preset-env&#34;</span>: <span style=color:#e6db74>&#34;^1.7.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;serverless-webpack&#34;</span>: <span style=color:#e6db74>&#34;^5.1.5&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;webpack&#34;</span>: <span style=color:#e6db74>&#34;^4.15.1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;webpack-node-externals&#34;</span>: <span style=color:#e6db74>&#34;^1.7.2&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;dependencies&#34;</span>: {}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>From here we can <code>make install</code> and see the Docker module volume in action.
You will notice that a <code>node_modules</code> directory has been created within the code-base but it is empty on your host machine?!
However, if you <code>make shell</code> into the container, you will notice that the container-specific dependencies are present.
This allows you to optionally install the dependencies on your host machine without conflicting with the container.</p><p>Now let&rsquo;s set up the initial <code>serverless.yml</code>, <code>webpack.config.js</code> and <code>.babelrc</code> configurations.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>service</span>: <span style=color:#ae81ff>mince-pie-challenge-api</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>provider</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>aws</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>runtime</span>: <span style=color:#ae81ff>nodejs8.10</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>stage</span>: <span style=color:#ae81ff>${opt:stage, &#39;dev&#39;}</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>region</span>: <span style=color:#ae81ff>eu-west-1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>environment</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>GREETING</span>: <span style=color:#e6db74>&#39;Hello&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>iamRoleStatements</span>: <span style=color:#ae81ff>${file(./roles.yml)}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>custom</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>webpack</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>webpackConfig</span>: <span style=color:#ae81ff>./webpack.config.js</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>includeModules</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>forceExclude</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ae81ff>aws-sdk</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>plugins</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>serverless-webpack</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>package</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>individually</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>resources</span>: <span style=color:#ae81ff>${file(./resources.yml)}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>functions</span>: <span style=color:#ae81ff>${file(./functions.yml)}</span>
</span></span></code></pre></div><p>You can see that we have decided to break up the roles, resources and functions into separate YAML files.
This allows us to manage these definitions in an easier manner, preventing us from creating one huge file.
We have specified that we wish to use the latest Lambda <a href=https://aws.amazon.com/blogs/compute/node-js-8-10-runtime-now-available-in-aws-lambda/ rel="external noopener" target=_blank>node runtime</a> (at the time of writing), with a single global environment variable set (this will be used in a following demo).
So as to take full advantage of Webpack, we have specified that we wish each function to be packaged individually when deployed.
This allows us to prune any unused dependencies on a per-function basis.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>path</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;path&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>slsw</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;serverless-webpack&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>nodeExternals</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;webpack-node-externals&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>entry</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>slsw</span>.<span style=color:#a6e22e>lib</span>.<span style=color:#a6e22e>entries</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>target</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;node&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>slsw</span>.<span style=color:#a6e22e>lib</span>.<span style=color:#a6e22e>webpack</span>.<span style=color:#a6e22e>isLocal</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;development&#39;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;production&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>optimization</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>minimize</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span> },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>performance</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>hints</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span> },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>devtool</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;nosources-source-map&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>externals</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>nodeExternals</span>()],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>module</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rules</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>test</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/\.js$/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>exclude</span><span style=color:#f92672>:</span> <span style=color:#e6db74>/node_modules/</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>use</span><span style=color:#f92672>:</span> [{ <span style=color:#a6e22e>loader</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;babel-loader&#39;</span> }],
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>output</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>libraryTarget</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;commonjs2&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>join</span>(<span style=color:#a6e22e>__dirname</span>, <span style=color:#e6db74>&#39;.webpack&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>filename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;[name].js&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sourceMapFilename</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;[file].map&#39;</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>We supply Webpack with a simple configuration, specifying that we are targeting Node (allowing us to <a href=https://www.npmjs.com/package/webpack-node-externals rel="external noopener" target=_blank>ignore packaging</a> built-in modules) and that we wish to use Babel to process our JavaScript files.
We also define how we wish each function to be output (with their associated source mapping), and which mode to run in based on a <a href=https://github.com/dherault/serverless-offline rel="external noopener" target=_blank>serverless-offline</a> flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;comments&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;presets&#34;</span>: [[<span style=color:#e6db74>&#34;env&#34;</span>, { <span style=color:#f92672>&#34;targets&#34;</span>: { <span style=color:#f92672>&#34;node&#34;</span>: <span style=color:#e6db74>&#34;8.10&#34;</span> } }]],
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;plugins&#34;</span>: [<span style=color:#e6db74>&#34;transform-object-rest-spread&#34;</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We let Babel know that we wish to target the specific version of Node that is present within the Lambda runtime.
This allows Babel to only include <a href=https://remysharp.com/2010/10/08/what-is-a-polyfill rel="external noopener" target=_blank>polyfilled</a> support for features that are used and do not natively exist in this version.
One such feature that is not present within the <code>env</code> preset at this time is <a href=https://babeljs.io/docs/plugins/transform-object-rest-spread/ rel="external noopener" target=_blank>Object rest spread</a>, so we explicitly include this plugin.</p><p>This is all that is required to begin developing Lambda functions using the Serverless Framework, with access to the latest JavaScript features. 🎉</p><h2 id=the-hello-world-example>The &lsquo;Hello World&rsquo; Example</h2><p>Before we delve into developing the API, let&rsquo;s get ourselves accustomed to building and deploying a trivial HTTP-based Lambda function.
We will create a function which is invoked by an <a href=https://aws.amazon.com/api-gateway/ rel="external noopener" target=_blank>API Gateway</a> endpoint and returns a greeting based on the supplied name.
The environment variable that we specified in the <code>serverless.yml</code> file will make sense now.</p><p>We will start off by defining the function within our <code>functions.yml</code> file, and store the implementation itself within a <code>src</code> directory.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>hello</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>handler</span>: <span style=color:#ae81ff>src/hello.handler</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>events</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/hello/{name}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>method</span>: <span style=color:#ae81ff>get</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>request</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>parameters</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>paths</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>name</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><p>With this simple definition, Serverless is able to create all the AWS-specific infrastructure required for us to get the endpoint up and running.
We define a single handler which is invoked via HTTP and requires a specified name to be included with the request.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>GREETING</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handler</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>event</span> =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>name</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>pathParameters</span> <span style=color:#f92672>||</span> {};
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>statusCode</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>200</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>body</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>({ <span style=color:#a6e22e>greeting</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>GREETING</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>name</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span> }),
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>Once API Gateway has passed the request to our Lambda function, we will use the supplied name to return a <code>200 OK</code> response with the associated greeting.</p><p>Now that we have some actual functionality we can interact with, we can go about deploying this application to AWS.
Simply executing <code>make deploy</code> will instruct our Dockerised Serverless Framework to package up and deploy the function, along with the required resources.
If you are interested in a more in-depth look into this process, I have created <a href="https://www.youtube.com/watch?v=ke3eQv-PUC8" rel="external noopener" target=_blank>several</a> <a href="https://www.youtube.com/watch?v=B0r3QdcCy8g" rel="external noopener" target=_blank>different</a> videos on the topic.
Once this has completed, an API Gateway endpoint will be presented that you can then visit to test out the service.
You can see this module installation and deployment process in action within the following screencast.</p><p>With the Serverless Framework configured and a sample function now deployed, we can begin the process of implementing our API.
Join me in the <a href=/posts/mince-pie-challenge-authentication-with-amazon-cognito-and-json-web-tokens/>next post</a> of the <a href=/archive/tag/mince-pie-challenge-series>series</a>, where I will discuss the process of configuring <a href=https://aws.amazon.com/cognito/ rel="external noopener" target=_blank>Amazon Cognito</a>, the authentication service that will be used within our API.</p></main><footer class=post__tags><a href=/archive/tag/serverless>serverless</a><a href=/archive/tag/docker>docker</a><a href=/archive/tag/webpack>webpack</a><a href=/archive/tag/babel>babel</a><a href=/archive/tag/lambda>lambda</a><a href=/archive/tag/mince-pie-challenge-series>mince-pie-challenge-series</a></footer></article><div class="related-posts prose"><h3>Related Posts</h3><ul><li><a href=/posts/mince-pie-challenge-building-a-serverless-restful-api-and-react-client/>Mince Pie Challenge: Building a Serverless RESTful API and React Client</a></li><li><a href=/posts/creating-a-winning-audio-lambda-service-using-serverless-polly-and-compiled-sox/>Creating a 'Winning' Audio Lambda Service using Serverless, Polly and compiled SOX</a></li><li><a href=/posts/memes-as-a-service-using-lambda-serverless-and-imagemagick/>'Memes as a Service' using Lambda, Serverless and ImageMagick</a></li><li><a href=/posts/scheduling-ec2-instances-using-lambda-and-cloudwatch-events/>Scheduling EC2 Instances using Lambda and CloudWatch Events</a></li><li><a href=/posts/mince-pie-challenge-designing-the-restful-api-with-raml/>Mince Pie Challenge: Designing the RESTful API with RAML</a></li></ul></div><div class=scroll-watcher></div></main><footer class="site-footer wrapper"><div>&copy; 2025, Edd Mann</div></footer><script>(function(){document.querySelector(".site-header__mobile-navigation-button").addEventListener("click",e=>{document.documentElement.classList.toggle("mobile-navigation-open"),e.target.setAttribute("aria-expanded",e.target.getAttribute("aria-expanded")==="false"?"true":"false")});const n=document.querySelector(".site-header");let t=window.pageYOffset,e=!1;window.addEventListener("scroll",()=>{if(e)return;setTimeout(()=>{const s=window.pageYOffset;n.classList.toggle("is-sticky",s>0&&t>s),t=s,e=!1},500),e=!0})})()</script></body></html>