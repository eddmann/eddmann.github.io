<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Solving the Advent of Code 2015 Day 11 puzzle using TypeScript">

    <title>Advent of Code 2015 - Day 11 - Corporate Policy &middot; Edd Mann</title>

    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/styles.css">

    <link rel="shortcut icon" href="/favicon.ico">

    <link rel="alternate" href="/rss.xml" title="" type="application/rss+xml">

    <script>
        var _gaq=[['_setAccount','UA-32512081-1'],['_setDomainName','eddmann.com'],['_trackPageview']];
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = 'https://ssl.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>
</head>

    <body>
        <div class="container content">
            <header class="masthead">
                <h3 class="masthead-title">
                    <a href="/" title="Home">Edd Mann</a>
                    <small><i class="fa fa-code"></i> Developer</small>
                </h3>
                <nav>
                    <a href="https://twitter.com/edd_mann"><i class="fa fa-twitter"></i></a>
                    <a href="https://github.com/eddmann"><i class="fa fa-github"></i></a>
                    <a href="mailto:the@eddmann.com"><i class="fa fa-envelope"></i></a>
                </nav>
                <div class="cf"></div>
            </header>

            <main>
                <article class="post">
    <h1 class="post-title">Advent of Code 2015 - Day 11 - Corporate Policy</h1>
    <time datetime="2021-02-04T00:00:00+00:00" class="post-date">04 Feb 2021</time>
    <p>On the eleventh day of Advent of Code 2015 we are asked to help Santa pick a new <em>memorable</em> password, as his last one has expired.</p>



<h3 id="part-1">Part 1</h3>

<p>For part one we are asked to work out what Santas next password should be, based on his previous expired one.</p>

<p>Santas password is generated based on incrementing a seed password using a process similiar to how Rotors are stepped within an <a href="https://en.wikipedia.org/wiki/Enigma_machine">Engima machine</a>.
We increase the rightmost letter one step, if it is <em>z</em>, it wraps around to <em>a</em>, and then repeat with the next letter to the left until one does not wrap around.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">ALPHA</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">abcdefghijklmnopqrstuvwxyz</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">nextPossiblePassword</span> <span class="o">=</span> <span class="p">(</span><span class="nx">password</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">string</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">password</span> <span class="o">===</span> <span class="dl">''</span><span class="p">)</span> <span class="k">return</span> <span class="dl">''</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">remaining</span> <span class="o">=</span> <span class="nx">password</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">next</span> <span class="o">=</span> <span class="nx">ALPHA</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">password</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

  <span class="k">return</span> <span class="nx">next</span> <span class="o">&lt;</span> <span class="nx">ALPHA</span><span class="p">.</span><span class="nx">length</span>
    <span class="p">?</span> <span class="nx">remaining</span> <span class="o">+</span> <span class="nx">ALPHA</span><span class="p">[</span><span class="nx">next</span><span class="p">]</span>
    <span class="p">:</span> <span class="nx">nextPossiblePassword</span><span class="p">(</span><span class="nx">remaining</span><span class="p">)</span> <span class="o">+</span> <span class="nx">ALPHA</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>
</code></pre></div></div>

<p>For the above implementation I decided to take a recursive approach, leveraging an alphabet sequence string to deduce order.
I explored the option of using an ordinal character codes instead but decided to stick with this implementation for readablility.</p>

<p>With a possible new password now generated, Santa requires that it passes three password policy rules he has enforced.
To ensure the password is valid it must not contain any restricted letters, have at-least two occurances of non-overlapping pairs (i.e. aacc, aabcc) and include an alphabet sequence triplet (i.e. abc, cbd).</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">isValidPassword</span> <span class="o">=</span> <span class="p">(</span><span class="nx">password</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nx">boolean</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">hasRestrictedLetter</span> <span class="o">=</span> <span class="sr">/</span><span class="se">[</span><span class="sr">iol</span><span class="se">]</span><span class="sr">/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">password</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">hasTwoNonOverlappingPairs</span> <span class="o">=</span> <span class="sr">/</span><span class="se">([</span><span class="sr">a-z</span><span class="se">])\1</span><span class="sr">.*</span><span class="se">([</span><span class="sr">a-z</span><span class="se">])\2</span><span class="sr">/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span>
    <span class="nx">password</span>
  <span class="p">);</span>
  <span class="kd">const</span> <span class="nx">hasAlphaSequence</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">...</span><span class="nx">password</span><span class="p">.</span><span class="nx">matchAll</span><span class="p">(</span><span class="sr">/</span><span class="se">(?=([</span><span class="sr">a-z</span><span class="se">]{3}))</span><span class="sr">/g</span><span class="p">),</span>
  <span class="p">].</span><span class="nx">some</span><span class="p">(([,</span> <span class="nx">seq</span><span class="p">])</span> <span class="o">=&gt;</span> <span class="nx">ALPHA</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">seq</span><span class="p">));</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">!</span><span class="nx">hasRestrictedLetter</span> <span class="o">&amp;&amp;</span>
    <span class="nx">hasTwoNonOverlappingPairs</span> <span class="o">&amp;&amp;</span>
    <span class="nx">hasAlphaSequence</span>
  <span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Harnessing Regular Expression back-references we are able to test for non-overlapping pairs like we did in previous days solutions.
To validate th alphabet sequence triplet criteria, I opted to reuse the alphabet sequence string and capture all triplet sub-sequences from the password using a positive-lookahead Regular Expression.</p>

<p>With the ability to now generate and validate possible passwords, we are required to iteratively perform this operation until the next valid password has been found.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">generateNextPassword</span> <span class="o">=</span> <span class="p">(</span><span class="nx">seed</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">string</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">next</span> <span class="o">=</span> <span class="nx">seed</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">next</span> <span class="o">=</span> <span class="nx">nextPossiblePassword</span><span class="p">(</span><span class="nx">next</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">isValidPassword</span><span class="p">(</span><span class="nx">next</span><span class="p">))</span> <span class="k">return</span> <span class="nx">next</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<p>I initially explored the option of using a tail-recursive approach to iterating over this process but found that JavsScript engines do not <a href="https://dev.to/snird/recursion-optimization-in-js-where-is-it-ptc-tco-and-fud-4fka">fully support this yet</a>.
From here I then debated if returning a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator">Generator</a> would add much value to the solution.
In the end I landed on a simple stateful loop which iteratively applies and validates the generation process until the next password is found.</p>

<p>Finally, we can call this function with the supplied expired password to return Santas next valid password 🌟.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">part1</span> <span class="o">=</span> <span class="p">(</span><span class="nx">input</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">string</span> <span class="o">=&gt;</span> <span class="nx">generateNextPassword</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="part-2">Part 2</h3>

<p>For part two we are asked to apply this process an additonal time and generate Santas next following password.
All the work for carrying out this task has been done in part one 🎉, meaning all that is required it to supply the password generated in part one into an additional generation call 🌟.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">part2</span> <span class="o">=</span> <span class="p">(</span><span class="nx">input</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">string</span> <span class="o">=&gt;</span>
  <span class="nx">generateNextPassword</span><span class="p">(</span><span class="nx">part1</span><span class="p">(</span><span class="nx">input</span><span class="p">));</span>
</code></pre></div></div>

</article>

            </main>

            <footer class="footer">
                <img src="https://www.gravatar.com/avatar/c5c2978bb14d16460f73399c394b6acd?s=160">
                <ul>
                    <li>Developer at <a href="http://www.mybuilder.com/">MyBuilder</a></li>
                    <li><a href="http://threedevsandamaybe.com/">Three Devs and a Maybe</a> podcast co-host</li>
                    <li>All ramblings can be found in the <a href="/archive/">Archive</a></li>
                </ul>
                <div class="cf"></div>
            </footer>
        </div>
    </body>
</html>
