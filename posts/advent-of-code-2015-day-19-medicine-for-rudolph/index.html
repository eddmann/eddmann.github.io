<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Advent of Code 2015 - Day 19 - Medicine for Rudolph - Edd Mann</title>
<meta name=description content="Solving the Advent of Code 2015 Day 19 puzzle using TypeScript."><meta name=author content="Edd Mann"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQ7WHNXH4"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZPQ7WHNXH4")}</script><meta itemprop=name content="Advent of Code 2015 - Day 19 - Medicine for Rudolph"><meta itemprop=description content="On the nineteenth day of Advent of Code 2015, Rudolph is sick, and we have been tasked with helping develop the custom-made medicine required."><meta itemprop=datePublished content="2021-02-12T00:00:00+00:00"><meta itemprop=dateModified content="2021-02-12T00:00:00+00:00"><meta itemprop=wordCount content="709"><meta itemprop=keywords content="Advent-of-Code,Advent-of-Code-2015,Typescript"><meta property="og:url" content="https://eddmann.com/posts/advent-of-code-2015-day-19-medicine-for-rudolph/"><meta property="og:site_name" content="Edd Mann"><meta property="og:title" content="Advent of Code 2015 - Day 19 - Medicine for Rudolph"><meta property="og:description" content="On the nineteenth day of Advent of Code 2015, Rudolph is sick, and we have been tasked with helping develop the custom-made medicine required."><meta property="og:locale" content="en_GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-02-12T00:00:00+00:00"><meta property="article:modified_time" content="2021-02-12T00:00:00+00:00"><meta property="article:tag" content="Advent-of-Code"><meta property="article:tag" content="Advent-of-Code-2015"><meta property="article:tag" content="Typescript"><meta name=twitter:card content="summary"><meta name=twitter:title content="Advent of Code 2015 - Day 19 - Medicine for Rudolph"><meta name=twitter:description content="On the nineteenth day of Advent of Code 2015, Rudolph is sick, and we have been tasked with helping develop the custom-made medicine required."><meta name=twitter:site content="@edd_mann"><link rel="preload stylesheet" as=style href=/css/style.min.6c18b9cbfe138a24784e64860eaa9d70076170f03c68d8be3b3f1ae99e51df9f.css integrity="sha256-bBi5y/4TiiR4TmSGDqqdcAdhcPA8aNi+Oz8a6Z5R358="><link rel=preload as=image href=/assets/x.svg><link rel=preload as=image href=/assets/github.svg><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://eddmann.com/posts/advent-of-code-2015-day-19-medicine-for-rudolph/></head><body><header class="site-header wrapper"><a href=https://eddmann.com/><h3 class=site-header__title>Edd Mann
<span style=--url:url(/assets/code.svg)>Developer</span></h3></a><div class=site-header__mobile-navigation-button aria-label="Toggle mobile site navigation" aria-expanded=false aria-controls=site-navigation></div><div class=site-header__navigation id=site-navigation><nav aria-label="Primary navigation"><ul class=site-header__primary-navigation><li><a href=/archive>Archive</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li></ul></nav><nav aria-label="Social links"><ul class=site-header__social-navigation><li><a class=social-icon style=--url:url(/assets/x.svg) href=https://x.com/edd_mann rel="external noopener" target=_blank>Twitter (X)</a></li><li><a class=social-icon style=--url:url(/assets/github.svg) href=https://github.com/eddmann rel="external noopener" target=_blank>GitHub</a></li></ul></nav></div></header><main class=wrapper><article><header class=page-title><h1>Advent of Code 2015 - Day 19 - Medicine for Rudolph</h1><time class=post__time>Feb 12, 2021</time></header><main class=prose><p>On the nineteenth day of Advent of Code 2015, Rudolph is sick, and we have been tasked with helping develop the <em>custom-made</em> medicine required.</p><h2 id=part-1>Part 1</h2><p>We are tasked with helping calibrate the machine that is capable of constructing any Red-Nosed Reindeer molecule required to make the medicine.
As input, we are provided with an initial medicine molecule and a list of replacements that we need to apply.
For part one, we need to determine how many distinct molecules can be created using the replacements provided.
We begin, as always, by parsing this input into a form we can work with.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Replacement</span> <span style=color:#f92672>=</span> [<span style=color:#66d9ef>from</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>to</span>: <span style=color:#66d9ef>string</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Molecule</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>parseReplacementsAndMolecule</span> <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>input</span>: <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>)<span style=color:#f92672>:</span> { <span style=color:#a6e22e>replacements</span>: <span style=color:#66d9ef>Replacement</span>[]; <span style=color:#a6e22e>molecule</span>: <span style=color:#66d9ef>Molecule</span> } <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>replacements</span>, <span style=color:#a6e22e>molecule</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>input</span>.<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#39;\n\n&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>replacements</span>: <span style=color:#66d9ef>replacements</span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#39;\n&#39;</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>r</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#39; =&gt; &#39;</span>, <span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>Replacement</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>molecule</span>,
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>With a listing of all the replacements and the initial molecule now available, we can use these values to determine all the possible molecule variants.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>getMoleculeVariants</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span><span style=color:#f92672>*</span> (
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>m</span>: <span style=color:#66d9ef>Molecule</span>,
</span></span><span style=display:flex><span>  [<span style=color:#66d9ef>from</span>, <span style=color:#a6e22e>to</span>]<span style=color:#f92672>:</span> <span style=color:#a6e22e>Replacement</span>
</span></span><span style=display:flex><span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Generator</span>&lt;<span style=color:#f92672>Molecule</span>&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pattern</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> RegExp(<span style=color:#66d9ef>from</span>, <span style=color:#e6db74>&#39;g&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>o</span>: <span style=color:#66d9ef>RegExpExecArray</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> ((<span style=color:#a6e22e>o</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>pattern</span>.<span style=color:#a6e22e>exec</span>(<span style=color:#a6e22e>m</span>))) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>yield</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>substr</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>o</span>.<span style=color:#a6e22e>index</span>) <span style=color:#f92672>+</span> <span style=color:#a6e22e>to</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>substr</span>(<span style=color:#a6e22e>o</span>.<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>from</span>.<span style=color:#a6e22e>length</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>Given the molecule and the desired replacement, we return a Generator that provides the caller with all the possible variants (based on individual occurrences) within the string.
This allows us to maintain the current position within the Generator and not muddle this logic into the caller&rsquo;s responsibility.</p><p>We can then combine these two functions and determine how many distinct molecule variants there are 🌟.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>part1</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>input</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>replacements</span>, <span style=color:#a6e22e>molecule</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>parseReplacementsAndMolecule</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>input</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>variants</span>: <span style=color:#66d9ef>Molecule</span>[] <span style=color:#f92672>=</span> <span style=color:#a6e22e>replacements</span>.<span style=color:#a6e22e>reduce</span>(
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>molecules</span>, <span style=color:#a6e22e>replacement</span>) <span style=color:#f92672>=&gt;</span> [
</span></span><span style=display:flex><span>      ...<span style=color:#a6e22e>molecules</span>,
</span></span><span style=display:flex><span>      ...<span style=color:#a6e22e>getMoleculeVariants</span>(<span style=color:#a6e22e>molecule</span>, <span style=color:#a6e22e>replacement</span>),
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    []
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Set</span>&lt;<span style=color:#f92672>Molecule</span>&gt;(<span style=color:#a6e22e>variants</span>).<span style=color:#a6e22e>size</span>;
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>I initially used a <code>Set</code> within the reduction, but due to the ease of combining arrays within JavaScript, I found it more readable to first get all possible variants and then return the <code>Set</code> (the deduplication process) at the end.</p><h2 id=part-2>Part 2</h2><p>For part two, with the machine now calibrated, we are required to help with the fabrication process.
Molecule fabrication always begins with just a single electron, <em>e</em>, and involves applying replacements one at a time, just like during calibration.
We are required to determine how many steps it will take to go from <em>e</em> to the provided molecule.</p><p>My initial thought was to begin at <em>e</em> and apply all possible variants until we landed on the desired molecule (as the problem states).
However, the distinct number of possibilities grows too fast, making this an unviable solution.
After a little thought, I decided to flip this problem around and, based on the molecule provided, determine how many replacements would be required to get back to <em>e</em>.
I opted for a <em>greedy approach</em>, sorting the replacements in descending length order.
By doing so, we can then count the steps required and return the desired total to answer part two 🌟.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>part2</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>input</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>replacements</span>, <span style=color:#a6e22e>molecule</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>parseReplacementsAndMolecule</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>input</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>replacementsByLength</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>replacements</span>.<span style=color:#a6e22e>sort</span>(
</span></span><span style=display:flex><span>    ([, <span style=color:#a6e22e>x</span>], [, <span style=color:#a6e22e>y</span>]) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>y</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>x</span>.<span style=color:#a6e22e>length</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>variant</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>molecule</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>steps</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>variant</span> <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;e&#39;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> [<span style=color:#66d9ef>from</span>, <span style=color:#a6e22e>to</span>] <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>replacementsByLength</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>r</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>getMoleculeVariants</span>(<span style=color:#a6e22e>variant</span>, [<span style=color:#a6e22e>to</span>, <span style=color:#66d9ef>from</span>])) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>variant</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>r</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>steps</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>steps</span>;
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>The input has been constructed in such a way that there is no possibility for ambiguity, with only one path back to <em>e</em>.
An interesting optimisation I made was that in a previous solution, I broke out of both the variant and replacement loops upon finding a match.
This ensured that we performed the largest replacement possible at every step.
However, I experimented with what we now have above and instead allowed it to continue to the next possible replacement.
This appears to have sped up the solution while still returning the correct answer.</p><p>I really enjoyed today&rsquo;s challenge and would highly recommend checking out the discussion on the <a href=https://www.reddit.com/r/adventofcode/comments/3xflz8/day_19_solutions/ rel="external noopener" target=_blank>/r/adventofcode</a> subreddit.
It details some interesting ways in which people have solved the problem by hand!</p></main><footer class=post__tags><a href=/archive/tag/advent-of-code>advent-of-code</a><a href=/archive/tag/advent-of-code-2015>advent-of-code-2015</a><a href=/archive/tag/typescript>typescript</a></footer></article></main><footer class="site-footer wrapper"><div>&copy; 2025, Edd Mann</div></footer><script>(function(){document.querySelector(".site-header__mobile-navigation-button").addEventListener("click",e=>{document.documentElement.classList.toggle("mobile-navigation-open"),e.target.setAttribute("aria-expanded",e.target.getAttribute("aria-expanded")==="false"?"true":"false")});const n=document.querySelector(".site-header");let t=window.pageYOffset,e=!1;window.addEventListener("scroll",()=>{if(e)return;const s=window.pageYOffset;window.requestAnimationFrame(()=>{n.classList.toggle("is-sticky",t>s),t=s,e=!1}),e=!0})})()</script></body></html>