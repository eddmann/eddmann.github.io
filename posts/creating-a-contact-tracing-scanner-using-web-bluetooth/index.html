<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Creating a Contact Tracing Scanner using Web Bluetooth - Edd Mann</title>
<meta name=description content="Discover how to use the Web Bluetooth API to build a Contact Tracing Scanner web application."><meta name=author content="Edd Mann"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQ7WHNXH4"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZPQ7WHNXH4")}</script><meta itemprop=name content="Creating a Contact Tracing Scanner using Web Bluetooth"><meta itemprop=description content="I have recently been looking at the Contact Tracing specifications that Apple and Google released earlier this year in aid of the fight against COVID-19. Looking through these documents allowed me to grasp how the system was put together. It also helped ease concerns that family members had regarding how privacy-conscious the Exposure Notification system is."><meta itemprop=datePublished content="2020-10-19T00:00:00+00:00"><meta itemprop=dateModified content="2020-10-19T00:00:00+00:00"><meta itemprop=wordCount content="328"><meta itemprop=keywords content="Contact-Tracing,Javascript,Web-Bluetooth"><meta property="og:url" content="https://eddmann.com/posts/creating-a-contact-tracing-scanner-using-web-bluetooth/"><meta property="og:site_name" content="Edd Mann"><meta property="og:title" content="Creating a Contact Tracing Scanner using Web Bluetooth"><meta property="og:description" content="I have recently been looking at the Contact Tracing specifications that Apple and Google released earlier this year in aid of the fight against COVID-19. Looking through these documents allowed me to grasp how the system was put together. It also helped ease concerns that family members had regarding how privacy-conscious the Exposure Notification system is."><meta property="og:locale" content="en_GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-19T00:00:00+00:00"><meta property="article:modified_time" content="2020-10-19T00:00:00+00:00"><meta property="article:tag" content="Contact-Tracing"><meta property="article:tag" content="Javascript"><meta property="article:tag" content="Web-Bluetooth"><meta name=twitter:card content="summary"><meta name=twitter:title content="Creating a Contact Tracing Scanner using Web Bluetooth"><meta name=twitter:description content="I have recently been looking at the Contact Tracing specifications that Apple and Google released earlier this year in aid of the fight against COVID-19. Looking through these documents allowed me to grasp how the system was put together. It also helped ease concerns that family members had regarding how privacy-conscious the Exposure Notification system is."><meta name=twitter:site content="@edd_mann"><link rel="preload stylesheet" as=style href=/css/style.min.6c18b9cbfe138a24784e64860eaa9d70076170f03c68d8be3b3f1ae99e51df9f.css integrity="sha256-bBi5y/4TiiR4TmSGDqqdcAdhcPA8aNi+Oz8a6Z5R358="><link rel=preload as=image href=/assets/x.svg><link rel=preload as=image href=/assets/github.svg><link rel=icon type=image/png sizes=32x32 href=/favicon-32x3x.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://eddmann.com/posts/creating-a-contact-tracing-scanner-using-web-bluetooth/></head><body><header class="site-header wrapper"><a href=https://eddmann.com/><h3 class=site-header__title>Edd Mann
<span style=--url:url(/assets/code.svg)>Developer</span></h3></a><div class=site-header__mobile-navigation-button aria-label="Toggle mobile site navigation" aria-expanded=false aria-controls=site-navigation></div><div class=site-header__navigation id=site-navigation><nav aria-label="Primary navigation"><ul class=site-header__primary-navigation><li><a href=/archive>Archive</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li></ul></nav><nav aria-label="Social links"><ul class=site-header__social-navigation><li><a class=social-icon style=--url:url(/assets/x.svg) href=https://x.com/edd_mann rel="external noopener" target=_blank>Twitter (X)</a></li><li><a class=social-icon style=--url:url(/assets/github.svg) href=https://github.com/eddmann rel="external noopener" target=_blank>GitHub</a></li></ul></nav></div></header><main class=wrapper><article><header class=page-title><h1>Creating a Contact Tracing Scanner using Web Bluetooth</h1><time class=post__time>Oct 19, 2020</time></header><main class=prose><p>I have recently been looking at the <a href=https://covid19.apple.com/contacttracing rel="external noopener" target=_blank>Contact Tracing specifications</a> that Apple and Google released earlier this year in aid of the fight against COVID-19.
Looking through these documents allowed me to grasp how the system was put together.
It also helped ease concerns that family members had regarding how privacy-conscious the Exposure Notification system is.</p><p>I decided to make a Web Bluetooth-based <a href=https://eddmann.com/contact-tracing-scanner-web/>scanning application</a> which highlighted what an Exposure Notification-enabled device actually emits.</p><p><a href=https://eddmann.com/contact-tracing-scanner-web/><picture><source type=image/webp srcset=/posts/creating-a-contact-tracing-scanner-using-web-bluetooth/contact-tracing-scanner_hu_8e2e6a43b030a873.webp><source type=image/jpeg srcset=/posts/creating-a-contact-tracing-scanner-using-web-bluetooth/contact-tracing-scanner_hu_4a2ead0532b3e8ad.jpg><img src=/posts/creating-a-contact-tracing-scanner-using-web-bluetooth/contact-tracing-scanner_hu_4a2ead0532b3e8ad.jpg alt="Contact Tracing Scanner using Web Bluetooth" loading=lazy></picture></a></p><h2 id=how-it-works>How it works</h2><p>The <a href=https://en.wikipedia.org/wiki/Exposure_Notification rel="external noopener" target=_blank>Exposure Notification system</a> designed by Apple and Google uses the GATT Bluetooth LE protocol to emit advertisements using the registered service UUID <code>0xfd6f</code>.
These advertisements are sent using the format outlined in the <a href=https://covid19-static.cdn-apple.com/applications/covid19/current/static/contact-tracing/pdf/ExposureNotification-BluetoothSpecificationv1.2.pdf rel="external noopener" target=_blank>Exposure Notification Bluetooth Specification</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>setActiveScan</span>(
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>navigator</span>.<span style=color:#a6e22e>bluetooth</span>.<span style=color:#a6e22e>requestLEScan</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>filters</span><span style=color:#f92672>:</span> [{ <span style=color:#a6e22e>services</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>0xfd6f</span>] }],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>keepRepeatedDevices</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>Using the Web Bluetooth API, we are able to scan for devices that are emitting these kinds of service advertisements.
We are then able to parse the payloads&rsquo; service data to retrieve the current <em>Rolling Proximity Identifier</em> and <em>Encrypted Metadata</em> for that device.
You will notice that every 10 minutes or so both the device UUID and Rolling Proximity Identifier change.
This is for privacy concerns and is in line with the <a href=https://covid19-static.cdn-apple.com/applications/covid19/current/static/contact-tracing/pdf/ExposureNotification-CryptographySpecificationv1.2.pdf rel="external noopener" target=_blank>Exposure Notification Cryptography Specification</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>onAdvertisementReceived</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>event</span> =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>serviceData</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>serviceData</span>.<span style=color:#a6e22e>get</span>(<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>uuids</span>[<span style=color:#ae81ff>0</span>]).<span style=color:#a6e22e>buffer</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setDevices</span>(<span style=color:#a6e22e>devices</span> =&gt; ({
</span></span><span style=display:flex><span>    ...<span style=color:#a6e22e>devices</span>,
</span></span><span style=display:flex><span>    [<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>device</span>.<span style=color:#a6e22e>id</span>]<span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>uuid</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>device</span>.<span style=color:#a6e22e>id</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>rollingProximityId</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>toHex</span>(<span style=color:#a6e22e>serviceData</span>.<span style=color:#a6e22e>slice</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>16</span>)),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>metadata</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>toHex</span>(<span style=color:#a6e22e>serviceData</span>.<span style=color:#a6e22e>slice</span>(<span style=color:#ae81ff>16</span>)),
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>rssi</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>rssi</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>lastSeen</span><span style=color:#f92672>:</span> Date.<span style=color:#a6e22e>now</span>(),
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  }));
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>The Encrypted Metadata includes the transmitted power (txPower) value at which the Bluetooth device is currently emitting.
Upon a positive diagnosis, the last 14 days&rsquo; <em>Temporary Exposure Keys</em> are sent to the Diagnosis Server.
Every interested device can then download these keys and verify if they are aware of any derived Rolling Proximity Identifier.
If there is a match, then the associated payloads&rsquo; Encrypted Metadata can be decrypted using the day&rsquo;s Temporary Exposure Key.
This leads to a more accurate distance value being calculated based on the <em>Received Signal Strength Indicator</em> (RSSI) and transmitted power.</p></main><footer class=post__tags><a href=/archive/tag/contact-tracing>contact-tracing</a><a href=/archive/tag/javascript>javascript</a><a href=/archive/tag/web-bluetooth>web-bluetooth</a></footer></article></main><footer class="site-footer wrapper"><div>&copy; 2025, Edd Mann</div></footer><script>(function(){document.querySelector(".site-header__mobile-navigation-button").addEventListener("click",e=>{document.documentElement.classList.toggle("mobile-navigation-open"),e.target.setAttribute("aria-expanded",e.target.getAttribute("aria-expanded")==="false"?"true":"false")});const n=document.querySelector(".site-header");let t=window.pageYOffset,e=!1;window.addEventListener("scroll",()=>{if(e)return;const s=window.pageYOffset;window.requestAnimationFrame(()=>{n.classList.toggle("is-sticky",t>s),t=s,e=!1}),e=!0})})()</script></body></html>