<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Advent of Code 2015 - Day 12 - JSAbacusFramework.io - Edd Mann</title>
<meta name=description content="Solving the Advent of Code 2015 Day 12 puzzle using TypeScript."><meta name=author content="Edd Mann"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQ7WHNXH4"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZPQ7WHNXH4")}</script><meta itemprop=name content="Advent of Code 2015 - Day 12 - JSAbacusFramework.io"><meta itemprop=description content="On the twelfth day of Advent of Code 2015, Santaâ€™s Accounting-Elves need help balancing the books after a recent order."><meta itemprop=datePublished content="2021-02-05T00:00:00+00:00"><meta itemprop=dateModified content="2021-02-05T00:00:00+00:00"><meta itemprop=wordCount content="459"><meta itemprop=keywords content="Advent-of-Code,Advent-of-Code-2015,Typescript"><meta property="og:url" content="https://eddmann.com/posts/advent-of-code-2015-day-12-jsabacusframework-io/"><meta property="og:site_name" content="Edd Mann"><meta property="og:title" content="Advent of Code 2015 - Day 12 - JSAbacusFramework.io"><meta property="og:description" content="On the twelfth day of Advent of Code 2015, Santaâ€™s Accounting-Elves need help balancing the books after a recent order."><meta property="og:locale" content="en_GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-02-05T00:00:00+00:00"><meta property="article:modified_time" content="2021-02-05T00:00:00+00:00"><meta property="article:tag" content="Advent-of-Code"><meta property="article:tag" content="Advent-of-Code-2015"><meta property="article:tag" content="Typescript"><meta name=twitter:card content="summary"><meta name=twitter:title content="Advent of Code 2015 - Day 12 - JSAbacusFramework.io"><meta name=twitter:description content="On the twelfth day of Advent of Code 2015, Santaâ€™s Accounting-Elves need help balancing the books after a recent order."><meta name=twitter:site content="@edd_mann"><link rel="preload stylesheet" as=style href=/css/style.min.6c18b9cbfe138a24784e64860eaa9d70076170f03c68d8be3b3f1ae99e51df9f.css integrity="sha256-bBi5y/4TiiR4TmSGDqqdcAdhcPA8aNi+Oz8a6Z5R358="><link rel=preload as=image href=/assets/x.svg><link rel=preload as=image href=/assets/github.svg><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://eddmann.com/posts/advent-of-code-2015-day-12-jsabacusframework-io/></head><body><header class="site-header wrapper"><a href=https://eddmann.com/><h3 class=site-header__title>Edd Mann
<span style=--url:url(/assets/code.svg)>Developer</span></h3></a><div class=site-header__mobile-navigation-button aria-label="Toggle mobile site navigation" aria-expanded=false aria-controls=site-navigation></div><div class=site-header__navigation id=site-navigation><nav aria-label="Primary navigation"><ul class=site-header__primary-navigation><li><a href=/archive>Archive</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li></ul></nav><nav aria-label="Social links"><ul class=site-header__social-navigation><li><a class=social-icon style=--url:url(/assets/x.svg) href=https://x.com/edd_mann rel="external noopener" target=_blank>Twitter (X)</a></li><li><a class=social-icon style=--url:url(/assets/github.svg) href=https://github.com/eddmann rel="external noopener" target=_blank>GitHub</a></li></ul></nav></div></header><main class=wrapper><article><header class=page-title><h1>Advent of Code 2015 - Day 12 - JSAbacusFramework.io</h1><time class=post__time>Feb 5, 2021</time></header><main class=prose><p>On the twelfth day of Advent of Code 2015, Santa&rsquo;s Accounting-Elves need help balancing the books after a recent order.</p><h2 id=part-1>Part 1</h2><p>The supplied input comes in the form of a serialised JSON document, of which we are initially asked to sum up all the numbers present.
For this, we are required to traverse through the deserialised document structure and sum up all the numbers.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sumJsonNumbers</span> <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>x</span>: <span style=color:#66d9ef>any</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>isSkipped</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>_</span>: <span style=color:#66d9ef>any</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isSkipped</span>(<span style=color:#a6e22e>x</span>)) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;number&#39;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>x</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;object&#39;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> Object.<span style=color:#a6e22e>values</span>(<span style=color:#a6e22e>x</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>y</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>sumJsonNumbers</span>(<span style=color:#a6e22e>y</span>, <span style=color:#a6e22e>isSkipped</span>))
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>reduce</span>(<span style=color:#a6e22e>sum</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>With some pre-warning that part two will require us to inspect the provided document in some form, I have opted to provide the ability to optionally include a predicate function which will skip the provided sub-section.
As stated in the problem, we can expect all number values to be typed as such, and none are present in string form.
Using this function, we can now invoke it with the supplied deserialised JSON document to return the desired answer ðŸŒŸ.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>part1</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>input</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span> <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sumJsonNumbers</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>input</span>));
</span></span></code></pre></div><h2 id=part-2>Part 2</h2><p>As alluded to in part one, we are now required to, instead of simply summing up <em>all</em> numbers present, apply some predicate logic.
We are now asked to ignore any object (and all of its children) that has any property with the value &ldquo;red&rdquo;.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>part2</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>input</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span> <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sumJsonNumbers</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>input</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>x</span> <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;object&#39;</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>!</span>Array.<span style=color:#a6e22e>isArray</span>(<span style=color:#a6e22e>x</span>) <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>      Object.<span style=color:#a6e22e>values</span>(<span style=color:#a6e22e>x</span>).<span style=color:#a6e22e>includes</span>(<span style=color:#e6db74>&#39;red&#39;</span>)
</span></span><span style=display:flex><span>  );
</span></span></code></pre></div><p>The predicate function itself checks to ensure that the current document value is not an Array (as Arrays are represented as Objects in JavaScript) and then attempts to see if any of the Object&rsquo;s values include the value &ldquo;red&rdquo;.
We can then invoke the <code>sumJsonNumbers</code> function again, returning the required answer for part two ðŸŒŸ.</p><h2 id=alternative-solution>Alternative Solution</h2><p>Alternatively, we could tackle this problem in a more simplified manner.
Instead of deserialising the JSON document and recursing over its contents, we could just employ a Regular Expression to extract all numbers present.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>part1</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>input</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span> <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>input</span>.<span style=color:#a6e22e>match</span>(<span style=color:#e6db74>/(-?\d)+/g</span>) <span style=color:#f92672>||</span> []).<span style=color:#a6e22e>reduce</span>(
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>sum</span>, <span style=color:#a6e22e>val</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>sum</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>toInt</span>(<span style=color:#a6e22e>val</span>),
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>  );
</span></span></code></pre></div><p>For solving part two, we could then harness a lesser-known second argument to <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse rel="external noopener" target=_blank><code>JSON.parse</code></a> and ensure that when attempting to deserialise the input, we <em>revive</em> its contents only if it matches the given predicate.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>part2</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>input</span>: <span style=color:#66d9ef>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>number</span> <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>part1</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>input</span>, (<span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>value</span>) <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>value</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;object&#39;</span> <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>!</span>Array.<span style=color:#a6e22e>isArray</span>(<span style=color:#a6e22e>value</span>) <span style=color:#f92672>&amp;&amp;</span>
</span></span><span style=display:flex><span>        Object.<span style=color:#a6e22e>values</span>(<span style=color:#a6e22e>value</span>).<span style=color:#a6e22e>includes</span>(<span style=color:#e6db74>&#39;red&#39;</span>)
</span></span><span style=display:flex><span>          <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>:</span> <span style=color:#a6e22e>value</span>
</span></span><span style=display:flex><span>      )
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>  );
</span></span></code></pre></div><p>We can then subsequently re-serialise this reduced JSON document and supply it to our part one solution to determine the answer.</p></main><footer class=post__tags><a href=/archive/tag/advent-of-code>advent-of-code</a><a href=/archive/tag/advent-of-code-2015>advent-of-code-2015</a><a href=/archive/tag/typescript>typescript</a></footer></article></main><footer class="site-footer wrapper"><div>&copy; 2025, Edd Mann</div></footer><script>(function(){document.querySelector(".site-header__mobile-navigation-button").addEventListener("click",e=>{document.documentElement.classList.toggle("mobile-navigation-open"),e.target.setAttribute("aria-expanded",e.target.getAttribute("aria-expanded")==="false"?"true":"false")});const n=document.querySelector(".site-header");let t=window.pageYOffset,e=!1;window.addEventListener("scroll",()=>{if(e)return;const s=window.pageYOffset;window.requestAnimationFrame(()=>{n.classList.toggle("is-sticky",t>s),t=s,e=!1}),e=!0})})()</script></body></html>