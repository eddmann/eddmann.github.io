<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Learn how to schedule EC2 instances using AWS Lambda and CloudWatch Events to optimise costs and automate server management.">

    <title>
        
            Scheduling EC2 Instances using Lambda and CloudWatch Events &middot; Edd Mann
        
    </title>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQ7WHNXH4"></script>
    <script>
       window.dataLayer = window.dataLayer || [];
       function gtag(){dataLayer.push(arguments);}
       gtag('js', new Date());
       gtag('config', 'G-ZPQ7WHNXH4');
    </script>

    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/styles.css">

    <link rel="shortcut icon" href="/favicon.ico">

    <link rel="alternate" href="/rss.xml" title="" type="application/rss+xml">

    
</head>

    <body>
        <div class="container content">
            <header class="masthead">
                <h3 class="masthead-title">
                    <a href="/" title="Home">Edd Mann</a>
                    <small><i class="fa fa-code"></i> Developer</small>
                </h3>
                <nav>
                    <a href="https://twitter.com/edd_mann"><i class="fa fa-twitter"></i></a>
                    <a href="https://github.com/eddmann"><i class="fa fa-github"></i></a>
                    <a href="mailto:the@eddmann.com"><i class="fa fa-envelope"></i></a>
                </nav>
                <div class="cf"></div>
            </header>

            <main>
                <article class="post">
    <h1 class="post-title">Scheduling EC2 Instances using Lambda and CloudWatch Events</h1>
    <time datetime="2017-11-24T00:00:00+00:00" class="post-date">24 Nov 2017</time>
    <p>Over the past couple of months, MyBuilder has been transitioning from primarily a dedicated server stack (with orchestration through <a href="https://puppet.com/">Puppet</a>) to cloud infrastructure by way of <a href="https://aws.amazon.com/">Amazon Web Services</a>.
We have been a proponent of AWS for quite some time, taking advantage of services such as S3 and CloudFront in our current setup.
We are also not unfamiliar with EC2, spreading some of our application requirements onto several instances over the past couple of years.
However, we have not been fully embracing the ‘Cloud nature’ of the product and are still treating each server as something between a <a href="https://martinfowler.com/bliki/SnowflakeServer.html">Snowflake</a> and a <a href="https://martinfowler.com/bliki/PhoenixServer.html">Phoenix</a>.</p>



<p>As the team and business needs expand, we felt this was an opportune time to embrace more of its offerings.
I’ve recently discussed the reasoning behind this thought process on a <a href="http://threedevsandamaybe.com/lets-aws-everything/">podcast</a> I co-host.
Throughout this transition period, I wish to document our experiences moving solely over to the platform, sprinkling in a little Lambda along the way.</p>

<h2 id="starting-and-stopping-instances">Starting and Stopping Instances</h2>

<p>One of the key advantages of the Infrastructure as a Service (IaaS) movement is the ability to provision resources as and when you require them.
A good use case for this added functionality is the ability to start and stop development resources based on typical workweek patterns, providing additional cost savings.
In the video below, I highlight how you can start and stop EC2 instances in a scheduled (Cron-like) manner using Lambda, Node.js, and CloudWatch Events.</p>

<p><iframe width="100%" height="367px" src="https://www.youtube.com/embed/roAerKVfq-Y?rel=0" frameborder="0" allowfullscreen=""></iframe></p>

<p>The associated code used in this video can be found <a href="https://gist.github.com/eddmann/a9e404eb62056f77610f752606a2e504">here</a>.</p>

<h2 id="scaling-instances">Scaling Instances</h2>

<p>I would now like to expand upon this example by taking advantage of another IaaS benefit - scaling a given resource based on your current demands.
In a similar manner to the first demonstration, I will now explain how you can scale an EC2 instance up and down based on a given schedule.</p>

<p><iframe width="100%" height="367px" src="https://www.youtube.com/embed/_gJyK1-NGq8?rel=0" frameborder="0" allowfullscreen=""></iframe></p>

<p>The associated code used in this video can be found <a href="https://gist.github.com/eddmann/ce2c65e4000d07c421ad266d449550ab">here</a>.</p>

<p>I hope these two short videos have highlighted some of the power that can be gained from using Function as a Service (FaaS) platforms such as Lambda in a server-management setting.
Both use cases would not have been possible in our previous dedicated server setup and give a small glimpse into the world of automating cloud-based server resources.</p>

</article>

            </main>

            <footer class="footer">
                <img src="https://www.gravatar.com/avatar/c5c2978bb14d16460f73399c394b6acd?s=160">
                <ul>
                    <li>Developer at <a href="http://www.mybuilder.com/">MyBuilder</a></li>
                    <li><a href="http://threedevsandamaybe.com/">Three Devs and a Maybe</a> podcast co-host</li>
                    <li>All ramblings can be found in the <a href="/archive/">Archive</a></li>
                </ul>
                <div class="cf"></div>
            </footer>
        </div>
    </body>
</html>
