<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Solving the Advent of Code 2015 Day 14 puzzle using TypeScript">

    <title>Advent of Code 2015 - Day 14 - Reindeer Olympics &middot; Edd Mann</title>

    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/styles.css">

    <link rel="shortcut icon" href="/favicon.ico">

    <link rel="alternate" href="/rss.xml" title="" type="application/rss+xml">

    <script>
        var _gaq=[['_setAccount','UA-32512081-1'],['_setDomainName','eddmann.com'],['_trackPageview']];
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = 'https://ssl.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>
</head>

    <body>
        <div class="container content">
            <header class="masthead">
                <h3 class="masthead-title">
                    <a href="/" title="Home">Edd Mann</a>
                    <small><i class="fa fa-code"></i> Developer</small>
                </h3>
                <nav>
                    <a href="https://twitter.com/edd_mann"><i class="fa fa-twitter"></i></a>
                    <a href="https://github.com/eddmann"><i class="fa fa-github"></i></a>
                    <a href="mailto:the@eddmann.com"><i class="fa fa-envelope"></i></a>
                </nav>
                <div class="cf"></div>
            </header>

            <main>
                <article class="post">
    <h1 class="post-title">Advent of Code 2015 - Day 14 - Reindeer Olympics</h1>
    <time datetime="2021-02-07T00:00:00-06:00" class="post-date">07 Feb 2021</time>
    <p>On the fourteen day of Advent of Code 2015 Santa wants to find out who is the fastest reindeer.</p>



<h3 id="part-1">Part 1</h3>

<p>We are provided with a listing of all the nine reindeer; stating how fast they can travel per second, how many seconds they can fly for at the given speed and how many seconds they require subsequently to rest.
We are tasked with first determining the distance of the reindeer who would travel the furthest in <em>2503 seconds</em>.
To begin, we parse the reindeer input we have been supplied.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">type</span> <span class="nx">Reindeer</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">speed</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nl">fly</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
  <span class="nl">rest</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">parseReindeer</span> <span class="o">=</span> <span class="p">(</span><span class="nx">input</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="nx">Reindeer</span><span class="p">[]</span> <span class="o">=&gt;</span>
  <span class="nx">input</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="se">\n</span><span class="dl">'</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">line</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">[</span><span class="nx">speed</span><span class="p">,</span> <span class="nx">fly</span><span class="p">,</span> <span class="nx">rest</span><span class="p">]</span> <span class="o">=</span> <span class="nx">line</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/</span><span class="se">(\d</span><span class="sr">+</span><span class="se">)</span><span class="sr">/g</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">toInt</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">{</span> <span class="nx">speed</span><span class="p">,</span> <span class="nx">fly</span><span class="p">,</span> <span class="nx">rest</span> <span class="p">};</span>
  <span class="p">});</span>
</code></pre></div></div>

<p>As we are not required to provide the name of the reindeer, we can omit this from the parsed representation.
For our initial solution we are going to create a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator">Generator</a> which will yield the current distance travelled every second that is elasped.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span><span class="o">*</span> <span class="nx">simulate</span><span class="p">({</span>
  <span class="nx">speed</span><span class="p">,</span>
  <span class="nx">fly</span><span class="p">,</span>
  <span class="nx">rest</span><span class="p">,</span>
<span class="p">}:</span> <span class="nx">Reindeer</span><span class="p">):</span> <span class="nx">Generator</span><span class="o">&lt;</span><span class="kr">number</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">elapsed</span> <span class="o">=</span> <span class="nx">fly</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">isFlying</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">distance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">elapsed</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">isFlying</span> <span class="o">=</span> <span class="o">!</span><span class="nx">isFlying</span><span class="p">;</span>
      <span class="nx">elapsed</span> <span class="o">=</span> <span class="nx">isFlying</span> <span class="p">?</span> <span class="nx">fly</span> <span class="p">:</span> <span class="nx">rest</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">isFlying</span><span class="p">)</span> <span class="nx">distance</span> <span class="o">+=</span> <span class="nx">speed</span><span class="p">;</span>
    <span class="nx">elapsed</span><span class="o">--</span><span class="p">;</span>

    <span class="k">yield</span> <span class="nx">distance</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>With this iterative approach we simulate the logic around alternating between flying and resting states.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">nth</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">g</span><span class="p">:</span> <span class="nx">Generator</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">,</span> <span class="nx">n</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="nx">T</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">v</span> <span class="k">of</span> <span class="nx">g</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">--</span><span class="nx">n</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="nx">v</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<p>To produce a more succinct solution I have decided to include a small utility function which iterates through the generator returning the <code class="language-plaintext highlighter-rouge">nth</code> value.
With the building blocks now in place we can now proceed to answer the question to part one ðŸŒŸ.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">part1</span> <span class="o">=</span> <span class="p">(</span><span class="nx">input</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">number</span> <span class="o">=&gt;</span>
  <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(...</span><span class="nx">parseReindeer</span><span class="p">(</span><span class="nx">input</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">r</span> <span class="o">=&gt;</span> <span class="nx">nth</span><span class="p">(</span><span class="nx">simulate</span><span class="p">(</span><span class="nx">r</span><span class="p">),</span> <span class="mi">2503</span><span class="p">)));</span>
</code></pre></div></div>

<h3 id="part-2">Part 2</h3>

<p>For part two, we are again asked to simulate the distance travelled for <em>2503 seconds</em>, however, a point is now awarded each second to the reindeer that has travelled the furthest distance at that time.
Once all reindeer points have been awarded we are asked to return the winning reindeers total points.</p>

<p>Like in part one, we can re-use the <code class="language-plaintext highlighter-rouge">simulate</code> Generator function, expect now per iteration we record all the total distances travelled and award the winning reindeer with a point.
From here, we return the highest recorded reindeers points to answer the qestion ðŸŒŸ.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">part2</span> <span class="o">=</span> <span class="p">(</span><span class="nx">input</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">number</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">reindeer</span> <span class="o">=</span> <span class="nx">parseReindeer</span><span class="p">(</span><span class="nx">input</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">simulate</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">points</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="o">&lt;</span><span class="kr">number</span><span class="p">,</span> <span class="kr">number</span><span class="o">&gt;</span><span class="p">();</span>

  <span class="nx">repeat</span><span class="p">(</span><span class="mi">2503</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">distances</span> <span class="o">=</span> <span class="nx">reindeer</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">g</span> <span class="o">=&gt;</span> <span class="nx">g</span><span class="p">.</span><span class="nx">next</span><span class="p">().</span><span class="nx">value</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">winner</span> <span class="o">=</span> <span class="nx">distances</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(...</span><span class="nx">distances</span><span class="p">));</span>
    <span class="nx">points</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">winner</span><span class="p">,</span> <span class="p">(</span><span class="nx">points</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">winner</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(...</span><span class="nx">points</span><span class="p">.</span><span class="nx">values</span><span class="p">());</span>
<span class="p">};</span>
</code></pre></div></div>

<p>For this solution I was able to harness the <code class="language-plaintext highlighter-rouge">repeat</code> function we created for <a href="https://eddmann.com/posts/advent-of-code-2015-day-10-elves-look-elves-say/">Day 10</a>.
This abstracts away the need to implement a stateful loop and focuses on the problem at hand.
I have also decided to omit the reindeers name and identify each reindeer based on theirposition within the listing.</p>

<h3 id="alternative-solution">Alternative Solution</h3>

<p>Since implementing the above solution I have been exploring how we could skip the iterative simulation step all together and apply a little math to produce the answer.
As such, we are able to replace the <code class="language-plaintext highlighter-rouge">simulate</code> Generator with a function that takes in the reindeer details and seconds elapsed like so:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">simulate</span> <span class="o">=</span> <span class="p">(</span>
  <span class="p">{</span> <span class="nx">speed</span><span class="p">,</span> <span class="nx">fly</span><span class="p">,</span> <span class="nx">rest</span> <span class="p">}:</span> <span class="nx">Reindeer</span><span class="p">,</span>
  <span class="nx">seconds</span><span class="p">:</span> <span class="kr">number</span>
<span class="p">):</span> <span class="kr">number</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">quotient</span><span class="p">,</span> <span class="nx">remainder</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">seconds</span> <span class="o">/</span> <span class="p">(</span><span class="nx">fly</span> <span class="o">+</span> <span class="nx">rest</span><span class="p">)),</span>
    <span class="nx">seconds</span> <span class="o">%</span> <span class="p">(</span><span class="nx">fly</span> <span class="o">+</span> <span class="nx">rest</span><span class="p">),</span>
  <span class="p">];</span>
  <span class="k">return</span> <span class="p">(</span><span class="nx">quotient</span> <span class="o">*</span> <span class="nx">fly</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">remainder</span><span class="p">,</span> <span class="nx">fly</span><span class="p">))</span> <span class="o">*</span> <span class="nx">speed</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Within the function above we deduce the total seconds flown (taking into consideration required rest) and multiply that by the speed per second to return the total distance covered.
We can then answer part one in a similiar fashion to how we did the original solution - expect this time we can omit the need to compute each iteration.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">part1</span> <span class="o">=</span> <span class="p">(</span><span class="nx">input</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">number</span> <span class="o">=&gt;</span>
  <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(...</span><span class="nx">parseReindeer</span><span class="p">(</span><span class="nx">input</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">r</span> <span class="o">=&gt;</span> <span class="nx">simulate</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="mi">2503</span><span class="p">)));</span>
</code></pre></div></div>

<p>To answer part two we can reduce over each second elapsed and upon each step update the points mapping according to the winner.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">part2</span> <span class="o">=</span> <span class="p">(</span><span class="nx">input</span><span class="p">:</span> <span class="kr">string</span><span class="p">):</span> <span class="kr">number</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">reindeer</span> <span class="o">=</span> <span class="nx">parseReindeer</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">points</span> <span class="o">=</span> <span class="p">[...</span><span class="nb">Array</span><span class="p">(</span><span class="mi">2503</span><span class="p">).</span><span class="nx">keys</span><span class="p">()].</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">points</span><span class="p">,</span> <span class="nx">seconds</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">distances</span> <span class="o">=</span> <span class="nx">reindeer</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">r</span> <span class="o">=&gt;</span> <span class="nx">simulate</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span> <span class="nx">seconds</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
    <span class="kd">const</span> <span class="nx">winner</span> <span class="o">=</span> <span class="nx">distances</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(...</span><span class="nx">distances</span><span class="p">));</span>
    <span class="k">return</span> <span class="nx">points</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">winner</span><span class="p">,</span> <span class="p">(</span><span class="nx">points</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">winner</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
  <span class="p">},</span> <span class="k">new</span> <span class="nb">Map</span><span class="o">&lt;</span><span class="kr">number</span><span class="p">,</span> <span class="kr">number</span><span class="o">&gt;</span><span class="p">());</span>

  <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(...</span><span class="nx">points</span><span class="p">.</span><span class="nx">values</span><span class="p">());</span>
<span class="p">};</span>
</code></pre></div></div>

<p>This solution again leverages the position of the reindeer in the listing for identity.</p>

</article>

            </main>

            <footer class="footer">
                <img src="https://www.gravatar.com/avatar/c5c2978bb14d16460f73399c394b6acd?s=160">
                <ul>
                    <li>Developer at <a href="http://www.mybuilder.com/">MyBuilder</a></li>
                    <li><a href="http://threedevsandamaybe.com/">Three Devs and a Maybe</a> podcast co-host</li>
                    <li>All ramblings can be found in the <a href="/archive/">Archive</a></li>
                </ul>
                <div class="cf"></div>
            </footer>
        </div>
    </body>
</html>
