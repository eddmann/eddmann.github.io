<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Advent of Code 2016 - Day 5 - How About a Nice Game of Chess? - Edd Mann</title>
<meta name=description content="Solving the Advent of Code 2016 Day 5 puzzle using Python."><meta name=author content="Edd Mann"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQ7WHNXH4"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZPQ7WHNXH4")}</script><meta itemprop=name content="Advent of Code 2016 - Day 5 - How About a Nice Game of Chess?"><meta itemprop=description content="On the fifth day of Advent of Code 2016, we are asked to calculate the password for a security door in Easter Bunny HQ."><meta itemprop=datePublished content="2021-03-27T00:00:00+00:00"><meta itemprop=dateModified content="2021-03-27T00:00:00+00:00"><meta itemprop=wordCount content="387"><meta itemprop=keywords content="Advent-of-Code,Advent-of-Code-2016,Python"><meta property="og:url" content="https://eddmann.com/posts/advent-of-code-2016-day-5-how-about-a-nice-game-of-chess/"><meta property="og:site_name" content="Edd Mann"><meta property="og:title" content="Advent of Code 2016 - Day 5 - How About a Nice Game of Chess?"><meta property="og:description" content="On the fifth day of Advent of Code 2016, we are asked to calculate the password for a security door in Easter Bunny HQ."><meta property="og:locale" content="en_GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-03-27T00:00:00+00:00"><meta property="article:modified_time" content="2021-03-27T00:00:00+00:00"><meta property="article:tag" content="Advent-of-Code"><meta property="article:tag" content="Advent-of-Code-2016"><meta property="article:tag" content="Python"><meta name=twitter:card content="summary"><meta name=twitter:title content="Advent of Code 2016 - Day 5 - How About a Nice Game of Chess?"><meta name=twitter:description content="On the fifth day of Advent of Code 2016, we are asked to calculate the password for a security door in Easter Bunny HQ."><meta name=twitter:site content="@edd_mann"><link rel=stylesheet href=/css/style.min.4c8b66c005db4efc68625e4ceed190f2dc110d342d05ffb19ba924cc13c3ef15.css integrity="sha256-TItmwAXbTvxoYl5M7tGQ8twRDTQtBf+xm6kkzBPD7xU="><link rel=preload as=image href=/assets/x.svg crossorigin=anonymous><link rel=preload as=image href=/assets/github.svg crossorigin=anonymous><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://eddmann.com/posts/advent-of-code-2016-day-5-how-about-a-nice-game-of-chess/><script>document.documentElement.setAttribute("data-theme",localStorage.getItem("theme")||window.matchMedia("(prefers-color-scheme: dark)").matches&&"dark"||"light")</script><script src=/script.min.da71ac9c7b8bd4e644618df0ab735aed1393aad3cb5e5c57e5adc300fe7c8209.js integrity="sha256-2nGsnHuL1OZEYY3wq3Na7ROTqtPLXlxX5a3DAP58ggk=" defer></script></head><body><header class="site-header l-wrapper"><a href=https://eddmann.com/><h3 class=site-header__title>Edd Mann
<span style=--url:url(/assets/code.svg)>Developer</span></h3></a><button class=site-header__mobile-navigation-button type=button title="Toggle mobile site navigation" aria-label="Toggle mobile site navigation" aria-expanded=false aria-controls=site-navigation></button><div class=site-header__navigation id=site-navigation><nav aria-label="Primary navigation"><ul class=site-header__primary-navigation><li><a href=/archive>Archive</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li><li><a href=/cv.html>CV</a></li></ul></nav><nav aria-label="Social links"><ul class=site-header__social-navigation><li><a class=social-icon style=--url:url(/assets/x.svg) href=https://x.com/edd_mann rel="external noopener" target=_blank>Twitter (X)</a></li><li><a class=social-icon style=--url:url(/assets/github.svg) href=https://github.com/eddmann rel="external noopener" target=_blank>GitHub</a></li></ul></nav></div></header><main class=l-wrapper><article><header class=l-page-title><h1 class=u-transition-between-pages style=--id:advent-of-code-2016-day-5-how-about-a-nice-game-of-chess>Advent of Code 2016 - Day 5 - How About a Nice Game of Chess?</h1><time datetime=2021-03-27T00:00:00Z class=published-at>Mar 27, 2021</time></header><main class=u-prose><p>On the fifth day of Advent of Code 2016, we are asked to calculate the password for a security door in Easter Bunny HQ.</p><h2 id=part-1>Part 1</h2><p>The eight-character password for the security door is generated one character at a time by finding the MD5 hash of the door ID (our input) and an increasing integer index (starting with 0).
A hash indicates the next character in the password if its hexadecimal representation starts with five zeroes, with the sixth character being the next password character.</p><p>We will begin by creating a small helper function that simplifies Python&rsquo;s capabilities to hash values using MD5.
Out-of-the-box, you are required to perform some additional steps both before and after generating the hash to return the desired hexadecimal representation.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>md5</span>(value):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> hashlib<span style=color:#f92672>.</span>md5(value<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;utf-8&#39;</span>))<span style=color:#f92672>.</span>hexdigest()
</span></span></code></pre></div><p>We can now use this helper function to build a lazy <em>infinite list</em> that increments from zero and yields hashes in the sequence that match the desired prefix.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>generate_hashes</span>(door_id, padding<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> index <span style=color:#f92672>in</span> itertools<span style=color:#f92672>.</span>count(<span style=color:#ae81ff>0</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (next_hash <span style=color:#f92672>:=</span> md5(door_id <span style=color:#f92672>+</span> str(index)))<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#f92672>*</span> padding):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>yield</span> next_hash
</span></span></code></pre></div><p>With the ability to now perform this generation, we can <em>take</em> the first eight hashes from the sequence and reduce these down to their sixth characters.
Concatenating this listing into string form returns the desired answer ðŸŒŸ.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>PASSWORD_LENGTH <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>part1</span>(input):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(h[<span style=color:#ae81ff>5</span>] <span style=color:#66d9ef>for</span> h <span style=color:#f92672>in</span> itertools<span style=color:#f92672>.</span>islice(generate_hashes(input), PASSWORD_LENGTH))
</span></span></code></pre></div><h2 id=part-2>Part 2</h2><p>For part two, instead of filling in the password from left to right, the hash now also indicates the position within the password to fill.
Based on the same process for generating hashes as in part one, the sixth character now represents the position (0-7), and the seventh character is the character to put in that position.</p><p>We can achieve this by generating hashes from the sequence until all password character <em>slots</em> have been filled.
Python is able to rather nicely map these requirements into code form.
Once all <em>slots</em> have been taken, we can return the desired answer, as shown below ðŸŒŸ.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>part2</span>(input):
</span></span><span style=display:flex><span>    password <span style=color:#f92672>=</span> [<span style=color:#66d9ef>None</span>] <span style=color:#f92672>*</span> PASSWORD_LENGTH
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> h <span style=color:#f92672>in</span> generate_hashes(input):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (index <span style=color:#f92672>:=</span> int(h[<span style=color:#ae81ff>5</span>], <span style=color:#ae81ff>16</span>)) <span style=color:#f92672>in</span> range(PASSWORD_LENGTH) <span style=color:#f92672>and</span> password[index] <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            password[index] <span style=color:#f92672>=</span> h[<span style=color:#ae81ff>6</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#66d9ef>None</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> password:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(password)
</span></span></code></pre></div><p>I found that by taking advantage of hashes all being represented in base-16, we can succinctly parse and validate the sixth character position upon each iteration.</p></main><footer class=post-footer><ul class="tags tags--large"><li><a href=/archive/tag/advent-of-code>advent-of-code</a></li><li><a href=/archive/tag/advent-of-code-2016>advent-of-code-2016</a></li><li><a href=/archive/tag/python>python</a></li></ul><div class=related><h3 class=related__title>Related Posts</h3><ul class=related__posts><li><a href=/posts/advent-of-code-2016-day-4-security-through-obscurity/>Advent of Code 2016 - Day 4 - Security Through Obscurity</a></li><li><a href=/posts/advent-of-code-2016-day-3-squares-with-three-sides/>Advent of Code 2016 - Day 3 - Squares With Three Sides</a></li><li><a href=/posts/advent-of-code-2016-day-2-bathroom-security/>Advent of Code 2016 - Day 2 - Bathroom Security</a></li><li><a href=/posts/advent-of-code-2016-day-1-no-time-for-a-taxicab/>Advent of Code 2016 - Day 1 - No Time for a Taxicab</a></li><li><a href=/posts/advent-of-code-2015-day-25-let-it-snow/>Advent of Code 2015 - Day 25 - Let It Snow</a></li></ul></div></footer></article><div class="podcast-ad u-overlay-wrapper"><div class=podcast-ad__artwork><img src=https://compiledconversations.com/album-art.jpg alt="Compiled Conversations podcast album art" class=podcast-ad__artwork-image></div><div class=podcast-ad__content><h3 class=podcast-ad__title>Compiled Conversations</h3><p class=podcast-ad__description>Podcast I host, featuring conversations with the people shaping software and technology.</p><div class=podcast-ad__link>Check out the show</a></div><a class=u-overlay href=https://compiledconversations.com target=_blank>Listen to Compiled Conversations</a></div><div class=scroll-watcher></div></main><footer class="site-footer l-wrapper"><div>&copy; 2025, Edd Mann</div><button class=site-footer__theme-toggle type=button title="Toggle theme" aria-label="Toggle theme"><svg fill="currentcolor" viewBox="0 0 32 32" role="img"><title>Theme toggle icon</title><desc>A circle representing the moon for toggling theme</desc><path d="M16 .5C7.4.5.5 7.4.5 16S7.4 31.5 16 31.5 31.5 24.6 31.5 16 24.6.5 16 .5zm0 28.1V3.4C23 3.4 28.6 9 28.6 16S23 28.6 16 28.6z"/></svg></button></footer></body></html>