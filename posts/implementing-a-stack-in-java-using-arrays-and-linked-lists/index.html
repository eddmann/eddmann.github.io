<!doctype html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Discover two alternative methods for implementing the commonplace stack data structure in Java using arrays and linked lists to achieve efficient data manipulation.">

    <title>
        
            Implementing a Stack in Java using Arrays and Linked Lists &middot; Edd Mann
        
    </title>

    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/styles.css">

    <link rel="shortcut icon" href="/favicon.ico">

    <link rel="alternate" href="/rss.xml" title="" type="application/rss+xml">

    

    <script>
        var _gaq=[['_setAccount','UA-32512081-1'],['_setDomainName','eddmann.com'],['_trackPageview']];
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = 'https://ssl.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>
</head>

    <body>
        <div class="container content">
            <header class="masthead">
                <h3 class="masthead-title">
                    <a href="/" title="Home">Edd Mann</a>
                    <small><i class="fa fa-code"></i> Developer</small>
                </h3>
                <nav>
                    <a href="https://twitter.com/edd_mann"><i class="fa fa-twitter"></i></a>
                    <a href="https://github.com/eddmann"><i class="fa fa-github"></i></a>
                    <a href="mailto:the@eddmann.com"><i class="fa fa-envelope"></i></a>
                </nav>
                <div class="cf"></div>
            </header>

            <main>
                <article class="post">
    <h1 class="post-title">Implementing a Stack in Java using Arrays and Linked Lists</h1>
    <time datetime="2013-12-22T00:00:00+00:00" class="post-date">22 Dec 2013</time>
    <p>The stack is a fundamental data structure used extensively in algorithm design and program implementation.
At an abstract level, it can be described very simply, as it only allows for the addition (pushing) of new elements and the removal (popping) of existing elements from the top of the stack.
This description can be abbreviated to LIFO, which stands for Last-In-First-Out.
Although you will most likely not have to implement such a structure for practical use cases, it can be very useful to ‘look under the hood’ to gain a better understanding of what is going on.
Doing so will make you more aware of when this data structure can be best used.</p>



<p>The following examples solve the same problem, and as such I have created a simple interface that each implementation must fulfil.
Contractual agreements like this are great when you do not want the implementation details to affect the API that is available, allowing the user to use them interchangeably.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">interface</span> <span class="nc">Stack</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="nc">Stack</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">push</span><span class="o">(</span><span class="no">T</span> <span class="n">ele</span><span class="o">);</span>
    <span class="no">T</span> <span class="nf">pop</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="array-based-implementation">Array-based implementation</h2>

<p>The first implementation I would like to discuss stores the stack contents in an underlying fixed-size array.
Using such a method provides constant time ‘O(1)’ lookup of all items in the collection; however, in the stack’s case this benefit is not warranted.
An initial array (of size 2) is first initialised, and when new elements are added, the running total is incremented.
Additions to the array occur in constant amortised time ‘O(1)’, as they are inserted at the end.
If the array reaches its limit, we then have to perform the linear time ‘O(n)’ task of creating a new array of double the size and copying the contents over.
Using the <code class="language-plaintext highlighter-rouge">System.arraycopy</code> method call is a more <a href="http://stackoverflow.com/questions/8526907/is-javas-system-arraycopy-efficient-for-small-arrays">performant</a> alternative to building the new array ourselves.
When an element is removed (popped) from the stack, a check is performed to see if the array is now a quarter full.
If so, the array is resized again, but this time it is halved.
As resizing the array is a very costly operation, we want to do it as infrequently as possible.
Using the double and quarter rules provides a good balance in typical use cases.</p>

<p>One point to note from this example is the often-overlooked initial capacity parameter with which you can initialise an <a href="http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html">ArrayList</a>.
Implemented conceptually in the same manner, doing so can greatly increase performance if you have an estimate (heuristics) of how large the list is going to grow.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">StackArray</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">Stack</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="no">T</span><span class="o">[]</span> <span class="n">arr</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">total</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">StackArray</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="o">(</span><span class="no">T</span><span class="o">[])</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">resize</span><span class="o">(</span><span class="kt">int</span> <span class="n">capacity</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="no">T</span><span class="o">[]</span> <span class="n">tmp</span> <span class="o">=</span> <span class="o">(</span><span class="no">T</span><span class="o">[])</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[</span><span class="n">capacity</span><span class="o">];</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">arr</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">tmp</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">total</span><span class="o">);</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">StackArray</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">push</span><span class="o">(</span><span class="no">T</span> <span class="n">ele</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">arr</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="n">total</span><span class="o">)</span> <span class="n">resize</span><span class="o">(</span><span class="n">arr</span><span class="o">.</span><span class="na">length</span> <span class="o">*</span> <span class="mi">2</span><span class="o">);</span>
        <span class="n">arr</span><span class="o">[</span><span class="n">total</span><span class="o">++]</span> <span class="o">=</span> <span class="n">ele</span><span class="o">;</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="no">T</span> <span class="nf">pop</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">total</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">NoSuchElementException</span><span class="o">();</span>
        <span class="no">T</span> <span class="n">ele</span> <span class="o">=</span> <span class="n">arr</span><span class="o">[--</span><span class="n">total</span><span class="o">];</span>
        <span class="n">arr</span><span class="o">[</span><span class="n">total</span><span class="o">]</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">total</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">total</span> <span class="o">==</span> <span class="n">arr</span><span class="o">.</span><span class="na">length</span> <span class="o">/</span> <span class="mi">4</span><span class="o">)</span> <span class="n">resize</span><span class="o">(</span><span class="n">arr</span><span class="o">.</span><span class="na">length</span> <span class="o">/</span> <span class="mi">2</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">ele</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">arr</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<h2 id="linked-list-implementation">Linked-List implementation</h2>

<p>The second example is more in line with what you might expect from a language implementation.
Using a linked list is tailor-made to store the contents of a stack, handling the required actions with excellent performance.
Unlike the array implementation, using a linked list provides constant time ‘O(1)’ guarantees when adding an element, as no underlying array requires resizing.
Furthermore, it also provides constant time ‘O(1)’ guarantees when removing (popping) an element, as only a reference requires modification.
This implementation differs in that it creates a new node instance for each addition, each storing its supplied value and a reference to the following node.
These links allow us to maintain the stack and eventually traverse the entire collection once it is emptied.
There are no upfront memory costs when using a linked list, as you only consume the space required for each node when a new value is pushed to the stack.
However, the overhead of each node being an object instance should be taken into consideration.
Another limitation of a linked list is its linear ‘O(n)’ traversal time.
Nevertheless, this is not an issue in this case as we are only concerned with the first (most recent) element.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">StackLinkedList</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">Stack</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">total</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">Node</span> <span class="n">first</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">Node</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="no">T</span> <span class="n">ele</span><span class="o">;</span>
        <span class="kd">private</span> <span class="nc">Node</span> <span class="n">next</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">StackLinkedList</span><span class="o">()</span> <span class="o">{</span> <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">StackLinkedList</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">push</span><span class="o">(</span><span class="no">T</span> <span class="n">ele</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="nc">Node</span> <span class="n">current</span> <span class="o">=</span> <span class="n">first</span><span class="o">;</span>
        <span class="n">first</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Node</span><span class="o">();</span>
        <span class="n">first</span><span class="o">.</span><span class="na">ele</span> <span class="o">=</span> <span class="n">ele</span><span class="o">;</span>
        <span class="n">first</span><span class="o">.</span><span class="na">next</span> <span class="o">=</span> <span class="n">current</span><span class="o">;</span>
        <span class="n">total</span><span class="o">++;</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="no">T</span> <span class="nf">pop</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">first</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">NoSuchElementException</span><span class="o">();</span>
        <span class="no">T</span> <span class="n">ele</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="na">ele</span><span class="o">;</span>
        <span class="n">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="n">total</span><span class="o">--;</span>
        <span class="k">return</span> <span class="n">ele</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="nc">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
        <span class="nc">Node</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">first</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">(</span><span class="n">tmp</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">tmp</span><span class="o">.</span><span class="na">ele</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="s">", "</span><span class="o">);</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="na">next</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<h2 id="example-usage">Example Usage</h2>

<p>Below is an example demonstrating the array implementation in action.
As you can see, I have declared the variable instance as the Stack interface type, which allows me to easily switch out the implementation if future requirements warrant it.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Stack</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">greeting</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StackArray</span><span class="o">&lt;&gt;();</span>

<span class="n">greeting</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="s">"!"</span><span class="o">).</span><span class="na">push</span><span class="o">(</span><span class="s">"World"</span><span class="o">).</span><span class="na">push</span><span class="o">(</span><span class="s">"Hello, "</span><span class="o">);</span>

<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">greeting</span><span class="o">.</span><span class="na">pop</span><span class="o">()</span> <span class="o">+</span> <span class="n">greeting</span><span class="o">.</span><span class="na">pop</span><span class="o">()</span> <span class="o">+</span> <span class="n">greeting</span><span class="o">.</span><span class="na">pop</span><span class="o">());</span> <span class="c1">// Hello, World!</span>
</code></pre></div></div>

</article>

            </main>

            <footer class="footer">
                <img src="https://www.gravatar.com/avatar/c5c2978bb14d16460f73399c394b6acd?s=160">
                <ul>
                    <li>Developer at <a href="http://www.mybuilder.com/">MyBuilder</a></li>
                    <li><a href="http://threedevsandamaybe.com/">Three Devs and a Maybe</a> podcast co-host</li>
                    <li>All ramblings can be found in the <a href="/archive/">Archive</a></li>
                </ul>
                <div class="cf"></div>
            </footer>
        </div>
    </body>
</html>
