<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Mince Pie Challenge: Viewing and Removing Mince Pies with Amazon DynamoDB - Edd Mann</title>
<meta name=description content="A comprehensive guide to viewing and removing mince pies using Amazon DynamoDB as part of the Mince Pie Challenge API."><meta name=author content="Edd Mann"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQ7WHNXH4"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZPQ7WHNXH4")}</script><meta itemprop=name content="Mince Pie Challenge: Viewing and Removing Mince Pies with Amazon DynamoDB"><meta itemprop=description content="In this post we will progress in implementing the proposed endpoint behaviour documented in our RAML design. Using the online/offline DynamoDB abstractions that we constructed in the previous post, we will incorporate the ability to view and remove specified mince pies from the challenge."><meta itemprop=datePublished content="2018-10-16T00:00:00+00:00"><meta itemprop=dateModified content="2018-10-16T00:00:00+00:00"><meta itemprop=wordCount content="1799"><meta itemprop=keywords content="Serverless,Aws,Lambda,Dynamodb,Javascript,Mince-Pie-Challenge-Series"><meta property="og:url" content="https://eddmann.com/posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/"><meta property="og:site_name" content="Edd Mann"><meta property="og:title" content="Mince Pie Challenge: Viewing and Removing Mince Pies with Amazon DynamoDB"><meta property="og:description" content="In this post we will progress in implementing the proposed endpoint behaviour documented in our RAML design. Using the online/offline DynamoDB abstractions that we constructed in the previous post, we will incorporate the ability to view and remove specified mince pies from the challenge."><meta property="og:locale" content="en_GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-10-16T00:00:00+00:00"><meta property="article:modified_time" content="2018-10-16T00:00:00+00:00"><meta property="article:tag" content="Serverless"><meta property="article:tag" content="Aws"><meta property="article:tag" content="Lambda"><meta property="article:tag" content="Dynamodb"><meta property="article:tag" content="Javascript"><meta property="article:tag" content="Mince-Pie-Challenge-Series"><meta name=twitter:card content="summary"><meta name=twitter:title content="Mince Pie Challenge: Viewing and Removing Mince Pies with Amazon DynamoDB"><meta name=twitter:description content="In this post we will progress in implementing the proposed endpoint behaviour documented in our RAML design. Using the online/offline DynamoDB abstractions that we constructed in the previous post, we will incorporate the ability to view and remove specified mince pies from the challenge."><meta name=twitter:site content="@edd_mann"><link rel=stylesheet href=/css/style.min.c3ee6cab58dd3fee7e6960b0391e996ba9254804702bc60a52ec5e0e3591a018.css integrity="sha256-w+5sq1jdP+5+aWCwOR6Za6klSARwK8YKUuxeDjWRoBg="><link rel=preload as=image href=/assets/x.svg><link rel=preload as=image href=/assets/github.svg><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://eddmann.com/posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/><script>(function(){document.documentElement.setAttribute("data-theme",localStorage.getItem("theme")||window.matchMedia("(prefers-color-scheme: dark)").matches&&"dark"||"light")})()</script><script src=/script.min.250e7cf850e958b4272ae208ba50192c2c96e26ebb656d272683894c80f86f20.js integrity="sha256-JQ58+FDpWLQnKuIIulAZLCyW4m67ZW0nJoOJTID4byA=" defer></script></head><body><header class="site-header l-wrapper"><a href=https://eddmann.com/><h3 class=site-header__title>Edd Mann
<span style=--url:url(/assets/code.svg)>Developer</span></h3></a><button class=site-header__mobile-navigation-button type=button title="Toggle mobile site navigation" aria-label="Toggle mobile site navigation" aria-expanded=false aria-controls=site-navigation></button><div class=site-header__navigation id=site-navigation><nav aria-label="Primary navigation"><ul class=site-header__primary-navigation><li><a href=/archive>Archive</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li></ul></nav><nav aria-label="Social links"><ul class=site-header__social-navigation><li><a class=social-icon style=--url:url(/assets/x.svg) href=https://x.com/edd_mann rel="external noopener" target=_blank>Twitter (X)</a></li><li><a class=social-icon style=--url:url(/assets/github.svg) href=https://github.com/eddmann rel="external noopener" target=_blank>GitHub</a></li></ul></nav></div></header><main class=l-wrapper><article><header class=l-page-title><h1 class=u-transition-between-pages style=--id:mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb>Mince Pie Challenge: Viewing and Removing Mince Pies with Amazon DynamoDB</h1><time datetime=2018-10-16T00:00:00Z class=published-at>Oct 16, 2018</time></header><main class=u-prose><p>In this post we will progress in implementing the proposed endpoint behaviour documented in our <a href=/posts/mince-pie-challenge-designing-the-restful-api-with-raml/#viewing-the-pies>RAML design</a>.
Using the online/offline DynamoDB abstractions that we constructed in the <a href=/posts/mince-pie-challenge-adding-and-listing-mince-pies-with-amazon-dynamodb/>previous post</a>, we will incorporate the ability to view and remove specified mince pies from the challenge.</p><p>If you are keen to see how the finished example looks, you can access it within the <a href=https://github.com/eddmann/mince-pie-challenge-api-serverless/tree/07-view-remove-pies rel="external noopener" target=_blank>API repository</a>.</p><h2 id=viewing-a-pie>Viewing a Pie</h2><p>We will begin by adding the ability to view a specified mince pie&rsquo;s full details, along with any associated actions available based on the client&rsquo;s request.
To start we will add the following new handler definition to <code>functions.yml</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>view-pie</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>handler</span>: <span style=color:#ae81ff>src/view.handler</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>events</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/pies/{id}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>method</span>: <span style=color:#ae81ff>get</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>cors</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><p>From here, we will create the concrete handler (<code>src/view.js</code>) which will be called upon each request.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// @flow
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>view</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;./handlers/view&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>getPie</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;db&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>createUserTokenAuthenticator</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;userTokenAuthenticator&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>TABLE_NAME</span>, <span style=color:#a6e22e>USER_POOL_ID</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>TABLE_NAME</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>&#39;TABLE_NAME is not present&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>USER_POOL_ID</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>&#39;USER_POOL_ID is not present&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handler</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>view</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>getUserIdFromToken</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createUserTokenAuthenticator</span>(<span style=color:#a6e22e>USER_POOL_ID</span>),
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>getPie</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>getPie</span>(<span style=color:#a6e22e>TABLE_NAME</span>),
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>This concrete handler passes the <code>getPie</code> service to the internal handler so as to correctly fetch the desired mince pie.
We will add this ability to both the <code>src/services/dynamoDBPieStore.js</code> and <code>src/services/localDynamoDBPieStore.js</code> implementations.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>type</span> { <span style=color:#a6e22e>Pie</span>, <span style=color:#a6e22e>UUID</span>, <span style=color:#a6e22e>UserId</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../types&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>getPie</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>tableName</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) =&gt;
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>UUID</span>)<span style=color:#f92672>:</span> Promise<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Pie</span><span style=color:#f92672>&gt;</span> =&gt;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>AWS</span>.<span style=color:#a6e22e>DynamoDB</span>.<span style=color:#a6e22e>DocumentClient</span>()
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>get</span>({ <span style=color:#a6e22e>TableName</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>tableName</span>, <span style=color:#a6e22e>Key</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>Id</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>id</span> } })
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>promise</span>()
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>then</span>(<span style=color:#a6e22e>r</span> =&gt; <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>Item</span>);
</span></span></code></pre></div><p>You will notice that we use the <code>UUID</code> type which was previously internal to the <code>src/types/index.js</code> definition.
This will need to be exposed for external consumption like so, <code>export type UUID = string;</code>.</p><p>The next step is to implement the internal handler (<code>src/handlers/view.js</code>) which will be called to fetch the pie and generate the API response.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// @flow
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>type</span> { <span style=color:#a6e22e>UserId</span>, <span style=color:#a6e22e>Pie</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../types&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>notFound</span>, <span style=color:#a6e22e>ok</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../helpers/http&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>createHandler</span>, <span style=color:#a6e22e>withOptionalHttpAuthentication</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../helpers/handlers&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Resource</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;hal&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>hasNotRated</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>userId</span><span style=color:#f92672>:</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>UserId</span>, <span style=color:#a6e22e>pie</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Pie</span>) =&gt; <span style=color:#a6e22e>userId</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>Ratings</span>[<span style=color:#a6e22e>userId</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isOwner</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>userId</span><span style=color:#f92672>:</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>UserId</span>, <span style=color:#a6e22e>pie</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Pie</span>) =&gt; <span style=color:#a6e22e>userId</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>userId</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>UserId</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isAbleToUploadPhoto</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>userId</span><span style=color:#f92672>:</span> <span style=color:#f92672>?</span><span style=color:#a6e22e>UserId</span>, <span style=color:#a6e22e>pie</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Pie</span>) =&gt; <span style=color:#a6e22e>isOwner</span>(<span style=color:#a6e22e>userId</span>, <span style=color:#a6e22e>pie</span>) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>PhotoUrl</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>view</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> ({ <span style=color:#a6e22e>event</span>, <span style=color:#a6e22e>userId</span>, <span style=color:#a6e22e>services</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>getPie</span> } }) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>id</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>pathParameters</span> <span style=color:#f92672>||</span> {};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pie</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>getPie</span>(<span style=color:#a6e22e>id</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>pie</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>notFound</span>(<span style=color:#e6db74>&#39;Unable to find the specified mince pie.&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>resource</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Resource</span>(
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>Id</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>Name</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>rating</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>avg</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>AvgRating</span>, <span style=color:#a6e22e>total</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>TotalRatings</span> },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>photo</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>PhotoUrl</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>thumbnail</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>ThumbnailUrl</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>addedAt</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>new</span> Date(<span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>AddedAt</span>).<span style=color:#a6e22e>toISOString</span>(),
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>`/pies/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>Id</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>hasNotRated</span>(<span style=color:#a6e22e>userId</span>, <span style=color:#a6e22e>pie</span>)) <span style=color:#a6e22e>resource</span>.<span style=color:#a6e22e>link</span>(<span style=color:#e6db74>&#39;rate&#39;</span>, <span style=color:#e6db74>`/pies/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>Id</span><span style=color:#e6db74>}</span><span style=color:#e6db74>/rate`</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isOwner</span>(<span style=color:#a6e22e>userId</span>, <span style=color:#a6e22e>pie</span>)) <span style=color:#a6e22e>resource</span>.<span style=color:#a6e22e>link</span>(<span style=color:#e6db74>&#39;remove&#39;</span>, <span style=color:#e6db74>`/pies/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>Id</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isAbleToUploadPhoto</span>(<span style=color:#a6e22e>userId</span>, <span style=color:#a6e22e>pie</span>)) <span style=color:#a6e22e>resource</span>.<span style=color:#a6e22e>link</span>(<span style=color:#e6db74>&#39;photo&#39;</span>, <span style=color:#e6db74>`/pies/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>Id</span><span style=color:#e6db74>}</span><span style=color:#e6db74>/photo`</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ok</span>(<span style=color:#a6e22e>resource</span>);
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>createHandler</span>(<span style=color:#a6e22e>withOptionalHttpAuthentication</span>(<span style=color:#a6e22e>view</span>));
</span></span></code></pre></div><p>This endpoint will return different actions based on the context in which the client makes the request.
For example, if the client is deemed to be the owner of this resource we will provide the action to remove the pie, and attach a photo (if one is not already present).
If the authenticated client has not yet rated this pie, we will return the action to fulfil this request as well.
Finally, if the request comes from an unauthenticated client we will omit any user specific actions, and simply return the pie details.</p><p>Now we are able to specify a particular pie within the request, we have to cater for the event that the supplied identifier may not correspond to a pie within the challenge.
For this, we need to add an additional response to the helpers within <code>src/helpers/http.js</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>notFound</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>detail</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Response</span> =&gt; ({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>statusCode</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>404</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Access-Control-Allow-Origin&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;*&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Access-Control-Allow-Credentials&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;*&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Content-Type&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;application/problem+json&#39;</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>body</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>({ <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Not Found&#39;</span>, <span style=color:#a6e22e>detail</span> }),
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>Now that we have built up the functionality, it is time to exercise that the behaviour works as intended.
To do this we will produce test cases (<code>src/__tests__/view.js</code>) for each type of behaviour that we expect to observe from the resource.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>handler</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../handlers/view&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>createPie</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>custom</span> =&gt; ({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Id</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;1&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>UserId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;USER_ID&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Sample Mince Pie&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>AvgRating</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>TotalRatings</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Ratings</span><span style=color:#f92672>:</span> {},
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>PhotoUrl</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;http://photo.url&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ThumbnailUrl</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;http://thumbnail.url&#39;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>AddedAt</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1528217691</span>,
</span></span><span style=display:flex><span>  ...<span style=color:#a6e22e>custom</span>,
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>it</span>(<span style=color:#e6db74>&#39;displays a users pie&#39;</span>, <span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pie</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createPie</span>({ <span style=color:#a6e22e>UserId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;ANOTHER_USER_ID&#39;</span> });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>services</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getUserIdFromToken</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>(),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getPie</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>pie</span>),
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parseResponse</span>(<span style=color:#66d9ef>await</span> <span style=color:#a6e22e>handler</span>(<span style=color:#a6e22e>services</span>)({ <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> {} }, {}));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>statusCode</span>).<span style=color:#a6e22e>toBe</span>(<span style=color:#ae81ff>200</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>name</span>).<span style=color:#a6e22e>toBe</span>(<span style=color:#e6db74>&#39;Sample Mince Pie&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>_links</span>).<span style=color:#a6e22e>not</span>.<span style=color:#a6e22e>toHaveProperty</span>(<span style=color:#e6db74>&#39;remove&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>_links</span>).<span style=color:#a6e22e>not</span>.<span style=color:#a6e22e>toHaveProperty</span>(<span style=color:#e6db74>&#39;rate&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>_links</span>).<span style=color:#a6e22e>not</span>.<span style=color:#a6e22e>toHaveProperty</span>(<span style=color:#e6db74>&#39;photo&#39;</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>it</span>(<span style=color:#e6db74>&#39;displays the photo action when no photo is present for your pie&#39;</span>, <span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pie</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createPie</span>({ <span style=color:#a6e22e>PhotoUrl</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>undefined</span>, <span style=color:#a6e22e>ThumbnailUrl</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>undefined</span> });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>services</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getUserIdFromToken</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>(<span style=color:#e6db74>&#39;USER_ID&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getPie</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>pie</span>),
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parseResponse</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>handler</span>(<span style=color:#a6e22e>services</span>)({ <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>Authorization</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;TOKEN&#39;</span> } }, {})
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>statusCode</span>).<span style=color:#a6e22e>toBe</span>(<span style=color:#ae81ff>200</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>_links</span>).<span style=color:#a6e22e>toHaveProperty</span>(<span style=color:#e6db74>&#39;photo&#39;</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>it</span>(<span style=color:#e6db74>&#39;displays the remove action when viewing your own pie&#39;</span>, <span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pie</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createPie</span>({});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>services</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getUserIdFromToken</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>(<span style=color:#e6db74>&#39;USER_ID&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getPie</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>pie</span>),
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parseResponse</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>handler</span>(<span style=color:#a6e22e>services</span>)({ <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>Authorization</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;TOKEN&#39;</span> } }, {})
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>statusCode</span>).<span style=color:#a6e22e>toBe</span>(<span style=color:#ae81ff>200</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>_links</span>).<span style=color:#a6e22e>toHaveProperty</span>(<span style=color:#e6db74>&#39;remove&#39;</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>it</span>(<span style=color:#e6db74>&#39;displays the rate action when we have not yet rated the pie&#39;</span>, <span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pie</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createPie</span>({});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>services</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getUserIdFromToken</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>(<span style=color:#e6db74>&#39;USER_ID&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getPie</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>pie</span>),
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parseResponse</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>handler</span>(<span style=color:#a6e22e>services</span>)({ <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>Authorization</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;TOKEN&#39;</span> } }, {})
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>statusCode</span>).<span style=color:#a6e22e>toBe</span>(<span style=color:#ae81ff>200</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>_links</span>).<span style=color:#a6e22e>toHaveProperty</span>(<span style=color:#e6db74>&#39;rate&#39;</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>it</span>(<span style=color:#e6db74>&#39;does not display the rate action when we have rated the pie&#39;</span>, <span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pie</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createPie</span>({ <span style=color:#a6e22e>Ratings</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>USER_ID</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>3</span> }, <span style=color:#a6e22e>AvgRating</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>3</span>, <span style=color:#a6e22e>TotalRatings</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span> });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>services</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getUserIdFromToken</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>(<span style=color:#e6db74>&#39;USER_ID&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getPie</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>(<span style=color:#a6e22e>pie</span>),
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parseResponse</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>handler</span>(<span style=color:#a6e22e>services</span>)({ <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>Authorization</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;TOKEN&#39;</span> } }, {})
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>statusCode</span>).<span style=color:#a6e22e>toBe</span>(<span style=color:#ae81ff>200</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>_links</span>).<span style=color:#a6e22e>not</span>.<span style=color:#a6e22e>toHaveProperty</span>(<span style=color:#e6db74>&#39;rate&#39;</span>);
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>These test cases highlight how the actions returned back to the client can be different based on the given context.
We have decided to extract out creating a pie <a href=https://blog.pragmatists.com/test-doubles-fakes-mocks-and-stubs-1a7491dfa3da#5334 rel="external noopener" target=_blank>stub</a> into a smaller helper function.
This function provides us with the ability to supply custom attributes that we wish to override the default properties with, per use-case.</p><p>With the ability to access a specified pie now available, we will follow this with work on one of the supplied owner actions - removing a pie from the challenge.</p><h2 id=removing-a-pie>Removing a Pie</h2><p>In a similar manner to how we constructed the viewing capabilities, we will start off by defining a new handler within <code>functions.yml</code> which is called upon a <code>DELETE</code> request.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>remove-pie</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>handler</span>: <span style=color:#ae81ff>src/remove.handler</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>events</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/pies/{id}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>method</span>: <span style=color:#ae81ff>delete</span>
</span></span></code></pre></div><p>We will now implement the concrete handler within <code>src/remove.js</code>, which will be called by each client request.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// @flow
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>remove</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;./handlers/remove&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>getPie</span>, <span style=color:#a6e22e>removePie</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;db&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>createUserTokenAuthenticator</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;userTokenAuthenticator&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>TABLE_NAME</span>, <span style=color:#a6e22e>USER_POOL_ID</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>TABLE_NAME</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>&#39;TABLE_NAME is not present&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>USER_POOL_ID</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>&#39;USER_POOL_ID is not present&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handler</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>remove</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>getUserIdFromToken</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createUserTokenAuthenticator</span>(<span style=color:#a6e22e>USER_POOL_ID</span>),
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>getPie</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>getPie</span>(<span style=color:#a6e22e>TABLE_NAME</span>),
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>removePie</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>removePie</span>(<span style=color:#a6e22e>TABLE_NAME</span>),
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>The internal handler that is used within this request uses the previously created <code>getPie</code> service, along with a new <code>removePie</code> service.
We will add this capability to both the <code>src/services/dynamoDBPieStore.js</code> and <code>src/services/localDynamoDBPieStore.js</code> implementations.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>removePie</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>tableName</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) =&gt;
</span></span><span style=display:flex><span>  (<span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>UUID</span>)<span style=color:#f92672>:</span> Promise<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>void</span><span style=color:#f92672>&gt;</span> =&gt;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>AWS</span>.<span style=color:#a6e22e>DynamoDB</span>.<span style=color:#a6e22e>DocumentClient</span>().<span style=color:#66d9ef>delete</span>({ <span style=color:#a6e22e>TableName</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>tableName</span>, <span style=color:#a6e22e>Key</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>Id</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>id</span> } }).<span style=color:#a6e22e>promise</span>();
</span></span></code></pre></div><p>With this now in place we can create the internal handler (<code>src/handlers/remove.js</code>) that will be called to remove the specified pie resource.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// @flow
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>type</span> { <span style=color:#a6e22e>UserId</span>, <span style=color:#a6e22e>Pie</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../types&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>notFound</span>, <span style=color:#a6e22e>forbidden</span>, <span style=color:#a6e22e>noContent</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../helpers/http&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>createHandler</span>, <span style=color:#a6e22e>withStrictHttpAuthentication</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../helpers/handlers&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Resource</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;hal&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isOwner</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>userId</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>UserId</span>, <span style=color:#a6e22e>pie</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Pie</span>) =&gt; <span style=color:#a6e22e>userId</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>UserId</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>remove</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> ({ <span style=color:#a6e22e>event</span>, <span style=color:#a6e22e>userId</span>, <span style=color:#a6e22e>services</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>getPie</span>, <span style=color:#a6e22e>removePie</span> } }) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>id</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>pathParameters</span> <span style=color:#f92672>||</span> {};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pie</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>getPie</span>(<span style=color:#a6e22e>id</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>pie</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>notFound</span>(<span style=color:#e6db74>&#39;Unable to find the specified mince pie.&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>isOwner</span>(<span style=color:#a6e22e>userId</span>, <span style=color:#a6e22e>pie</span>)) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>forbidden</span>(<span style=color:#e6db74>&#39;This mince pie does not belong to you.&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>removePie</span>(<span style=color:#a6e22e>pie</span>.<span style=color:#a6e22e>Id</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>noContent</span>();
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>createHandler</span>(<span style=color:#a6e22e>withStrictHttpAuthentication</span>(<span style=color:#a6e22e>remove</span>));
</span></span></code></pre></div><p>We first ensure that the desired pie exists and is owned by the requesting client.
If this is the case, we will remove the pie and return a successful <code>204 No Content</code> response.
However, if the requesting client is not deemed to be the owner of the pie we will reject this action and return a <code>403 Forbidden</code> response.
Both of these responses will now need to be added to <code>src/helpers/http.js</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>noContent</span> <span style=color:#f92672>=</span> ()<span style=color:#f92672>:</span> <span style=color:#a6e22e>Response</span> =&gt; ({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>statusCode</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>204</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> { <span style=color:#e6db74>&#39;Access-Control-Allow-Origin&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;*&#39;</span>, <span style=color:#e6db74>&#39;Access-Control-Allow-Credentials&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;*&#39;</span> },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>body</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>forbidden</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>detail</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Response</span> =&gt; ({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>statusCode</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>403</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Access-Control-Allow-Origin&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;*&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Access-Control-Allow-Credentials&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;*&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Content-Type&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;application/problem+json&#39;</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>body</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>({ <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Forbidden&#39;</span>, <span style=color:#a6e22e>detail</span> }),
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>Finally, we will test that the implemented behaviour works as desired within <code>src/__tests__/remove.js</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>handler</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../handlers/remove&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>it</span>(<span style=color:#e6db74>&#39;requires an authenticated user&#39;</span>, <span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>services</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>getUserIdFromToken</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>() };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parseResponse</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>handler</span>(<span style=color:#a6e22e>services</span>)({ <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> {}, <span style=color:#a6e22e>pathParameters</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;1&#39;</span> } }, {})
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>statusCode</span>).<span style=color:#a6e22e>toBe</span>(<span style=color:#ae81ff>401</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>it</span>(<span style=color:#e6db74>&#39;requires a pie to be present&#39;</span>, <span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>services</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getUserIdFromToken</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>(<span style=color:#e6db74>&#39;USER_ID&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getPie</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>(),
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parseResponse</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>handler</span>(<span style=color:#a6e22e>services</span>)(
</span></span><span style=display:flex><span>      { <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>Authorization</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;TOKEN&#39;</span> }, <span style=color:#a6e22e>pathParameters</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;1&#39;</span> } },
</span></span><span style=display:flex><span>      {}
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>statusCode</span>).<span style=color:#a6e22e>toBe</span>(<span style=color:#ae81ff>404</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>it</span>(<span style=color:#e6db74>&#39;requires the user to own the pie&#39;</span>, <span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>services</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getUserIdFromToken</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>(<span style=color:#e6db74>&#39;USER_ID&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getPie</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>({ <span style=color:#a6e22e>Id</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;1&#39;</span>, <span style=color:#a6e22e>UserId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;ANOTHER_USER_ID&#39;</span> }),
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parseResponse</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>handler</span>(<span style=color:#a6e22e>services</span>)(
</span></span><span style=display:flex><span>      { <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>Authorization</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;TOKEN&#39;</span> }, <span style=color:#a6e22e>pathParameters</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;1&#39;</span> } },
</span></span><span style=display:flex><span>      {}
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>statusCode</span>).<span style=color:#a6e22e>toBe</span>(<span style=color:#ae81ff>403</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>it</span>(<span style=color:#e6db74>&#39;removes the users pie&#39;</span>, <span style=color:#66d9ef>async</span> () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>services</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getUserIdFromToken</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>(<span style=color:#e6db74>&#39;USER_ID&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>getPie</span><span style=color:#f92672>:</span> () =&gt; Promise.<span style=color:#a6e22e>resolve</span>({ <span style=color:#a6e22e>Id</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;1&#39;</span>, <span style=color:#a6e22e>UserId</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;USER_ID&#39;</span> }),
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>removePie</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>jest</span>.<span style=color:#a6e22e>fn</span>(),
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parseResponse</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>handler</span>(<span style=color:#a6e22e>services</span>)(
</span></span><span style=display:flex><span>      { <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>Authorization</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;TOKEN&#39;</span> }, <span style=color:#a6e22e>pathParameters</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;1&#39;</span> } },
</span></span><span style=display:flex><span>      {}
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>statusCode</span>).<span style=color:#a6e22e>toBe</span>(<span style=color:#ae81ff>204</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>services</span>.<span style=color:#a6e22e>removePie</span>).<span style=color:#a6e22e>toHaveBeenCalledWith</span>(<span style=color:#e6db74>&#39;1&#39;</span>);
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><p>With this behaviour now exercised by automated tests we are equipped to test performing these actions within both an offline and online development environment.
We will run <code>make offline</code> and test viewing a newly created mince pie as the resource owner, using <a href=https://www.getpostman.com/ rel="external noopener" target=_blank>Postman</a>.</p><p><picture><source type=image/webp srcset="/posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/postman-view-pie_hu_33f9d61fb5417c6b.webp 350w, /posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/postman-view-pie_hu_7ec6d3d4580b9e0.webp 700w, /posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/postman-view-pie_hu_572b13618755dffd.webp 1400w"><source type=image/jpeg srcset="/posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/postman-view-pie_hu_5ea4838706e17df4.jpg 350w, /posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/postman-view-pie_hu_7d80070a1a020963.jpg 700w, /posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/postman-view-pie_hu_6dca9ba2d2b827bc.jpg 1400w"><img src=/posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/postman-view-pie_hu_7d80070a1a020963.jpg alt="Viewing Pie in Postman" loading=lazy></picture></p><p>You will see that as the pie owner we have the ability to remove it from the challenge.
We will now call this action and ensure that the pie has been successfully removed.</p><p><picture><source type=image/webp srcset="/posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/postman-remove-pie_hu_26d2df6e4489cff1.webp 350w, /posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/postman-remove-pie_hu_73f10572d8410a0c.webp 700w, /posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/postman-remove-pie_hu_a2468b4a404ba3df.webp 1400w"><source type=image/jpeg srcset="/posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/postman-remove-pie_hu_de70d2e73edc3a5.jpg 350w, /posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/postman-remove-pie_hu_7cbb961c67e0d07f.jpg 700w, /posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/postman-remove-pie_hu_bfc3ec89a51d266.jpg 1400w"><img src=/posts/mince-pie-challenge-viewing-and-removing-mince-pies-with-amazon-dynamodb/postman-remove-pie_hu_7cbb961c67e0d07f.jpg alt="Removing Pie in Postman" loading=lazy></picture></p><p>Finally, we can <code>make deploy</code> and perform the same assertions in the online development environment.</p><p>In this post we have made good progress in building up the underlying functionality that comprises to be the API.
In the next post of the <a href=/archive/tag/mince-pie-challenge-series>series</a>, we shall delve into adding a key part of the challenge itself, the ability to rate a specified mince pie .</p></main><footer class=post-footer><ul class="tags tags--large"><li><a href=/archive/tag/serverless>serverless</a></li><li><a href=/archive/tag/aws>aws</a></li><li><a href=/archive/tag/lambda>lambda</a></li><li><a href=/archive/tag/dynamodb>dynamodb</a></li><li><a href=/archive/tag/javascript>javascript</a></li><li><a href=/archive/tag/mince-pie-challenge-series>mince-pie-challenge-series</a></li></ul><div class=related><h3 class=related__title>Related Posts</h3><ul class=related__posts><li><a href=/posts/mince-pie-challenge-adding-and-listing-mince-pies-with-amazon-dynamodb/>Mince Pie Challenge: Adding and Listing Mince Pies with Amazon DynamoDB</a></li><li><a href=/posts/mince-pie-challenge-building-a-serverless-restful-api-and-react-client/>Mince Pie Challenge: Building a Serverless RESTful API and React Client</a></li><li><a href=/posts/creating-a-winning-audio-lambda-service-using-serverless-polly-and-compiled-sox/>Creating a 'Winning' Audio Lambda Service using Serverless, Polly and compiled SOX</a></li><li><a href=/posts/memes-as-a-service-using-lambda-serverless-and-imagemagick/>'Memes as a Service' using Lambda, Serverless and ImageMagick</a></li><li><a href=/posts/mince-pie-challenge-setting-up-the-serverless-framework-with-docker-webpack-and-babel/>Mince Pie Challenge: Setting up the Serverless Framework with Docker, Webpack and Babel</a></li></ul></div></footer></article><div class=scroll-watcher></div></main><footer class="site-footer l-wrapper"><div>&copy; 2025, Edd Mann</div><button class=site-footer__theme-toggle type=button title="Toggle theme" aria-label="Toggle theme"><svg fill="currentcolor" viewBox="0 0 32 32" role="img"><title>Theme toggle icon</title><desc>A circle representing the moon for toggling theme</desc><path d="M16 .5C7.4.5.5 7.4.5 16S7.4 31.5 16 31.5 31.5 24.6 31.5 16 24.6.5 16 .5zm0 28.1V3.4C23 3.4 28.6 9 28.6 16S23 28.6 16 28.6z"/></svg></button></footer></body></html>