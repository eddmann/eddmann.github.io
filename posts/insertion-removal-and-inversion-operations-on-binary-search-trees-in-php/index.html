<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Insertion, Removal and Inversion Operations on Binary (Search) Trees in PHP - Edd Mann</title>
<meta name=description content="Learn how to implement insertion, removal and inversion operations on binary search trees in PHP using both mutable and immutable approaches."><meta name=author content="Edd Mann"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQ7WHNXH4"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZPQ7WHNXH4")}</script><meta itemprop=name content="Insertion, Removal and Inversion Operations on Binary (Search) Trees in PHP"><meta itemprop=description content="Recently Max Howell (creator of Homebrew) posted an interesting tweet in regard to Google’s interview process. In this tweet he mentioned how one of the proposed questions was to white-board a solution to invert a binary tree. Over the past couple of years I have been interested in exploring fundamental computer science data structures and algorithms. As a result, I thought it would be interesting to explore this structure and its associated operations in more depth - using immutable and mutable PHP implementations to clearly highlight the benefits garnered from each approach."><meta itemprop=datePublished content="2015-07-22T00:00:00+00:00"><meta itemprop=dateModified content="2015-07-22T00:00:00+00:00"><meta itemprop=wordCount content="1199"><meta itemprop=keywords content="Php,Algorithms,Data-Structures"><meta property="og:url" content="https://eddmann.com/posts/insertion-removal-and-inversion-operations-on-binary-search-trees-in-php/"><meta property="og:site_name" content="Edd Mann"><meta property="og:title" content="Insertion, Removal and Inversion Operations on Binary (Search) Trees in PHP"><meta property="og:description" content="Recently Max Howell (creator of Homebrew) posted an interesting tweet in regard to Google’s interview process. In this tweet he mentioned how one of the proposed questions was to white-board a solution to invert a binary tree. Over the past couple of years I have been interested in exploring fundamental computer science data structures and algorithms. As a result, I thought it would be interesting to explore this structure and its associated operations in more depth - using immutable and mutable PHP implementations to clearly highlight the benefits garnered from each approach."><meta property="og:locale" content="en_GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2015-07-22T00:00:00+00:00"><meta property="article:modified_time" content="2015-07-22T00:00:00+00:00"><meta property="article:tag" content="Php"><meta property="article:tag" content="Algorithms"><meta property="article:tag" content="Data-Structures"><meta name=twitter:card content="summary"><meta name=twitter:title content="Insertion, Removal and Inversion Operations on Binary (Search) Trees in PHP"><meta name=twitter:description content="Recently Max Howell (creator of Homebrew) posted an interesting tweet in regard to Google’s interview process. In this tweet he mentioned how one of the proposed questions was to white-board a solution to invert a binary tree. Over the past couple of years I have been interested in exploring fundamental computer science data structures and algorithms. As a result, I thought it would be interesting to explore this structure and its associated operations in more depth - using immutable and mutable PHP implementations to clearly highlight the benefits garnered from each approach."><meta name=twitter:site content="@edd_mann"><link rel="preload stylesheet" as=style href=/css/style.min.a5107d712048e2bf498ca68b768b337bccdd6ce7b257419de1c0762b86ab1143.css integrity="sha256-pRB9cSBI4r9JjKaLdosze8zdbOeyV0Gd4cB2K4arEUM="><link rel=preload as=image href=/assets/x.svg><link rel=preload as=image href=/assets/github.svg><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://eddmann.com/posts/insertion-removal-and-inversion-operations-on-binary-search-trees-in-php/></head><body><header class="site-header wrapper"><a href=https://eddmann.com/><h3 class=site-header__title>Edd Mann
<span style=--url:url(/assets/code.svg)>Developer</span></h3></a><div class=site-header__mobile-navigation-button aria-label="Toggle mobile site navigation" aria-expanded=false aria-controls=site-navigation></div><div class=site-header__navigation id=site-navigation><nav aria-label="Primary navigation"><ul class=site-header__primary-navigation><li><a href=/archive>Archive</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li></ul></nav><nav aria-label="Social links"><ul class=site-header__social-navigation><li><a class=social-icon style=--url:url(/assets/x.svg) href=https://x.com/edd_mann rel="external noopener" target=_blank>Twitter (X)</a></li><li><a class=social-icon style=--url:url(/assets/github.svg) href=https://github.com/eddmann rel="external noopener" target=_blank>GitHub</a></li></ul></nav></div></header><main class=wrapper><article><header class=page-title><h1>Insertion, Removal and Inversion Operations on Binary (Search) Trees in PHP</h1><time class=post__time>Jul 22, 2015</time></header><main class=prose><p>Recently Max Howell (creator of <a href=http://brew.sh/ rel="external noopener" target=_blank>Homebrew</a>) posted an interesting <a href=https://twitter.com/mxcl/status/608682016205344768 rel="external noopener" target=_blank>tweet</a> in regard to Google&rsquo;s interview process.
In this tweet he mentioned how one of the proposed questions was to white-board a solution to invert a binary tree.
Over the past couple of years I have been interested in exploring fundamental computer science data structures and algorithms.
As a result, I thought it would be interesting to explore this structure and its associated operations in more depth - using immutable and mutable PHP implementations to clearly highlight the benefits garnered from each approach.</p><p>Binary trees are a form of tree data structure, comprised of nodes with assigned values and at most two child nodes (left and right).
To expand on this problem I will be documenting the creation of a <a href=https://en.wikipedia.org/wiki/Binary_search_tree rel="external noopener" target=_blank>binary search tree</a>, which has the additional invariant that any left child is less than, and any right child is greater than, the current node&rsquo;s value.
This allows us to perform unambiguous node deletion from the structure.</p><h2 id=node-representation>Node Representation</h2><p>Throughout all these examples I have leaned towards a simple function, as opposed to a class-based approach, relying on namespaces to infer relation.
The following function can be used to create a simple object representation of a tree node.
Providing a value and optional left and right nodes, it simply returns the aggregate.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Node</span>($value, $left <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>, $right <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> (<span style=color:#a6e22e>object</span>) <span style=color:#a6e22e>compact</span>(<span style=color:#e6db74>&#39;value&#39;</span>, <span style=color:#e6db74>&#39;left&#39;</span>, <span style=color:#e6db74>&#39;right&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=insertion>Insertion</h2><p>Now that we are able to represent tree nodes, the next logical step is to provide insertion capabilities.
Accessible from the root tree node (initially NULL), we are able to recursively traverse the structure until we either find a leaf or the node is already present.
To decide which child to traverse down we use the discussed comparator invariant.
Below is a small diagram depicting the insertion of a value within an existing tree.</p><p><picture><source type=image/webp srcset=", /posts/insertion-removal-and-inversion-operations-on-binary-search-trees-in-php/insertion_hu_91d9825901da0c7c.webp 220w"><source type=image/jpeg srcset=", /posts/insertion-removal-and-inversion-operations-on-binary-search-trees-in-php/insertion_hu_b245b7e6c64887ad.jpg 220w"><img src=/posts/insertion-removal-and-inversion-operations-on-binary-search-trees-in-php/insertion_hu_b245b7e6c64887ad.jpg alt="Binary Search Tree Insertion" loading=lazy></picture></p><h3 id=mutable>Mutable</h3><p>The first implementation provides a mutable means of insertion.
Notice the explicit reassignment of the right and left child node references.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>insert</span>($value, $root)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($root <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>Node</span>($value);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($value <span style=color:#f92672>===</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $root;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($value <span style=color:#f92672>&gt;</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>        $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>insert</span>($value, $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>insert</span>($value, $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> $root;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=immutable>Immutable</h3><p>Below is an immutable implementation of the insertion process starting from a rooted tree node.
As opposed to modifying pre-existing state, we instead build up a modified representation, creating new nodes when required.
This allows us to use both the new and old tree representations simultaneously.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>insert</span>($value, $root)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($root <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>Node</span>($value);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($value <span style=color:#f92672>===</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $root;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($value <span style=color:#f92672>&gt;</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>Node</span>($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>, $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span>, <span style=color:#a6e22e>insert</span>($value, $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>Node</span>($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>, <span style=color:#a6e22e>insert</span>($value, $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span>), $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=removal>Removal</h2><p>With the ability to now insert nodes into the tree, we can expand on this by performing the inverse operation, that being removal.
When removing a node from the tree, there are three different use cases that need to be addressed.
The first two are relatively simple cases, met when the node in question has zero or one child.
When no children are present we are able to just remove the reference to the node.
However, in the case of a single child node we can replace the node&rsquo;s parent reference with its child node.
The third case is a little more tricky, requiring us to rearrange the structure to find a new node to replace this one, maintaining the desired invariant.</p><p>There are two common techniques to achieve this, either finding the in-order successor or in-order predecessor and replacing the current node with this result.
In these examples I have opted for the in-order successor, which requires us to find the minimal value of the current node&rsquo;s right tree.
This operation can be succinctly codified recursively as shown below.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>minValue</span>($root)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>minValue</span>($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Below is a small diagram depicting the removal of a node which meets the third use case.</p><p><picture><source type=image/webp srcset=", /posts/insertion-removal-and-inversion-operations-on-binary-search-trees-in-php/removal_hu_b507d4ed9cb3cb98.webp 338w"><source type=image/jpeg srcset=", /posts/insertion-removal-and-inversion-operations-on-binary-search-trees-in-php/removal_hu_f905008ab3371b53.jpg 338w"><img src=/posts/insertion-removal-and-inversion-operations-on-binary-search-trees-in-php/removal_hu_f905008ab3371b53.jpg alt="Binary Search Tree Removal" loading=lazy></picture></p><h3 id=mutable-1>Mutable</h3><p>In a similar fashion to how mutable insertion can be carried out, we reassign both the node&rsquo;s right and left references when required.
We also replace the current node&rsquo;s value, if the operation falls into the described third use case.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>remove</span>($value, $root)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($root <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $root;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($value <span style=color:#f92672>&gt;</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>        $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>remove</span>($value, $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $root;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($value <span style=color:#f92672>&lt;</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>        $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>remove</span>($value, $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $root;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $value <span style=color:#f92672>=</span> <span style=color:#a6e22e>minValue</span>($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>remove</span>($value, $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> $value;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> $root;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=immutable-1>Immutable</h3><p>In the immutable instance we instead return new nodes in place of the reassignment that would have occurred in the mutable version.
This allows us to maintain and access the entire original tree structure whilst reusing unmodified references in the new tree.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>remove</span>($value, $root)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($root <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $root;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($value <span style=color:#f92672>&gt;</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>Node</span>($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>, $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span>, <span style=color:#a6e22e>remove</span>($value, $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($value <span style=color:#f92672>&lt;</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>Node</span>($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>, <span style=color:#a6e22e>remove</span>($value, $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span>), $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $value <span style=color:#f92672>=</span> <span style=color:#a6e22e>minValue</span>($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>Node</span>($value, $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span>, <span style=color:#a6e22e>remove</span>($value, $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>));
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=inversion>Inversion</h2><p>Now that we have the ability to insert and remove nodes from a binary tree, another operation which can be performed is inversion (as mentioned in the tweet).
I should note that this operation does not typically occur on binary search trees as it violates the additional invariant.</p><h3 id=mutable-2>Mutable</h3><p>From a mutable perspective we are able to invert the tree in a memory-efficient manner, with only references being altered.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>invert</span>($root)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($root <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $root;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $tmp <span style=color:#f92672>=</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span>;
</span></span><span style=display:flex><span>    $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>invert</span>($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>);
</span></span><span style=display:flex><span>    $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>invert</span>($tmp);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> $root;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=immutable-2>Immutable</h3><p>In the case of immutability, an entirely new tree is required to be built.
In order to maintain the ability to reuse the current tree we are not able to manipulate any of the existing node references.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>invert</span>($root)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($root <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> $root;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>Node</span>($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span>, <span style=color:#a6e22e>invert</span>($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>), <span style=color:#a6e22e>invert</span>($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span>));
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=example>Example</h2><p>Now that we have these operations in place we can use the following function to generate a tree from an array representation.
Notice the use of the mutable insert operation to save on memory costs.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>fromArray</span>(<span style=color:#66d9ef>array</span> $values)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    $tree <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>foreach</span> ($values <span style=color:#66d9ef>as</span> $value) {
</span></span><span style=display:flex><span>        $tree <span style=color:#f92672>=</span> <span style=color:#a6e22e>BinaryTree\Mutable\insert</span>($value, $tree);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> $tree;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We can then visualise the generated tree by using the following render function.
This function displays the tree from left to right, as opposed to the typical top-down approach.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>render</span>($root, $depth <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> ($root <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>str_repeat</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>&#34;</span>, $depth) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;~</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>render</span>($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>right</span>, $depth <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>str_repeat</span>(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\t</span><span style=color:#e6db74>&#34;</span>, $depth) <span style=color:#f92672>.</span> $root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>value</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>.</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>render</span>($root<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>left</span>, $depth <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Finally, we are able to use all these operations and helper functions in conjunction, for a contrived example.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$a <span style=color:#f92672>=</span> <span style=color:#a6e22e>BinaryTree\fromArray</span>([ <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span> ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$b <span style=color:#f92672>=</span> <span style=color:#a6e22e>BinaryTree\Immutable\remove</span>(<span style=color:#ae81ff>2</span>, $a);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>BinaryTree\render</span>($a);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>                        ~
</span></span></span><span style=display:flex><span><span style=color:#75715e>                4
</span></span></span><span style=display:flex><span><span style=color:#75715e>                        ~
</span></span></span><span style=display:flex><span><span style=color:#75715e>        3
</span></span></span><span style=display:flex><span><span style=color:#75715e>                ~
</span></span></span><span style=display:flex><span><span style=color:#75715e>2
</span></span></span><span style=display:flex><span><span style=color:#75715e>                ~
</span></span></span><span style=display:flex><span><span style=color:#75715e>        1
</span></span></span><span style=display:flex><span><span style=color:#75715e>                ~
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>BinaryTree\Mutable\invert</span>($b);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>BinaryTree\render</span>($b);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/*
</span></span></span><span style=display:flex><span><span style=color:#75715e>                ~
</span></span></span><span style=display:flex><span><span style=color:#75715e>        1
</span></span></span><span style=display:flex><span><span style=color:#75715e>                ~
</span></span></span><span style=display:flex><span><span style=color:#75715e>3
</span></span></span><span style=display:flex><span><span style=color:#75715e>                ~
</span></span></span><span style=display:flex><span><span style=color:#75715e>        4
</span></span></span><span style=display:flex><span><span style=color:#75715e>                ~
</span></span></span><span style=display:flex><span><span style=color:#75715e>*/</span>
</span></span></code></pre></div></main><footer class=post__tags><a href=/archive/tag/php>php</a><a href=/archive/tag/algorithms>algorithms</a><a href=/archive/tag/data-structures>data-structures</a></footer></article><div class=scroll-watcher></div></main><footer class="site-footer wrapper"><div>&copy; 2025, Edd Mann</div></footer><script>(function(){document.querySelector(".site-header__mobile-navigation-button").addEventListener("click",e=>{document.documentElement.classList.toggle("mobile-navigation-open"),e.target.setAttribute("aria-expanded",e.target.getAttribute("aria-expanded")==="false"?"true":"false")});const n=document.querySelector(".site-header");let t=window.pageYOffset,e=!1;window.addEventListener("scroll",()=>{if(e)return;setTimeout(()=>{const s=window.pageYOffset;n.classList.toggle("is-sticky",s>0&&t>s),t=s,e=!1},500),e=!0})})()</script></body></html>