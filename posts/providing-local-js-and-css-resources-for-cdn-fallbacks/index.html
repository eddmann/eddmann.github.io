<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Providing Local JS and CSS Resources for CDN Fallbacks - Edd Mann</title>
<meta name=description content="Learn how to provide reliable local JavaScript and CSS fallback options for CDN-hosted assets such as jQuery and Twitter Bootstrap."><meta name=author content="Edd Mann"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQ7WHNXH4"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZPQ7WHNXH4")}</script><meta itemprop=name content="Providing Local JS and CSS Resources for CDN Fallbacks"><meta itemprop=description content="In a recent podcast the topic of using Content Delivery Networks (CDN) to host commonly used resources such as jQuery and Twitter Bootstrap came up. The merits of having access to large-scale delivery infrastructure provided by Google etc. are significant. There is also the possibility that the client will already have these assets cached."><meta itemprop=datePublished content="2014-01-29T00:00:00+00:00"><meta itemprop=dateModified content="2014-01-29T00:00:00+00:00"><meta itemprop=wordCount content="692"><meta itemprop=keywords content="Cdn,Javascript,Css"><meta property="og:url" content="https://eddmann.com/posts/providing-local-js-and-css-resources-for-cdn-fallbacks/"><meta property="og:site_name" content="Edd Mann"><meta property="og:title" content="Providing Local JS and CSS Resources for CDN Fallbacks"><meta property="og:description" content="In a recent podcast the topic of using Content Delivery Networks (CDN) to host commonly used resources such as jQuery and Twitter Bootstrap came up. The merits of having access to large-scale delivery infrastructure provided by Google etc. are significant. There is also the possibility that the client will already have these assets cached."><meta property="og:locale" content="en_GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-01-29T00:00:00+00:00"><meta property="article:modified_time" content="2014-01-29T00:00:00+00:00"><meta property="article:tag" content="Cdn"><meta property="article:tag" content="Javascript"><meta property="article:tag" content="Css"><meta name=twitter:card content="summary"><meta name=twitter:title content="Providing Local JS and CSS Resources for CDN Fallbacks"><meta name=twitter:description content="In a recent podcast the topic of using Content Delivery Networks (CDN) to host commonly used resources such as jQuery and Twitter Bootstrap came up. The merits of having access to large-scale delivery infrastructure provided by Google etc. are significant. There is also the possibility that the client will already have these assets cached."><meta name=twitter:site content="@edd_mann"><link rel="preload stylesheet" as=style href=/css/style.min.29e5081eb89985e1a0a80efa54bbaeb1c3b876bd282e34b5167c32a23e0ffe38.css integrity="sha256-KeUIHriZheGgqA76VLuuscO4dr0oLjS1Fnwyoj4P/jg="><link rel=preload as=image href=/assets/x.svg><link rel=preload as=image href=/assets/github.svg><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://eddmann.com/posts/providing-local-js-and-css-resources-for-cdn-fallbacks/><script>(function(){document.documentElement.setAttribute("data-theme",localStorage.getItem("theme")||window.matchMedia("(prefers-color-scheme: dark)").matches&&"dark"||"light")})()</script></head><body><header class="site-header wrapper"><a href=https://eddmann.com/><h3 class=site-header__title>Edd Mann
<span style=--url:url(/assets/code.svg)>Developer</span></h3></a><div class=site-header__mobile-navigation-button aria-label="Toggle mobile site navigation" aria-expanded=false aria-controls=site-navigation></div><div class=site-header__navigation id=site-navigation><nav aria-label="Primary navigation"><ul class=site-header__primary-navigation><li><a href=/archive>Archive</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li></ul></nav><nav aria-label="Social links"><ul class=site-header__social-navigation><li><a class=social-icon style=--url:url(/assets/x.svg) href=https://x.com/edd_mann rel="external noopener" target=_blank>Twitter (X)</a></li><li><a class=social-icon style=--url:url(/assets/github.svg) href=https://github.com/eddmann rel="external noopener" target=_blank>GitHub</a></li></ul></nav></div></header><main class=wrapper><article><header class=page-title><h1 class=transition-between-pages style=--id:providing-local-js-and-css-resources-for-cdn-fallbacks>Providing Local JS and CSS Resources for CDN Fallbacks</h1><time class=post__time>Jan 29, 2014</time></header><main class=prose><p>In a recent <a href=https://threedevsandamaybe.com/html-experiences-part-1/ rel="external noopener" target=_blank>podcast</a> the topic of using Content Delivery Networks (CDN) to host commonly used resources such as jQuery and Twitter Bootstrap came up.
The merits of having access to large-scale delivery infrastructure provided by Google etc. are significant.
There is also the possibility that the client will already have these assets cached.</p><p>One pessimistic comment which can arise, however, is what happens if these CDNs suddenly become unavailable.
Though highly unlikely in the case of Google&rsquo;s <a href=https://developers.google.com/speed/libraries/devguide rel="external noopener" target=_blank>Hosted Libraries</a>, similar issues during development whilst offline may result in the same effect.
To overcome this, hosting a local fallback version of the assets is a worthwhile investment.
In this post I will go over three different techniques for achieving this by loading an arbitrary example of jQuery, Twitter Bootstrap JS and CSS.</p><h2 id=basic>Basic</h2><p>The example implementation below is the simplest example of providing the client with fallback options.
Inspired by the <a href=http://html5boilerplate.com/ rel="external noopener" target=_blank>HTML5 Boilerplate</a> jQuery fallback example, I have expanded this solution to cater for Twitter Bootstrap.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!-- jQuery --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>  window.<span style=color:#a6e22e>jQuery</span> <span style=color:#f92672>||</span> document.<span style=color:#a6e22e>write</span>(<span style=color:#e6db74>&#39;&lt;script src=&#34;/js/jquery-1.10.2.min.js&#34;&gt;&lt;\/script&gt;&#39;</span>);
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!-- Bootstrap --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>  window.<span style=color:#a6e22e>jQuery</span>.<span style=color:#a6e22e>fn</span>.<span style=color:#a6e22e>modal</span> <span style=color:#f92672>||</span> document.<span style=color:#a6e22e>write</span>(<span style=color:#e6db74>&#39;&lt;script src=&#34;/js/bootstrap-3.0.3.min.js&#34;&gt;&lt;\/script&gt;&#39;</span>);
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>  (<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>$</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>$</span>(<span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;body&#39;</span>).<span style=color:#a6e22e>css</span>(<span style=color:#e6db74>&#39;color&#39;</span>) <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;rgb(51, 51, 51)&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;head&#39;</span>).<span style=color:#a6e22e>prepend</span>(<span style=color:#e6db74>&#39;&lt;link rel=&#34;stylesheet&#34; href=&#34;/css/bootstrap-3.0.3.min.css&#34;&gt;&#39;</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  })(window.<span style=color:#a6e22e>jQuery</span>);
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>To check that the Bootstrap JavaScript is loaded, we test for the existence of one of the provided plugins – in this case, &lsquo;modal&rsquo;.
The CSS is a little more tricky.
In addition to including the CDN-provided stylesheet in the head, we wait for the page to be fully loaded and then check to see if the body colour matches our expectations.
If this is not the case, we append the local stylesheet to the head.
This example uses jQuery for ease of explanation, as we can be confident at this stage that at least the local version is in effect.</p><h2 id=yepnope>YepNope</h2><p>The second example takes advantage of the excellent <a href=http://yepnopejs.com/ rel="external noopener" target=_blank>YepNope</a> library, which provides us with the ability to test for the existence of a predicate and act upon the result.
By including YepNope and the provided CSS plugin extension in the document head, we are able to ensure that the &lsquo;complete&rsquo; callbacks are only invoked when the related JS or CSS assets have been fully loaded.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>yepnope</span>([
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>load</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>complete</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>      window.<span style=color:#a6e22e>jQuery</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>yepnope</span>(<span style=color:#e6db74>&#39;/js/jquery-1.10.2.min.js&#39;</span>);
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>load</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;timeout=1000!//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>complete</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>$</span>(<span style=color:#e6db74>&#39;body&#39;</span>).<span style=color:#a6e22e>css</span>(<span style=color:#e6db74>&#39;color&#39;</span>) <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;rgb(51, 51, 51)&#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>yepnope</span>(<span style=color:#e6db74>&#39;/css/bootstrap-3.0.3.min.css&#39;</span>);
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>load</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>complete</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>      window.<span style=color:#a6e22e>jQuery</span>.<span style=color:#a6e22e>fn</span>.<span style=color:#a6e22e>modal</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>yepnope</span>(<span style=color:#e6db74>&#39;/js/bootstrap-3.0.3.min.js&#39;</span>);
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>]);
</span></span></code></pre></div><p>You will notice that this example is very similar to the basic implementation, as it tests for the existence of window variables and CSS body properties.
However, using this library provides the ability to load these assets asynchronously and in parallel (based on the ordering provided).
Supplying a sequence of resources to load ensures that jQuery will be loaded before Bootstrap, which depends on it.
To improve the client&rsquo;s viewing experience, a one-second timeout has been specified for checking whether the Bootstrap CSS file has been successfully loaded before returning the local fallback.</p><h2 id=fallbackjs>Fallback.js</h2><p>The final example utilises the extremely small library <a href=http://fallback.io/ rel="external noopener" target=_blank>Fallback.js</a>, which was designed specifically for this use-case.
This is evident from the simplicity of its API, with default checking of window variable existence based on the asset key name.
Similar to the features provided by YepNope – such as loading resources asynchronously – we can improve page loading times with minimal hassle.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>fallback</span>.<span style=color:#a6e22e>load</span>(
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>bootstrapCss</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>jQuery</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js&#39;</span>, <span style=color:#e6db74>&#39;/js/jquery-1.10.2.min.js&#39;</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;jQuery.fn.modal&#39;</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>      <span style=color:#75715e>// bootstrap
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#e6db74>&#39;//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;/js/bootstrap-3.0.3.min.js&#39;</span>,
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>shim</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;jQuery.fn.modal&#39;</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;jQuery&#39;</span>], <span style=color:#75715e>// bootstrap
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    },
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>The one issue with this library is that it is tied to checking the window object for resource existence.
This does not work well when checking for the successful loading of CSS assets, as we are unable to override the predicate to check for body styling.
Although this is a minor inconvenience, I still feel that this is the best solution to deploy, particularly given the extremely simple API for loading JS resources.</p><h2 id=resources>Resources</h2><ul><li><a href=https://github.com/MaxCDN/bootstrap-cdn/issues/111 rel="external noopener" target=_blank>Check if Bootstrap is loaded</a></li><li><a href=http://www.websightdesigns.com/posts/view/javascript-cdn-with-fallback-to-local-script rel="external noopener" target=_blank>JavaScript CDN with Fallback to Local Script</a></li><li><a href=https://coderwall.com/p/pmx_4w rel="external noopener" target=_blank>Yepnope load from CDN with Fallback</a></li><li><a href=http://yepnopejs.com/ rel="external noopener" target=_blank>yepnope.js</a></li><li><a href=http://fallback.io/ rel="external noopener" target=_blank>Fallback.js</a></li></ul></main><footer class=post__tags><a href=/archive/tag/cdn>cdn</a><a href=/archive/tag/javascript>javascript</a><a href=/archive/tag/css>css</a></footer></article><div class="related-posts prose"><h3>Related Posts</h3><ul><li><a href=/posts/open-external-links-in-a-new-window-using-javascript/>Open external links in a new window using JavaScript</a></li><li><a href=/posts/twitter-api-v-1-1-user-timeline-javascript-solution/>Twitter API v1.1 User Timeline JavaScript Solution</a></li><li><a href=/posts/ten-ways-to-reverse-a-string-in-javascript/>Ten ways to reverse a string in JavaScript</a></li></ul></div><div class=scroll-watcher></div></main><footer class="site-footer wrapper"><div>&copy; 2025, Edd Mann</div><button class=theme-toggle type=button title="Toggle theme" aria-label="Toggle theme"><svg fill="currentcolor" viewBox="0 0 32 32" role="img"><title>Theme toggle icon</title><desc>A circle representing the moon for toggling theme</desc><path d="M16 .5C7.4.5.5 7.4.5 16S7.4 31.5 16 31.5 31.5 24.6 31.5 16 24.6.5 16 .5zm0 28.1V3.4C23 3.4 28.6 9 28.6 16S23 28.6 16 28.6z"/></svg></button></footer><script>(function(){document.querySelector(".theme-toggle").addEventListener("click",()=>{localStorage.setItem("theme",localStorage.getItem("theme")==="dark"?"light":"dark"),document.documentElement.setAttribute("data-theme",localStorage.getItem("theme"))}),document.querySelector(".site-header__mobile-navigation-button").addEventListener("click",e=>{document.documentElement.classList.toggle("mobile-navigation-open"),e.target.setAttribute("aria-expanded",e.target.getAttribute("aria-expanded")==="false"?"true":"false")});const n=document.querySelector(".site-header");let t=window.pageYOffset,e=!1;window.addEventListener("scroll",()=>{if(e)return;setTimeout(()=>{const s=window.pageYOffset;n.classList.toggle("is-sticky",s>0&&t>s),t=s,e=!1},500),e=!0})})()</script></body></html>