<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Using Python's Pygments Syntax Highlighter in PHP - Edd Mann</title>
<meta name=description content="Discover how to integrate Python's Pygments into PHP to effortlessly highlight syntax and enhance code readability on your website."><meta name=author content="Edd Mann"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZPQ7WHNXH4"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZPQ7WHNXH4")}</script><meta itemprop=name content="Using Python's Pygments Syntax Highlighter in PHP"><meta itemprop=description content="Having a website that is heavily software-development based, one important aspect that can not be overlooked is well presented code examples. Speaking on the importance of editor syntax highlighting in the previous episode of our podcast, this attribute transcends to aid in the readability of code online. Fortunately, there are many options to choose from. You can either store the code snippets in an embedded Gists or use the front-end based highlight.js or Google Code Prettify. One benefit that greatly simplified the publishing process when using a front-end based solution was that you could simply parse the Markdown file (perhaps with a class language type-hint) and leave all the hard work to the client’s browser. As we all know, we have very little control over the viewing experience for each user. And as I started to post more frequently, cracks began to appear in the syntax highlighters I had been using. However, when looking for a solution, one had been staring me straight in the face all this time, and that was Pygments."><meta itemprop=datePublished content="2014-01-06T00:00:00+00:00"><meta itemprop=dateModified content="2014-01-06T00:00:00+00:00"><meta itemprop=wordCount content="880"><meta itemprop=keywords content="Pygments,Php"><meta property="og:url" content="https://eddmann.com/posts/using-pythons-pygments-syntax-highlighter-in-php/"><meta property="og:site_name" content="Edd Mann"><meta property="og:title" content="Using Python's Pygments Syntax Highlighter in PHP"><meta property="og:description" content="Having a website that is heavily software-development based, one important aspect that can not be overlooked is well presented code examples. Speaking on the importance of editor syntax highlighting in the previous episode of our podcast, this attribute transcends to aid in the readability of code online. Fortunately, there are many options to choose from. You can either store the code snippets in an embedded Gists or use the front-end based highlight.js or Google Code Prettify. One benefit that greatly simplified the publishing process when using a front-end based solution was that you could simply parse the Markdown file (perhaps with a class language type-hint) and leave all the hard work to the client’s browser. As we all know, we have very little control over the viewing experience for each user. And as I started to post more frequently, cracks began to appear in the syntax highlighters I had been using. However, when looking for a solution, one had been staring me straight in the face all this time, and that was Pygments."><meta property="og:locale" content="en_GB"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-01-06T00:00:00+00:00"><meta property="article:modified_time" content="2014-01-06T00:00:00+00:00"><meta property="article:tag" content="Pygments"><meta property="article:tag" content="Php"><meta name=twitter:card content="summary"><meta name=twitter:title content="Using Python's Pygments Syntax Highlighter in PHP"><meta name=twitter:description content="Having a website that is heavily software-development based, one important aspect that can not be overlooked is well presented code examples. Speaking on the importance of editor syntax highlighting in the previous episode of our podcast, this attribute transcends to aid in the readability of code online. Fortunately, there are many options to choose from. You can either store the code snippets in an embedded Gists or use the front-end based highlight.js or Google Code Prettify. One benefit that greatly simplified the publishing process when using a front-end based solution was that you could simply parse the Markdown file (perhaps with a class language type-hint) and leave all the hard work to the client’s browser. As we all know, we have very little control over the viewing experience for each user. And as I started to post more frequently, cracks began to appear in the syntax highlighters I had been using. However, when looking for a solution, one had been staring me straight in the face all this time, and that was Pygments."><meta name=twitter:site content="@edd_mann"><link rel="preload stylesheet" as=style href=/css/style.min.6c18b9cbfe138a24784e64860eaa9d70076170f03c68d8be3b3f1ae99e51df9f.css integrity="sha256-bBi5y/4TiiR4TmSGDqqdcAdhcPA8aNi+Oz8a6Z5R358="><link rel=preload as=image href=/assets/x.svg><link rel=preload as=image href=/assets/github.svg><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://eddmann.com/posts/using-pythons-pygments-syntax-highlighter-in-php/></head><body><header class="site-header wrapper"><a href=https://eddmann.com/><h3 class=site-header__title>Edd Mann
<span style=--url:url(/assets/code.svg)>Developer</span></h3></a><div class=site-header__mobile-navigation-button aria-label="Toggle mobile site navigation" aria-expanded=false aria-controls=site-navigation></div><div class=site-header__navigation id=site-navigation><nav aria-label="Primary navigation"><ul class=site-header__primary-navigation><li><a href=/archive>Archive</a></li><li><a href=/projects>Projects</a></li><li><a href=/about>About</a></li></ul></nav><nav aria-label="Social links"><ul class=site-header__social-navigation><li><a class=social-icon style=--url:url(/assets/x.svg) href=https://x.com/edd_mann rel="external noopener" target=_blank>Twitter (X)</a></li><li><a class=social-icon style=--url:url(/assets/github.svg) href=https://github.com/eddmann rel="external noopener" target=_blank>GitHub</a></li></ul></nav></div></header><main class=wrapper><article><header class=page-title><h1>Using Python's Pygments Syntax Highlighter in PHP</h1><time class=post__time>Jan 6, 2014</time></header><main class=prose><p>Having a website that is heavily software-development based, one important aspect that can not be overlooked is well presented code examples.
Speaking on the importance of editor syntax highlighting in the <a href=https://threedevsandamaybe.com/exploring-text-source-editors-and-ides/ rel="external noopener" target=_blank>previous episode</a> of our podcast, this attribute transcends to aid in the readability of code online.
Fortunately, there are many options to choose from.
You can either store the code snippets in an embedded <a href=http://gist.github.com/ rel="external noopener" target=_blank>Gists</a> or use the front-end based <a href=http://highlightjs.org/ rel="external noopener" target=_blank>highlight.js</a> or <a href=http://code.google.com/p/google-code-prettify/ rel="external noopener" target=_blank>Google Code Prettify</a>.
One benefit that greatly simplified the publishing process when using a front-end based solution was that you could simply parse the Markdown file (perhaps with a class language type-hint) and leave all the hard work to the client&rsquo;s browser.
As we all know, we have very little control over the viewing experience for each user.
And as I started to post more frequently, cracks began to appear in the syntax highlighters I had been using.
However, when looking for a solution, one had been staring me straight in the face all this time, and that was <a href=http://pygments.org/ rel="external noopener" target=_blank>Pygments</a>.</p><h2 id=enter-pygments>Enter Pygments</h2><p>I was first introduced to Pygments through my time using <a href=http://jekyllrb.com/ rel="external noopener" target=_blank>Jekyll</a> a couple of years ago.
Since then, however, due to limited demands in this area, I stuck with highlight.js to perform my syntax highlighting.
This had worked well until recently, when a couple of shell scripts and Java enumerated type declarations slipped it up.
If this is your first introduction to Pygments, note that it is written in Python.
While I do like the language a lot, I felt it might be overkill to move my blogging platform over to Python just for syntax highlighting (though it was not out of the question).
As a result, I decided to see if there was anything on a par in the PHP landscape.
A <a href=http://packagist.org/ rel="external noopener" target=_blank>Packagist</a> search returned a few hopeful results, though the output was not comparable.
I could now see why the Ruby-based Jekyll project had gone to the effort of depending on the Python-based Pygments project to handle code syntax highlighting.
Looking deeper into Pygments&rsquo; success, the questions were answered by the attention paid to supporting new languages and edge cases within the languages I was interested in.
Installation of Pygments can be simply achieved by using the <a href=http://pypi.python.org/pypi/setuptools rel="external noopener" target=_blank>EasyInstall</a> package manager, or on a CentOS installation via YUM.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo easy_install Pygments <span style=color:#75715e># EasyInstall</span>
</span></span><span style=display:flex><span>$ sudo yum install python-pygments <span style=color:#75715e># CentOS</span>
</span></span></code></pre></div><h2 id=bridging-the-python-and-php-divide>Bridging the Python and PHP Divide</h2><p>Knowing now that I would only be truly happy with Pygments, my best option was to write a simple wrapper over the provided command-line interface.
This approach would be the least obtrusive to my PHP application.
Making this decision meant that I would have to handle the processing of posts&rsquo; code snippets before supplying the Markdown parser with the file&rsquo;s content.
Fortunately, before updating my blog, I had decided to use the <a href=http://michelf.ca/projects/php-markdown/extra/ rel="external noopener" target=_blank>Markdown Extra</a> parser produced by Michel Fortin.
This parser allowed me to enclose code snippets in <a href=http://michelf.ca/projects/php-markdown/extra/#fenced-code-blocks rel="external noopener" target=_blank>fenced blocks</a>.
I had also added the extra constraint of declaring these blocks with three tilde characters and a class language type-hint (~~~ .example).
This decision proved very useful when producing the example implementation below, and it can be easily expanded to cater for more code-block declarations.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>pygments</span>($post)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>preg_replace_callback</span>(<span style=color:#e6db74>&#39;/~~~[\s]*\.([a-z]+)\n(.*?)\n~~~/is&#39;</span>, <span style=color:#66d9ef>function</span>($match)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>list</span>($orig, $lang, $code) <span style=color:#f92672>=</span> $match;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $proc <span style=color:#f92672>=</span> <span style=color:#a6e22e>proc_open</span>(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;pygmentize -f html -O style=default,encoding=utf-8,startinline -l &#39;</span> <span style=color:#f92672>.</span> $lang,
</span></span><span style=display:flex><span>            [ [ <span style=color:#e6db74>&#39;pipe&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span> ], [ <span style=color:#e6db74>&#39;pipe&#39;</span>, <span style=color:#e6db74>&#39;w&#39;</span> ] <span style=color:#75715e>/* ignore stderr */</span> ],
</span></span><span style=display:flex><span>            $pipes
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fwrite</span>($pipes[<span style=color:#ae81ff>0</span>], $code);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fclose</span>($pipes[<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $output <span style=color:#f92672>=</span> <span style=color:#a6e22e>stream_get_contents</span>($pipes[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fclose</span>($pipes[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> (<span style=color:#a6e22e>proc_close</span>($proc))
</span></span><span style=display:flex><span>            <span style=color:#f92672>?</span> $orig
</span></span><span style=display:flex><span>            <span style=color:#f92672>:</span> $output;
</span></span><span style=display:flex><span>    }, $post);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Coupled with the decision to only handle a defined code-block definition, I also made the assumption that the <code>pygmentize</code> command is present in the user&rsquo;s path.
This can be easily altered if necessary.
Using the <code>proc_open</code> function supplied by PHP, I was able to begin a child process which used the defined STDIN, STDOUT, and STDERR descriptor pipes that I supplied.
I decided to omit the STDERR pipe as I could detect an error occurring (regardless of the exact reason) when closing the process using <code>proc_close</code>.
In the case of an error (a non-zero returned value), I would simply return the original content for the Markdown parser to process accordingly.
Within the <code>pygmentize</code> command, I supplied the option for HTML and default-styling/UTF-8 output.
The &lsquo;startinline&rsquo; option removes the requirement to define a PHP start tag when displaying PHP syntax-highlighted code blocks.
The &lsquo;default&rsquo; styling was intentionally defined to provide easier setup, as discussed in the next section.</p><h2 id=simple-styling>Simple Styling</h2><p>There are many styling and output options present in Pygments.
I would strongly recommend you check out the documentation.
Custom styles are typically installed in the same manner as the library itself, using EasyInstall.
However, there are many built-in styles which rely on the output generated from the &lsquo;default&rsquo; style option.
My favourite is <a href=http://slinky.imukuppi.org/zenburnpage/ rel="external noopener" target=_blank>Zenburn</a>.
These stylesheets can be generated using the <code>pygmentize</code> command itself.
But to make it super simple, <a href=http://github.com/richleland/pygments-css rel="external noopener" target=_blank>this</a> GitHub repository provides them preprocessed.
If you have not already got a style in mind, you can check out <a href=http://igniteflow.com/pygments/themes/ rel="external noopener" target=_blank>this</a> page which neatly displays examples of each of the available styles.</p><h2 id=resources>Resources</h2><ul><li><a href=http://highlightjs.org/ rel="external noopener" target=_blank>highlight.js</a></li><li><a href=http://code.google.com/p/google-code-prettify/ rel="external noopener" target=_blank>Google Code Prettify</a></li><li><a href=http://pygments.org/ rel="external noopener" target=_blank>Pygments</a></li><li><a href=http://packagist.org/ rel="external noopener" target=_blank>Packagist</a></li><li><a href=http://michelf.ca/projects/php-markdown/extra/ rel="external noopener" target=_blank>Markdown Extra</a></li><li><a href=http://www.sitepoint.com/proc-open-communicate-with-the-outside-world/ rel="external noopener" target=_blank>Proc_Open: Communicate with the Outside World</a></li><li><a href=http://www.php.net/manual/en/function.proc-open.php rel="external noopener" target=_blank>PHP Documentation: proc_open</a></li><li><a href=http://github.com/richleland/pygments-css rel="external noopener" target=_blank>Pygments CSS Styles</a></li><li><a href=http://igniteflow.com/pygments/themes/ rel="external noopener" target=_blank>Pygments Style Previews</a></li></ul></main><footer class=post__tags><a href=/archive/tag/pygments>pygments</a><a href=/archive/tag/php>php</a></footer></article></main><footer class="site-footer wrapper"><div>&copy; 2025, Edd Mann</div></footer><script>(function(){document.querySelector(".site-header__mobile-navigation-button").addEventListener("click",e=>{document.documentElement.classList.toggle("mobile-navigation-open"),e.target.setAttribute("aria-expanded",e.target.getAttribute("aria-expanded")==="false"?"true":"false")});const n=document.querySelector(".site-header");let t=window.pageYOffset,e=!1;window.addEventListener("scroll",()=>{if(e)return;const s=window.pageYOffset;window.requestAnimationFrame(()=>{n.classList.toggle("is-sticky",t>s),t=s,e=!1}),e=!0})})()</script></body></html>